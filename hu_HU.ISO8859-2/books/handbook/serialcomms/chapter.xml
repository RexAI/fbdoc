<?xml version="1.0" encoding="iso-8859-2"?>
<!--
     The FreeBSD Documentation Project

     $FreeBSD$
-->
<!-- The FreeBSD Hungarian Documentation Project
     Translated by: PALI, Gabor <pgj@FreeBSD.org>
     %SOURCE%	en_US.ISO8859-1/books/handbook/serialcomms/chapter.xml
     %SRCID%	1.133
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="serialcomms">
  <title>Soros vonali kommunikáció</title>

  <sect1 xml:id="serial-synopsis">
    <title>Áttekintés</title>

    <indexterm><primary>soros
      kommunikáció</primary></indexterm>

    <para>A &unix; mindig is támogatta a soros vonali
      kommunikációt.  Tulajdonképpen az elsõ
      &unix;-os gépek is soros vonalon kapták a
      felhasználóktól a bemenetet és
      ugyanígy küldték vissza a kimenetet.  Az
      idõk azóta már sokat változtak, hogy egy
      átlagos <quote>terminál</quote> mindössze egy
      10 karakter per másodperc sebességû soros
      nyomtatóból és egy billentyûzetbõl
      állt.  Ebben a fejezetben ismertetünk
      néhány olyan megoldást, amellyel a &os;
      képes soros vonalon keresztül
      kommunikálni.</para>

    <para>A fejezet elolvasása során
      megismerjük:</para>

    <itemizedlist>
      <listitem>
	<para>hogyan kapcsoljunk terminálokat a &os;
	  rendszerünkre;</para>
      </listitem>
      <listitem>
	<para>hogyan tárcsázzunk modem
	  segítségével távoli
	  számítógépeket;</para>
      </listitem>
      <listitem>
	<para>hogyan tegyük lehetõvé
	  gépünkre a bejelentkezést távoli
	  felhasználók számára;</para>
      </listitem>
      <listitem>
	<para>hogyan indítsuk a rendszerünket soros
	  konzolról.</para>
      </listitem>
    </itemizedlist>

    <para>A fejezet elolvasásához ajánlott:</para>

    <itemizedlist>
      <listitem>
	<para>egy új rendszermag
	  beállításának és
	  telepítésének ismerete (<xref linkend="kernelconfig"/>);</para>
      </listitem>
      <listitem>
	<para>a &unix;-os engedélyek és a &unix; alatt
	  futtatott programok mûködtetésének
	  megértése (<xref linkend="basics"/>);</para></listitem>
      <listitem>
	<para>annak a soros vonali hardvernek (modemnek vagy
	  többportos kártyának a)
	  kézikönyve, amelyet a &os;-vel használni
	  szeretnénk</para>
      </listitem>
    </itemizedlist>

  </sect1>

  <sect1 xml:id="serial">
    <title>Bevezetés</title>

    <sect2 xml:id="serial-terminology">
      <title>Alapfogalmak</title>

      <variablelist>
	<indexterm><primary>bit per
	  másodperc</primary></indexterm>

	<varlistentry>
	  <term>bps</term>
	  <listitem>
	    <para>Bit per másodperc &mdash; az adatátvitel
	      sebessége</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>DTE</term>
	  <listitem>
	    <indexterm><primary>DTE</primary></indexterm>

	    <para>Adatterminál eszköz (Data Terminal
	      Equipment) &mdash; ez például a
	      számítógépünk</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>DCE</term>
	  <listitem>
	    <indexterm><primary>DCE</primary></indexterm>

	    <para>Adatkommunikációs eszköz (Data
	      Communications Equipment) &mdash; ez a modem</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>RS-232</term>
	  <listitem>
	    <indexterm><primary>RS-232C kábel</primary></indexterm>

	    <para>a hardveres soros vonali kommunikációhoz
	      szükséges EIA szabványú
	      kábel</para>
	  </listitem>
	</varlistentry>
      </variablelist>

      <para>Amikor ebben a fejezetben az adatátvitel
	sebességérõl beszélünk, akkor
	szándékosan nem használjuk a
	<quote>baud</quote> fogalmát.  A baud ugyanis a
	kommunikációs eszközben adott idõ alatt
	lezajló jelváltások
	mennyiségét jelöli, miközben itt a
	<quote>bps</quote> (bit per másodperc) kifejezés
	használata a <emphasis>helyes</emphasis> (vagy
	legalább is a szõrszálhasogatók
	egyelõre megnyugodhatnak).</para>

    </sect2>

    <sect2 xml:id="serial-cables-ports">
      <title>Kábelek és portok</title>

      <para>Ha a &os; rendszerünkhöz egy modemet vagy egy
	terminált akarunk csatlakoztatni, akkor ahhoz a
	számítógépünkben
	szükség lesz egy szabad soros portra és egy
	megfelelõ típusú kábelre.  Ha
	már tisztában vagyunk a rendelkezésre
	álló hardverrel és a
	hozzá tartozó kábellel, akkor nyugodtan
	átléphetjük ezt a részt.</para>

      <sect3 xml:id="term-cables">
	<title>A kábelek fajtái</title>

	<para>A soros kábeleknek több
	  különbözõ típusa van.
	  Közülük a céljainknak leginkább
	  megfelelõ két legismertebb változatuk az
	  ún.  null-modem és a szabványos
	  (<quote>egyenes</quote>) RS-232-es soros kábelek.  A
	  hardverhez tartozó dokumentációban
	  megtaláljuk, hogy pontosan melyik típus tartozik
	  hozzá.</para>

	<sect4 xml:id="term-cables-null">
	  <title>A null-modem kábelek</title>

	  <indexterm><primary>null-modem
	    kábel</primary></indexterm>

	  <para>Egy null-modem kábel bizonyos jeleket,
	    többek közt a <quote>földet</quote> (Signal
	    Ground, SG), egyenesen küldi, másokat viszont
	    felcserélten.  Például az
	    <quote>átküldött adat</quote> (Transmitted
	    Data, TD) jelzésû tû a kábel
	    másik végén a <quote>fogadott
	    adat</quote> (Received Data, RD) tûhöz fut
	    be.</para>

	  <para>A terminálokhoz akár saját magunk
	    is le tudunk gyártani egy null-modem kábelt
	    (például ha a boltiakkal nem lennénk
	    megelégedve).  A következõ
	    táblázatban az RS-232C <link linkend="serialcomms-signal-names">jeleit</link> és
	    érintkezõinek számozását
	    láthatjuk egy DB-25-ös csatlakozó
	    esetében.  A szabvány a kábel
	    két 1-es tûjét összekapcsoló
	    vonalat <emphasis>védõföldnek</emphasis>
	    (Protective Ground, PD) nevezi, de ezt gyakran el is
	    hagyják.  Némely terminál remekül
	    mûködik mindössze a 2-es, 3-as és 7-es
	    tûk használatával, miközben
	    mások az iménti példától
	    eltérõ kiosztást
	    igényelnek.</para>

	  <table frame="none" pgwide="1">
	    <title>A DB-25 DB-25 közti null-modem
	      kábel</title>

	    <tgroup cols="5">
	      <thead>
		<row>
		  <entry align="left">Jel</entry>
		  <entry align="left">Tû</entry>
		  <entry/>
		  <entry align="left">Tû</entry>
		  <entry align="left">Jel</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry>SG</entry>
		  <entry>7</entry>
		  <entry>párja:</entry>
		  <entry>7</entry>
		  <entry>SG</entry>
		</row>

		<row>
		  <entry>TD</entry>
		  <entry>2</entry>
		  <entry>párja:</entry>
		  <entry>3</entry>
		  <entry>RD</entry>
		</row>

		<row>
		  <entry>RD</entry>
		  <entry>3</entry>
		  <entry>párja:</entry>
		  <entry>2</entry>
		  <entry>TD</entry>
		</row>

		<row>
		  <entry>RTS</entry>
		  <entry>4</entry>
		  <entry>párja:</entry>
		  <entry>5</entry>
		  <entry>CTS</entry>
		</row>

		<row>
		  <entry>CTS</entry>
		  <entry>5</entry>
		  <entry>párja:</entry>
		  <entry>4</entry>
		  <entry>RTS</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>20</entry>
		  <entry>párja:</entry>
		  <entry>6</entry>
		  <entry>DSR</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>20</entry>
		  <entry>párja:</entry>
		  <entry>8</entry>
		  <entry>DCD</entry>
		</row>

		<row>
		  <entry>DSR</entry>
		  <entry>6</entry>
		  <entry>párja:</entry>
		  <entry>20</entry>
		  <entry>DTR</entry>
		</row>

		<row>
		  <entry>DCD</entry>
		  <entry>8</entry>
		  <entry>párja:</entry>
		  <entry>20</entry>
		  <entry>DTR</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </table>

	  <para>Íme a mostanság elterjedt másik
	    két séma.</para>

	  <table frame="none" pgwide="1">
	    <title>A DB-9 DB-9 közti null-modem
	      kábel</title>

	    <tgroup cols="5">
	      <thead>
		<row>
		  <entry align="left">Jel</entry>
		  <entry align="left">Tû</entry>
		  <entry/>
		  <entry align="left">Tû</entry>
		  <entry align="left">Jel</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry>RD</entry>
		  <entry>2</entry>
		  <entry>párja:</entry>
		  <entry>3</entry>
		  <entry>TD</entry>
		</row>

		<row>
		  <entry>TD</entry>
		  <entry>3</entry>
		  <entry>párja:</entry>
		  <entry>2</entry>
		  <entry>RD</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>4</entry>
		  <entry>párja:</entry>
		  <entry>6</entry>
		  <entry>DSR</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>4</entry>
		  <entry>párja:</entry>
		  <entry>1</entry>
		  <entry>DCD</entry>
		</row>

		<row>
		  <entry>SG</entry>
		  <entry>5</entry>
		  <entry>párja:</entry>
		  <entry>5</entry>
		  <entry>SG</entry>
		</row>

		<row>
		  <entry>DSR</entry>
		  <entry>6</entry>
		  <entry>párja:</entry>
		  <entry>4</entry>
		  <entry>DTR</entry>
		</row>

		<row>
		  <entry>DCD</entry>
		  <entry>1</entry>
		  <entry>párja:</entry>
		  <entry>4</entry>
		  <entry>DTR</entry>
		</row>

		<row>
		  <entry>RTS</entry>
		  <entry>7</entry>
		  <entry>párja:</entry>
		  <entry>8</entry>
		  <entry>CTS</entry>
		</row>

		<row>
		  <entry>CTS</entry>
		  <entry>8</entry>
		  <entry>párja:</entry>
		  <entry>7</entry>
		  <entry>RTS</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </table>

	  <table frame="none" pgwide="1"> <title>DB-9 DB-25 közti
	    null-modem kábel</title>

	    <tgroup cols="5">
	      <thead>
		<row>
		  <entry align="left">Jel</entry>
		  <entry align="left">Tû</entry>
		  <entry/>
		  <entry align="left">Tû</entry>
		  <entry align="left">Jel</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry>RD</entry>
		  <entry>2</entry>
		  <entry>párja:</entry>
		  <entry>2</entry>
		  <entry>TD</entry>
		</row>

		<row>
		  <entry>TD</entry>
		  <entry>3</entry>
		  <entry>párja:</entry>
		  <entry>3</entry>
		  <entry>RD</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>4</entry>
		  <entry>párja:</entry>
		  <entry>6</entry>
		  <entry>DSR</entry>
		</row>

		<row>
		  <entry>DTR</entry>
		  <entry>4</entry>
		  <entry>párja:</entry>
		  <entry>8</entry>
		  <entry>DCD</entry>
		</row>

		<row>
		  <entry>SG</entry>
		  <entry>5</entry>
		  <entry>párja:</entry>
		  <entry>7</entry>
		  <entry>SG</entry>
		</row>

		<row>
		  <entry>DSR</entry>
		  <entry>6</entry>
		  <entry>párja:</entry>
		  <entry>20</entry>
		  <entry>DTR</entry>
		</row>

		<row>
		  <entry>DCD</entry>
		  <entry>1</entry>
		  <entry>párja:</entry>
		  <entry>20</entry>
		  <entry>DTR</entry>
		</row>

		<row>
		  <entry>RTS</entry>
		  <entry>7</entry>
		  <entry>párja:</entry>
		  <entry>5</entry>
		  <entry>CTS</entry>
		</row>

		<row>
		  <entry>CTS</entry>
		  <entry>8</entry>
		  <entry>párja:</entry>
		  <entry>4</entry>
		  <entry>RTS</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </table>

	  <note>
	    <para>Amikor egy tû az átellenes oldalon
	      két másik tûhöz csatlakozik, akkor
	      azt általában úgy
	      valósítják meg, hogy a két
	      tût a saját oldalukon összekötik,
	      majd ezt kapcsolják hozzá a harmadik
	      tûhöz.</para>
	  </note>

	  <para>Ezek a megoldások a legnépszerûbbek.
	    Természetesen a tûk
	    összekötésének több más
	    variációja is létezik (ezekrõl az
	    <emphasis>RS-232 Made Easy</emphasis> c.  könyvben
	    olvashatunk bõvebben), ahol az SG párja az SG, a
	    TD párja az RD, az RTS és a CTS párja
	    az DCD, a DTR párja a DSR és ugyanezek
	    fordítva.</para>

	</sect4>

	<sect4 xml:id="term-cables-std">
	  <title>Szabványos RS-232C kábelek</title>

	  <indexterm><primary>RS-232C kábel</primary></indexterm>

	  <para>A szabványos soros kábel az összes
	    RS-232C jelet közvetlenül átküldi.
	    Vagyis a kábel egyik végén levõ
	    <quote>átküldött adat</quote> tû a
	    másik végén is az
	    <quote>átküldött adat</quote>
	    tûhöz csatlakozik.  Az ilyen típusú
	    kábeleket többnyire a
	    számítógépek és a modemek
	    között alkalmazzák, de egyes
	    termináltípusok esetében is
	    szükségünk lehet rá.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="term-ports">
	<title>A portok</title>

	<para>A soros port olyan eszköz, amelyen keresztül a
	  &os;-s gép és a terminál között
	  adatokat tudunk közvetíteni.  Ebben a szakaszban
	  az ilyen portok különféle típusait
	  és ezek használatát ismertetjük &os;
	  alatt.</para>

	<sect4 xml:id="term-portkinds">
	  <title>A portok típusai</title>

	  <para>A soros portoknak több típusa
	    létezik.  Mielõtt
	    vásárolnánk egy
	    készítenénk egy soros kábelt,
	    mindenképpen gyõzödjünk meg
	    róla, hogy csatlakoztatni tudjuk majd a &os;-s
	    rendszerünkhöz és a terminálhoz
	    egyaránt.</para>

	  <para>A legtöbb terminálon DB-25-ös portot
	    találunk.  A személyi
	    számítógépek, köztük
	    azok, amelyeken &os; fut, DB-25-ös és DB-9es
	    portokkal rendelkeznek.  Ha a gépünkben egy
	    többportos soros kártya van, akkor ezeken
	    kívül még RJ-12-es és
	    RJ-45-ös portjaink is lehetnek.</para>

	  <para>A hardverhez tartozó
	    dokumentációból tudjuk
	    kideríteni az adott port konkrét
	    fajtáját, de gyakran a port vizuális
	    vizsgálata is segíthet eldönteni a
	    kérdést.</para>

	</sect4>

	<sect4 xml:id="term-portnames">
	  <title>A portok nevei</title>

	  <para>&os; alatt az egyes soros portokat a
	    <filename>/dev</filename> könyvtárban
	    található eszközleírókon
	    keresztül tudjuk elérni.  Ezeknek két
	    típusa van:</para>

	  <itemizedlist>
	    <listitem>
	      <para>A behíváshoz használt portok
		nevei
		<filename>/dev/ttydN</filename>
		alakúak, ahol az <replaceable>N</replaceable> a
		port sorszáma, ami nullától indul.
		A behívó portok alapvetõen a
		terminál esetében használatosak.  A
		behívó portok használatához
		a soros vonalon az <quote>vonal
		észlelése</quote> (Data Carrier Detect,
		DCD) jelnek kell megbízhatóan
		mûködnie.</para>
	    </listitem>

	    <listitem>
	      <para>A híváshoz használt portok
		nevei
		<filename>/dev/cuadN</filename>
		alakúak.  A hívó portokat
		terminálok esetében ritkán
		alkalmazzák, helyettük inkább csak
		modemekhez használják.  A
		hívó portokat akkor érdemes
		használni, ha a soros kábel vagy a
		terminál nem ismeri a DCD jelet.</para>

	    </listitem>
	  </itemizedlist>

	  <para>Ha a terminált az elsõ soros portra (ami
	    &ms-dos;-ban a <filename>COM1</filename>)
	    csatlakoztattuk, akkor a <filename>/dev/ttyd0</filename>
	    segítségével fogunk rá
	    hivatkozni.  Ha viszont a második soros porton
	    (más néven <filename>COM2</filename>)
	    található, akkor a
	    <filename>/dev/ttyd1</filename> eszközt
	    használjuk, és így
	    tovább.</para>

	</sect4>
      </sect3>
    </sect2>

    <sect2>
      <title>A rendszermag beállítása</title>

      <para>A &os; alapból négy soros portot
	támogat.  Az &ms-dos; világban ezeket rendre
	<filename>COM1</filename>, <filename>COM2</filename>,
	<filename>COM3</filename> és
	<filename>COM4</filename> portoknak nevezik.  A &os; jelen
	pillanatban ismeri még a <quote>butább</quote>
	többportos soros csatolókártyákat is,
	például a BocaBoard 1008 és 2016
	típusokat, valamint több intelligensebb
	többportos kártyát, például a
	Digiboard és a Stallion Technologies
	gyártmányait.  Az alap rendszermag azonban csak a
	szabványos COM portokat keresi.</para>

      <para>Ha ellenõrizni akarjuk, hogy a rendszermag rendben
	megtalálta a soros portokat, akkor figyelmesen olvassuk
	el a rendszerindítás során megjelenõ
	üzeneteket, vagy az <command>/sbin/dmesg</command> parancs
	kiadásával kérdezzük vissza a
	rendszermag üzeneteit.  Különösen a
	<literal>sio</literal> kezdetû sorokra kell
	figyelnünk.</para>

      <tip>
	<para>Az alábbi paranccsal tudjuk leszûrni a
	  <literal>sio</literal> szövegrészt
	  tartalmazó sorokat:</para>

	<screen>&prompt.root; <userinput>/sbin/dmesg | grep 'sio'</userinput></screen>
      </tip>

      <para>Például, ha négy soros port
	található a rendszerünkben, akkor a
	rájuk vonatkozó rendszerüzenetek a
	következõk lesznek:</para>

      <screen>sio0 at 0x3f8-0x3ff irq 4 on isa
sio0: type 16550A
sio1 at 0x2f8-0x2ff irq 3 on isa
sio1: type 16550A
sio2 at 0x3e8-0x3ef irq 5 on isa
sio2: type 16550A
sio3 at 0x2e8-0x2ef irq 9 on isa
sio3: type 16550A</screen>

      <para>Ha a rendszermagunk nem ismerte volna fel az összes
	soros portot, akkor valószínûleg a
	<filename>/boot/device.hints</filename> állományt
	kell módosítanunk.  Tegyük
	megjegyzésbe vagy akár teljesen
	távolítsuk is el azokat az eszközöket,
	amelyekkel nem rendelkezünk.</para>

      <para>A soros portok és a többportos
	kártyák beállításával
	kapcsolatban a &man.sio.4; man oldalát olvassuk el.
	Óvatosan bánjunk a &os; megelõzõ
	változataiból származó
	konfigurációs állományokkal, mert az
	eszközök vonatkozó
	beállításokat és azok
	formátuma megváltozhatott azóta.</para>

      <note>
	<para>Az <literal>port IO_COM1</literal> a <literal>port
	  0x3f8</literal>, az <literal>IO_COM2</literal> a
	  <literal>0x2f8</literal>, az <literal>IO_COM3</literal> a
	  <literal>0x3e8</literal> és az
	  <literal>IO_COM4</literal> a <literal>0x2e8</literal>
	  beállítást helyettesíti.  Ezek az
	  adott porthoz tartozó gyakori címeket
	  képviselik.  A 4-es, 3-as, 5-ös és 9
	  megszakítások is igen általánosak
	  ezeknél.  A hagyományos soros portok viszont az
	  ISA buszos PC-k esetében <emphasis>nem
	  képesek</emphasis> a megszakításokon
	  osztozni.  (A többportos kártyák azonban
	  lehetõvé teszik az 16550A számára,
	  hogy mindössze egy vagy két
	  megszakítást használjon.)</para>
      </note>

    </sect2>

    <sect2>
      <title>Speciális
	eszközállományok</title>

      <para>A rendszermagban található legtöbb
	eszköz az ún.  <quote>speciális
	eszközállományokon</quote> keresztül
	érhetõ el, melyek a <filename>/dev</filename>
	könyvtárban találhatóak.  A
	<filename>sio</filename> eszközök a
	<filename>/dev/ttydN</filename>
	(behívó portok) és
	<filename>/dev/cuadN</filename>
	(hívó portok) állományok
	használatával érhetõek el.  A &os;
	ezenkívül még külön
	eszközállományokat biztosít az
	inicializációhoz
	(<filename>/dev/cuadN.init</filename>)
	és a zároláshoz
	(<filename>/dev/cuadN.lock</filename>).
	Az inicializációs állományok a port
	megnyitásakor használhatóak a
	hozzá tartozó paraméterek
	beállítására, például
	így tudjuk elküldeni a <literal>crtscts</literal>
	utasítást az olyan modemeknek, amelyek a forgalom
	irányítását
	<literal>RTS/CTS</literal> jelzéseken keresztül
	valósítják meg.  A zároló
	állományokkal a portokra vonatkozó
	zárolásokat állíthatjuk be,
	így a felhasználók vagy a programok nem
	lesznek képesek bizonyos paramétereket
	megváltoztatni.  A &man.termios.4;, &man.sio.4; és
	&man.stty.1; man oldalakon olvashatunk részletesebben a
	terminálok beállításairól,
	valamint az eszközök
	zárolásáról és
	inicializálásáról.</para>

    </sect2>

    <sect2 xml:id="serial-hw-config">
      <title>A soros port beállítása</title>

      <indexterm><primary><filename>ttyd</filename></primary></indexterm>
      <indexterm><primary><filename>cuad</filename></primary></indexterm>

      <para>A <filename>ttydN</filename>
	(vagy <filename>cuadN</filename>)
	lesz az az eszköz, amit majd az
	alkalmazásainkból el akarunk érni.  Amikor
	egy futó program megnyit egy ilyen eszközt, mindig
	tartoznak hozzá alapértelmezett terminál
	I/O beállítások.  Ezeket a
	következõ paranccsal tudjuk lekérdezni:</para>

      <screen>&prompt.root; <userinput>stty -a -f /dev/ttyd1</userinput></screen>

      <para>Ha megváltoztatjuk az eszköz
	beállításait, akkor azok egészen
	addig érvényben is maradnak, amíg le nem
	zárjuk.  Ha tehát ezután újra
	megnyitjuk, akkor minden visszaáll az
	alapértelmezett állapotra.  Az
	alapértelmezett beállítások
	megváltoztatásához a <quote>kezdeti
	állapotot</quote> szimbolizáló eszközt
	kell megnyitnunk és átállítanunk.
	Például, ha alapból engedélyezni
	akarjuk a <option>CLOCAL</option> módot, a 8&nbsp;bites
	kommunikációt és a
	<option>XON/XOFF</option> típusú
	forgalomirányítást a
	<filename>ttyd5</filename> eszközön, akkor a
	következõt gépeljük be:</para>

      <screen>&prompt.root; <userinput>stty -f /dev/ttyd5.init clocal cs8 ixon ixoff</userinput></screen>

      <indexterm>
	<primary>rc állományok</primary>
	<secondary><filename>rc.serial</filename></secondary>
      </indexterm>

      <para>A soros eszközök rendszerszintû
	inicializálását az
	<filename>/etc/rc.d/serial</filename> állomány
	vezérli.  Lényegében ez határozza
	meg az összes soros eszköz alapértelmezett
	beállítását.</para>

      <para>Ha bizonyos beállítások
	megváltoztatását tiltani szeretnénk
	az alkalmazások felé, akkor azt a
	<quote>zárolt állapotot</quote> tartalmazó
	eszközben kell rögzítenünk.
	Például, ha a <filename>ttyd5</filename>
	eszköz sebességét fixen 57600&nbsp;bps-ra
	akarjuk beállítani, akkor írjuk be
	ezt:</para>

      <screen>&prompt.root; <userinput>stty -f /dev/ttyd5.lock 57600</userinput></screen>

      <para>Ezután ha egy alkalmazás megnyitja a
	<filename>ttyd5</filename> eszközt és
	megpróbálja a port sebességét
	átállítani, akkor az továbbra is
	57600&nbsp;bps marad.</para>

      <para>A kezdeti és a zárolt állapotot
	képezõ eszközöket általában
	csak a <systemitem class="username">root</systemitem> felhasználó
	számára szabad írhatóvá
	tenni.</para>

    </sect2>
  </sect1>

  <sect1 xml:id="term">
    <info><title>Terminálok</title>
      <authorgroup>
	<author><personname><firstname>Sean</firstname><surname>Kelly</surname></personname><contrib>Készítette: </contrib></author>
      </authorgroup>
    </info>

    

    <indexterm><primary>terminálok</primary></indexterm>

    <para>A terminálok olyankor kínálnak
      kényelmes és költséghatékony
      hozzáférést a &os; rendszerünkhöz,
      amikor sem a gép konzolját, sem pedig a
      hozzá tartozó hálózatot nem
      érjük el.  Ebben a szakaszban olvashatjuk,
      miként kell terminálokat használni &os;
      alatt.</para>

    <sect2 xml:id="term-uses">
      <title>A terminálok alkalmazásai és
	típusai</title>

      <para>Az eredeti &unix; rendszereknek nem voltak konzoljaik.
	Ehelyett az emberek a soros portokra csatlakoztatott
	terminálokon keresztül jelentkeztek be és
	így futtattak rajtuk programokat.  Ez nagyon
	hasonlít ahhoz, mint amikor egy modem és egy
	terminálprogram felhasználásával
	betárcsázunk egy távoli gépre
	és vele szöveges módban dolgozunk.</para>

      <para>Napjaink személyi
	számítógépein azonban
	találhatunk már akár nagy
	felbontású megjelenítéssel
	megáldott konzolokat is, habár a soros porton
	keresztüli bejelentkezés lehetõsége
	még mind a mai napig elérhetõ a legtöbb
	&unix;-alapú rendszerben.  Ez alól a &os; sem
	kivétel.  Ha rákötünk egy
	terminált a gépünk egyik üres soros
	portjára, akkor a megszokott módon képesek
	vagyunk bejelentkezni a rendszerbe és futtatni
	bármilyen szöveges programot, hasonlóan
	ahhoz, ahogy azt a konzolban vagy az X Window Systemben egy
	<command>xterm</command> ablakban megtehetjük.</para>

      <para>Ha egy irodában vagyunk, akkor egy &os; rendszerre
	több terminált is kapcsolhatunk, melyek az
	alkalmazottak asztalain foglalnak helyet.  Otthoni
	használat esetén egy kiöregedett
	számítógép, például
	egy régi IBM PC vagy egy &macintosh; is
	ráköthetõ egy gyorsabb &os; rendszerre.  Ennek
	segítségével az egyébként
	egyfelhasználós
	számítógépünket egy
	valódi többfelhasználós
	rendszerré alakíthatjuk.</para>

      <para>A &os; esetén háromféle
	terminálról beszélhetünk:</para>

      <itemizedlist>
	<listitem>
	  <para><link linkend="term-dumb">A buta (dumb)
	    terminálok</link></para>
	</listitem>

	<listitem>
	  <para><link linkend="term-pcs">A terminálként
	    funkcionáló személyi
	    számítógépek</link></para>
	</listitem>

	<listitem>
	  <para><link linkend="term-x">Az X
	    terminálok</link></para>
	</listitem>
      </itemizedlist>

      <para>A most következõ alszakaszokban ezeket
	fejtjük ki részletesebben.</para>

      <sect3 xml:id="term-dumb">
	<title>A buta terminálok</title>

	<para>A buta terminál alatt olyan
	  speciálizált eszközt értünk,
	  amellyel soros vonalon keresztül csatlakozunk
	  számítógépekhez.  Azért
	  nevezik ezeket <quote>butának</quote>, mert
	  csupán annyi számítási
	  teljesítményt zsúfoltak
	  beléjük, hogy szöveget legyenek
	  képesek küldeni, fogadni és
	  megjeleníteni.  Semmilyen program nem képes
	  rajtuk futni.  Helyette az a
	  számítógép fogja a
	  szövegszerkesztõt, fordítóprogramot,
	  levelezõ klienst, játékot és a
	  többit futtatni, amelyre vele
	  kapcsolódtunk.</para>

	<para>A buta termináloknak többszáz,
	  különbözõ gyártmányú
	  fajtája létezik.  Ilyenek például
	  a Digital Equipment VT-100 vagy a Wyse WY-75
	  típusú termináljai.  A &os; szinte
	  mindegyiküket ismeri.  Egyes drágább
	  terminálok még grafikus
	  megjelenítésre is képesek, de ezeket a
	  lehetõségeket csak bizonyos szoftverek
	  tudják ténylegesen kihasználni.</para>

	<para>A buta terminálok leginkább olyan
	  munkahelyeken terjedtek el, ahol az alkalmazottaknak nincs
	  szükségük grafikus alkalmazások,
	  tehát például az X Window System
	  használatára.</para>

      </sect3>

      <sect3 xml:id="term-pcs">
	<title>Személyi számítógépek
	  mint terminálok</title>

	<para>Ha egy <link linkend="term-dumb">buta
	  terminál</link> csupán szöveg
	  küldésére, fogadására
	  és megjelenítésére képes,
	  akkor bármelyik személyi
	  számítógép utána tudja
	  mindezt csinálni.  Ehhez mindössze egy
	  megfelelõ kábelre és az adott gépen
	  futó <emphasis>terminál
	  emulációs</emphasis> szoftverre van
	  szükségünk.</para>

	<para>Az ilyen fajta megoldás nagyon elterjedt az otthoni
	  használat esetén.  Például, ha
	  valamelyik családtagunk éppen szorgalmasan
	  dolgozik a &os; rendszerkonzolján, akkor a
	  rákapcsolt terminálon keresztül még
	  mi magunk is el tudunk végezni valamennyi szöveges
	  felületet igénylõ munkát.</para>

	<para>Az alap &os; rendszerben legalább két
	  segédprogram használható a soros vonali
	  kapcsolaton keresztüli munkára: a &man.cu.1;
	  és a &man.tip.1;.</para>

	<para>Egy &os; rendszerû kliensrõl így tudunk
	  csatlakozni egy másik rendszerre:</para>

	<screen>&prompt.root; <userinput>cu -l soros-vonali-eszköz</userinput></screen>

	<para>Ahol a <quote>soros-vonali-eszköz</quote> a
	  rendszerünkben a soros portot jelölõ
	  speciális eszköz neve.  Az ilyen
	  eszközök neve
	  <filename>/dev/cuadN</filename>.</para>

	<para>Az eszköz nevében az <quote>N</quote>-es
	  rész a soros port sorszámát adja
	  meg.</para>

	<note>
	  <para>A &os;-ben az eszközök
	    sorszámozása nullától
	    kezdõdik, nem pedig egytõl (ellentétben
	    tehát azzal, ahogy azt az &ms-dos; rendszerekben
	    és leszármazottaikban már
	    megszokhattuk).  Ez azt jelenti, hogy amit az &ms-dos;
	    alapú rendszerekben <filename>COM1</filename>-nek
	    hívnak, az a &os;-ben általában a
	    <filename>/dev/cuad0</filename>.</para>
	</note>

	<note>
	  <para>Egyes emberek más, többnyire a
	    Portgyûjteménybõl is elérhetõ
	    programokat szeretnek inkább használni.  A
	    portok között találhatunk elég sok
	    olyan szoftvert, amely a &man.cu.1; és a &man.tip.1;
	    programokhoz hasonlóan mûködik.  Ilyen
	    például a <package>comms/minicom</package>.</para>
	</note>

      </sect3>

      <sect3 xml:id="term-x">
	<title>Az X terminálok</title>

	<para>Az X terminálok a terminálok közül
	  a legfejlettebbek.  Általában nem is soros
	  porton, hanem hálózaton, például
	  Etherneten keresztül csatlakoznak.  Természetesen
	  nem csak szöveges alkalmazásokat, hanem
	  lényegében bármilyen X alkalmazást
	  képesek megjeleníteni.</para>

	<para>Az X terminálokról itt most csak a
	  teljesség kedvéért szólunk, de
	  ebben a fejezetben <emphasis>nem</emphasis>
	  szándékozunk tárgyalni az X
	  terminálok csatlakoztatását,
	  beállítását és
	  használatát.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="term-config">
      <title>Beállítás</title>

      <para>Ebben a fejezetben ismertetjük mindazt, ami ahhoz kell,
	hogy a &os; rendszerünkön engedélyezni tudjuk a
	terminálon keresztüli bejelentkezéseket.
	Feltételezzük, hogy a rendszermagunk
	támogatja a terminálok által
	használt soros portokat, illetve, hogy ezeket már
	csatlakoztattuk is.</para>

      <para>Ha visszagondolunk a <xref linkend="boot"/>re, akkor
	eszünkbe juthat, hogy a rendszer indításakor
	az <command>init</command> nevû program felelõs az
	összes futó program
	irányításáért és
	inicializálódásáért.  Az
	<command>init</command> egyik feladata, hogy beolvassa az
	<filename>/etc/ttys</filename> állományt és
	neki megfelelõen az elérhetõ
	terminálokon elindítsa a <command>getty</command>
	programot.  A <command>getty</command> felelõs a
	bejelentkezéshez szükséges
	azonosító beolvasásáért
	és a <command>login</command> program
	elindításáért.</para>

      <para>Ennek megfelelõen tehát, ha a &os;
	rendszerünkön terminálokat akarunk
	beállítani, akkor ehhez a következõ
	lépéseket kell megtennünk
	<systemitem class="username">root</systemitem>
	felhasználóként:</para>

      <procedure>
	<step>
	  <para>Az <filename>/etc/ttys</filename>
	    állományba vegyünk fel egy
	    bejegyzést a soros porthoz tartozó
	    <filename>/dev</filename> könyvtárbeli
	    eszközhöz, ha még nem szerepelne
	    benne.</para>
	</step>

	<step>
	  <para>A porthoz adjuk meg a
	    <command>/usr/libexec/getty</command> programot, majd
	    hozzá az <filename>/etc/gettytab</filename>
	    állományból válasszuk ki a
	    megfelelõ <replaceable>getty</replaceable>
	    típust.</para>
	</step>

	<step>
	  <para>Adjuk meg a terminál alapértelmezett
	    típusát.</para>
	</step>

	<step>
	  <para>Állítsuk a portot <quote>on</quote>
	    (bekapcsolt) állapotúra.</para>
	</step>

	<step>
	  <para>Adjuk meg, hogy a port <quote>secure</quote>
	    (biztonságos) legyen-e.</para>
	</step>

	<step>
	  <para>Mondjuk meg az <command>init</command> programnak, hogy
	    olvassa újra az <filename>/etc/ttys</filename>
	    állományt.</para>
	</step>
      </procedure>

      <para>A másik lépés
	kiegészítõ lépéseként az
	<filename>/etc/gettytab</filename> állományban mi
	magunk is létrehozhatunk egy saját
	<replaceable>getty</replaceable> típust.  A fejezetben
	ehhez ugyan nem adunk segítséget, de ha
	érdekel minket a téma, akkor ezzel kapcsolatban a
	&man.gettytab.5; és &man.getty.8; man oldalakat
	érdemes elolvasni.</para>

      <sect3 xml:id="term-etcttys">
	<title>Egy bejegyzés felvétele az
	  <filename>/etc/ttys</filename>
	  állományba</title>

	<para>Az <filename>/etc/ttys</filename>
	  állományban találhatjuk meg az
	  összes portot, ahonnan a &os; rendszerünk
	  engedélyezi a bejelentkezést.
	  Például a <filename>ttyv0</filename>, az
	  elsõ virtuális konzol is szerepel benne.  Ezen a
	  bejegyzésen keresztül tudunk bejelentkezni a
	  konzolra.  Ebben az állományban találjuk
	  meg még a többi virtuális konzol, soros
	  port és pszeudoterminál bejegyzéseit is.
	  A rögzített terminálok esetén
	  egyszerûen csak adjuk meg a soros porthoz tartozó
	  <filename>/dev</filename> könyvtárbeli
	  eszközt a <filename>/dev</filename> elõtag
	  nélkül (így például a
	  <filename>/dev/ttyv0</filename> <filename>ttyv0</filename>
	  néven fog megjelenni).</para>

	<para>Az alap &os; telepítésben egy olyan
	  <filename>/etc/ttys</filename> állomány
	  található, amely tartalmazza az elsõ
	  négy soros portot, a <filename>ttyd0</filename>
	  eszköztõl kezdve a <filename>ttyd3</filename>
	  eszközig.  Ha tehát ezekre a portokra
	  csatlakoztatnunk egy terminált, akkor már nem
	  kell egy újabb bejegyzést felvennünk
	  hozzájuk.</para>

	<example xml:id="ex-etc-ttys">
	  <title>Terminálok felvétele az
	    <filename>/etc/ttys</filename>
	    állományba</title>

	  <para>Tegyük fel, hogy két eszközt
	    szeretnénk a rendszerünkhöz csatlakoztatni:
	    egy Wyse-50-es terminált és egy régi
	    286-os IBM PC-t, amelyen a
	    <application>Procomm</application>
	    terminálszoftverrel emulálunk egy VT-100-as
	    terminált.  A Wyse terminált a második
	    soros portunkra kötjük, míg a 286-ost a
	    hatodik soros portra (például egy
	    többportos soros vonali kártyán).  A
	    nekik megfelelõ <filename>/etc/ttys</filename>
	    állománybeli bejegyzések így
	    fognak kinézni:</para>

	  <programlisting>ttyd1<co xml:id="co-ttys-line1col1"/>  "/usr/libexec/getty std.38400"<co xml:id="co-ttys-line1col2"/>  wy50<co xml:id="co-ttys-line1col3"/>  on<co xml:id="co-ttys-line1col4"/>  insecure<co xml:id="co-ttys-line1col5"/>
ttyd5   "/usr/libexec/getty std.19200"  vt100  on  insecure
	  </programlisting>

	  <calloutlist>
	    <callout arearefs="co-ttys-line1col1">
	      <para>Az elsõ mezõben általában a
		terminálhoz tartozó eszközt
		nevezzük meg, amely a <filename>/dev</filename>
		könyvtárban található.</para>
	    </callout>

	    <callout arearefs="co-ttys-line1col2">
	      <para>A második mezõ a vonalhoz tartozó
		végrehajtandó parancs, ami
		általában a &man.getty.8;.  A
		<command>getty</command> mûködésbe
		helyezi és megnyitja a vonalat,
		beállítja a sebességét,
		bekéri a felhasználó nevét,
		majd elindítja a &man.login.1; programot.</para>

	      <para>A <command>getty</command> program egy
		(opcionális) paramétert fogad el a
		parancssorában, ami a
		<replaceable>getty</replaceable> típusa.  Egy
		ilyen <replaceable>getty</replaceable> típus
		szabja meg a terminálhoz tartozó vonal
		jellemzõit, például az
		adatátviteli sebességet és a
		paritást.  A <command>getty</command> ezeket a
		jellemzõket az <filename>/etc/gettytab</filename>
		állományból olvassa be.</para>

	      <para>A <filename>/etc/gettytab</filename> egyaránt
		tartalmaz bejegyzéseket a régi és
		új típusú terminálokhoz.  Az
		<literal>std</literal> szöveggel kezdõdõ
		bejegyzések szinte majdnem minden esetben
		mûködnek a hardveres terminálokkal.  Az
		ilyen bejegyzések figyelmen kívül
		hagyják a paritást.  110 és
		115&nbsp;200&nbsp;bps között minden
		adatátviteli sebességhez tartozik egy-egy
		<literal>std</literal> bejegyzés.
		Természetesen ebbe az állományba
		akár a saját bejegyzéseinket is
		elkészíthetjük.  A &man.gettytab.5;
		man oldal nyújt ehhez átfogó
		segítséget.</para>

	      <para>Amikor az<filename>/etc/ttys</filename>
		állományban megadjuk a
		<replaceable>getty</replaceable> típusát,
		akkor ellenõrizzük, hogy a
		beállításai megfelelnek a
		terminálénak.</para>

	      <para>A példánknál maradva: a Wyse-50
		nem használ paritást és
		38&nbsp;400&nbsp;bps-en üzemel.  A 286-os
		gép szintén nem dolgozik paritással
		és 19200&nbsp;bps-sel kapcsolódik.</para>
	    </callout>

	    <callout arearefs="co-ttys-line1col3">
	      <para>A harmadik mezõben adjuk meg
		általában a vonalra csatlakozó
		terminál típusát.  Ez a
		betárcsázós portok esetében
		többnyire az <literal>unknown</literal> vagy a
		<literal>dialup</literal>, mivel ezeken keresztül a
		felhasználók gyakorlatilag szinte
		bármilyen típusú terminállal
		vagy szoftverrel be tudnak jelentkezni.  A hardveres
		termináloknál a terminál
		típusa azonban nem változik, ezért
		a &man.termcap.5; adatbázisban keressük ki a
		nekik megfelelõt és adjuk meg ebben a
		mezõben.</para>

	      <para>A példánkban a Wyse-50 egy
		valós termináltípust
		használ, miközben a 286-oson futó
		<application>Procomm</application> egy VT-100-as
		típusú terminált
		emulál.</para>
	    </callout>

	    <callout arearefs="co-ttys-line1col4">
	      <para>A negyedik mezõ azt mondja meg, hogy a port
		engedélyezett-e vagy sem.  Ha itt a
		<literal>on</literal> értéket adjuk meg,
		akkor az <command>init</command> elindítja a
		második mezõben szereplõ
		<command>getty</command> programot.  Ha viszont itt az
		<literal>off</literal> szerepel, akkor a
		<command>getty</command> nem fog elindulni, így
		ezen a porton be sem fogunk tudni jelentkezni.</para>
	    </callout>

	    <callout arearefs="co-ttys-line1col5">
	      <para>Az utolsó mezõben a port
		megbízhatóságát kell
		megjelölnünk.  Ha biztonságosnak
		(<literal>secure</literal>) állítjuk be a
		portot, akkor rajta keresztül a
		<systemitem class="username">root</systemitem> (vagy bármelyik
		nullás felhasználói
		azonosítóval rendelkezõ)
		felhasználó be tud jelentkezni.  Amikor
		viszont nem biztonságos
		(<literal>insecure</literal>), akkor elõször
		egy normál felhasználóval kell
		bejelentkeznünk, majd a &man.su.1; programmal vagy
		egy hozzá hasonló megoldással kell
		rendszeradminisztrátorrá
		válnunk.</para>

	      <para>Leginkább az <literal>insecure</literal>
		beállítást javasoljuk, még
		hét lakat alatt õrzött
		terminálok esetében is.
		Valójában sokkal egyszerûbb
		bejelentkezni, majd kiadni egy <command>su</command>
		parancsot, ha netalán
		rendszeradminisztrátori jogosultságokra
		lenne szükségünk.</para>
	    </callout>
	  </calloutlist>
	</example>

      </sect3>

      <sect3 xml:id="term-hup">
	<title>A <command>init</command> utasítása az
	  <filename>/etc/ttys</filename>
	  újraolvasására</title>

	<para>Miután az <filename>/etc/ttys</filename>
	  állományban elvégeztük a
	  megfelelõ módosításokat, a
	  konfigurációs állomány
	  újraolvasásához küldjünk egy
	  SIGHUP (bontás) jelzést az
	  <command>init</command> programnak.  Mint
	  például:</para>

	<screen>&prompt.root; <userinput>kill -HUP 1</userinput></screen>

	<note>
	  <para>Mivel mindig az <command>init</command> indul el
	    elsõként a rendszerben, ezért a
	    hozzá tartozó azonosító az 1
	    lesz.</para>
	</note>

	<para>Ha mindent jól állítottunk be, a
	  kábelek is a helyükön vannak és a
	  terminálokat is bekapcsoltuk, akkor minden
	  terminálhoz elindul egy <command>getty</command>
	  program, és mindegyikõjükön megjelenik a
	  bejelentkezõ képernyõ.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="term-debug">
      <title>A terminálokkal kapcsolatos
	hibajelenségek</title>

      <para>Olykor hiába igyekszünk a lehetõ
	legaprólékosabban ügyelni minden apró
	részletre, könnyen elõfordulhat, hogy
	valamiért a terminál mégsem
	mûködik rendesen.  Következzen most egy lista
	néhány ismert tünetrõl és azok
	javasolt gyógymódjairól.</para>

      <sect3>
	<title>Nem jelenik meg a bejelentkezõ
	  képernyõ</title>

	<para>Ellenõrizzük, hogy a terminált rendesen
	  csatlakoztattuk és áram alá
	  helyeztük.  Amikor egy személyi
	  számítógépet használunk
	  terminálnak, akkor nézzük meg, hogy a
	  terminál emulációs program a
	  megfelelõ soros porton fut.</para>

	<para>Vizsgáljuk meg, hogy a kábel mind a
	  két vége pontosan illeszkedik a portokba.
	  Gyõzõdjünk meg róla, hogy valóban
	  a megfelelõ típusú kábelt
	  használjuk.</para>

	<para>Nézzük meg, hogy a terminál és a
	  &os; is ugyanazon az adatátviteli sebességen
	  és paritási beállítással
	  megy.  Ha képernyõvel rendelkezõ
	  terminálunk van, akkor a kontrasztot és
	  fényerõsséget is ellenõrizzük.
	  Ha nyomtatós terminálunk van, akkor
	  vizsgáljuk meg a papír és a tinta
	  állapotát.</para>

	<para>Gyõzõdjünk meg róla, hogy a
	  <command>getty</command> valóban fut és rendesen
	  kiszolgálja a terminált.  Például
	  a <command>ps</command> paranccsal listázzuk ki az
	  összes jelenleg futó programot és
	  keressük meg köztük a <command>getty</command>
	  programot:</para>

	<screen>&prompt.root; <userinput>ps -axww|grep getty</userinput></screen>

	<para>Ekkor látnunk kell a terminálhoz
	  tartozó bejegyzést.  Például, ha a
	  <command>getty</command> második soros portot
	  jelképezõ <filename>ttyd1</filename>
	  eszközön fut, és az
	  <filename>/etc/gettytab</filename>
	  állományból az
	  <literal>std.38400</literal> nevû bejegyzést
	  használja, akkor ez jelenik meg:</para>

	<screen>22189  d1  Is+    0:00.03 /usr/libexec/getty std.38400 ttyd1</screen>

	<para>Amennyiben semmilyen <command>getty</command> nem fut,
	  akkor ellenõrizzük, hogy valóban
	  engedélyeztük-e a portot az
	  <filename>/etc/ttys</filename> állományban.  A
	  <filename>ttys</filename> állomány
	  átírása után ne felejtsük el
	  kiadni a <command>kill -HUP 1</command> parancsot sem.</para>

	<para>Ha a <command>getty</command> fut, de a terminálon
	  továbbra sem látjuk a bejelentkezõ
	  képernyõt, vagy megjelenik, de nem tudunk
	  gépelni, akkor elõfordulhat, hogy a
	  terminál vagy kábel nem támogatja a
	  hardveres kézfogást (handshaking).
	  Próbáljuk meg az <filename>/etc/ttys</filename>
	  állományban levõ
	  <literal>std.38400</literal> bejegyzést az
	  <literal>3wire.38400</literal> bejegyzésre
	  kicserélni (de utána ne felejtsük el kiadni
	  a <command>kill -HUP 1</command> parancsot).  A
	  <literal>3wire</literal> nagyon hasonlít az
	  <literal>std</literal> bejegyzéshez, de elhagyja a
	  hardveres kézfogást.  A <literal>3wire</literal>
	  alkalmazásakor viszont a puffer
	  telítõdésének megelõzése
	  érdekében próbálkozzunk az
	  adatátviteli sebesség
	  csökkentésével vagy
	  engedélyezzük a szoftveres
	  forgalomirányítást.</para>

      </sect3>

      <sect3>
	<title>Amikor mindenféle szemét jelenik meg a
	  képernyõn</title>

	<para>Ellenõrizzük, hogy a &os; és a
	  terminál ugyanazt az adatátviteli
	  sebességet és paritási
	  beállítást használja.
	  Nézzük meg a futó <command>getty</command>
	  programokat, és hogy a megfelelõ
	  <replaceable>getty</replaceable> típussal mennek-e.  Ha
	  nem, módosítsuk az
	  <filename>/etc/ttys</filename> állományt
	  és adjuk ki a <command>kill -HUP 1</command>
	  parancsot.</para>

      </sect3>

      <sect3>
	<title>A karakterek duplán jelennek meg, a jelszó
	  begépelésekor látható</title>

	<para>Állítsuk át a terminált (vagy
	  a terminál emulációs szofvert)
	  <quote>half duplex</quote> vagy <quote>local echo</quote>
	  módról <quote>full duplex</quote>
	  módra.</para>

      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="dialup">
    <info><title>Betárcsázós
      szolgáltatások</title>
      <authorgroup>
	<author><personname><firstname>Guy</firstname><surname>Helmer</surname></personname><contrib>Készítette: </contrib></author>
      </authorgroup>
      <authorgroup>
	<author><personname><firstname>Sean</firstname><surname>Kelly</surname></personname><contrib>Kiegészítette: </contrib></author>
      </authorgroup>
    </info>

    

    <indexterm><primary>betárcsázós
      szolgáltatás</primary></indexterm>

    <para>Amikor egy &os; rendszert akarunk
      betárcsázós szolgáltatásokhoz
      beállítani, akkor az nagyon hasonlít a
      terminálok csatlakoztatásához, azzal a
      eltéréssel, hogy ilyenkor a terminálok
      helyett modemekkel kell dolgoznunk.</para>

      <sect2>
	<title>Külsõ kontra belsõ modemek</title>

	<para>A külsõ modemek sokkal kényelmesebbnek
	  tûnnek betárcsázás
	  szempontjából, mivel az ilyenek gyakran a
	  statikus memóriájukban tárolt
	  paraméterek révén tulajdonképpen
	  félig elõre be vannak állítva
	  és sok esetben a fontosabb RS-232 jeleket
	  külön lámpácskákkal
	  mutatják.  A villogó lámpák
	  könnyen elkápráztatják a laikusokat,
	  de emellett igen fontosak a modem
	  mûködõképességének
	  megállapításában is.</para>

	<para>Ezzel szemben a belsõ modemeken nem
	  található statikus memória, ezért
	  a paramétereik csak DIP kapcsolókkal
	  módosíthatóak.  Még ha egy
	  belsõ modemem látunk is lámpákat,
	  akkor sem könnyû figyelni rájuk, mert a
	  gépünk burkolata úgyis eltakarja
	  ezeket.</para>

      <sect3>
	<title>Modemek és kábelek</title>

	<indexterm><primary>modem</primary></indexterm>

	<para>Ha külsõ modemet használunk, akkor
	  mindenképpen szükségünk lesz
	  hozzá még egy megfelelõ kábelre is.
	  Egy szabványos RS-232-es soros kábel erre
	  tökéletesen megfelel egészen addig,
	  amíg a normál jeleket így
	  kötötték be rajta:</para>

	  <table frame="none" pgwide="1" xml:id="serialcomms-signal-names">
	    <title>A jelek neve</title>

	    <tgroup cols="2">
	      <thead>
		<row>
		  <entry align="left">Rövidítés</entry>
		  <entry align="left">Elnevezés</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry><acronym>RD</acronym></entry>
		  <entry>Received Data (fogadott adat)</entry>
		</row>

		<row>
		  <entry><acronym>TD</acronym></entry>
		  <entry>Transmitted Data (küldött
		    adat)</entry>
		</row>

		<row>
		  <entry><acronym>DTR</acronym></entry>
		  <entry>Data Terminal Ready (adatterminál
		    kész)</entry>
		</row>

		<row>
		  <entry><acronym>DSR</acronym></entry>
		  <entry>Data Set Ready
		    (adatbeállítás
		    kész)</entry>
		</row>

		<row>
		  <entry><acronym>DCD</acronym></entry>
		  <entry>Data Carrier Detect (vonal
		    észlése &mdash; az RS-232
		    fogadást érzékelõ
		    vonala)</entry>
		</row>

		<row>
		  <entry><acronym>SG</acronym></entry>
		  <entry>Signal Ground (föld)</entry>
		</row>

		<row>
		  <entry><acronym>RTS</acronym></entry>
		  <entry>Request to Send (küldés
		    kérése)</entry>
		</row>

		<row>
		  <entry><acronym>CTS</acronym></entry>
		  <entry>Clear to Send (küldés
		    engedélyezése)</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </table>

	<para>A &os;-nek 2400&nbsp;bps felett a forgalom
	  irányításához az
	  <acronym>RTS</acronym> és <acronym>CTS</acronym>
	  jelekre van szüksége.  A <acronym>CD</acronym>
	  jellel állapítja meg, hogy a hívás
	  létrejött vagy a bontották a vonalat,
	  és a <acronym>DTR</acronym> jel hozza
	  alapállapotba a modemet a munkamenet befejezése
	  után.  Egyes kábelekben nem mindegyik jelet
	  vezették át, így ha például
	  gondjaink akadnak a bejelentkezõ képernyõvel
	  amikor a vonalat bontjuk, akkor érdemes
	  átnéznünk a kábelt.</para>

	<para>A többi &unix;-szerû operációs
	  rendszerhez hasonlóan a &os; is hardveres jelek
	  segítségével igyekszik kideríteni,
	  hogy a hívás megvalósult vagy
	  bontották a vonalat, valamint a hívás
	  befejezése után így bontja a vonalat
	  és állítja vissza a modemet.  A &os;
	  igyekszik elkerülni a parancsok
	  küldését a modem felé, vagy a modem
	  állapotának folyamatos
	  ellenõrzését.  Ha már van
	  némi tapasztalatunk a PC-alapú BBS-ek modemes
	  elérését illetõen, akkor
	  valószínûleg értjük ezek
	  okait.</para>

      </sect3>
    </sect2>

    <sect2>
      <title>A soros vonali felülettel kapcsolatos
	megfontolások</title>

      <para>A &os; ismeri az NS8250-, NS16450-, NS16550- és
	NS16550A alapú EIA&nbsp;RS-232C (CCITT&nbsp;V.24)
	szabványú kommunikációs
	felületeket.  A 8250-es és a 16450-es
	eszközök egykarakteres pufferrel rendelkeznek.  A
	16550-es eszközök 16 karakteres puffert tartalmaznak,
	amellyel jobb teljesítmény érhetõ el.
	(A sima 16550-esben levõ hibák miatt azonban ez a 16
	karakteres puffer nem használható ki rendesen,
	ezért lehetõleg a 16550A verziót
	használjuk).  Mivel az operációs rendszer
	részérõl az egykarakteres eszközök
	jóval több törõdést
	igényelnek, mint a 16 karakteres eszközök,
	ezért inkább a 16550A alapú soros
	felületi kártyákat ajánljuk.  Amikor a
	rendszer egyszerre több soros portot is kezel, vagy
	erõs terhelés alatt áll, akkor a 16550A
	alapú kártyákról
	általában az is elmondható, hogy kisebb
	hibával dolgoznak.</para>

      </sect2>

    <sect2>
      <title>Egy gyors áttekintés</title>

      <indexterm><primary>getty</primary></indexterm>

      <para>Ahogy arról már a terminálok
	esetében szó esett, az <command>init</command> az
	összes betárcsázós kapcsolathoz
	tartozó soros porthoz elindít egy
	<command>getty</command> programot.  Például, ha a
	modemet a <filename>/dev/ttyd0</filename> eszközre
	kapcsoltuk, akkor a <command>ps ax</command> parancs
	kimenetében ezt láthatjuk:</para>

      <screen> 4850 ??  I      0:00.09 /usr/libexec/getty V19200 ttyd0</screen>

      <para>Amikor egy felhasználó felhívja a
	modemet és az kapcsolódik, akkor a modem egy
	<acronym>CD</acronym> (Carrier Detect) jelet küld.  A
	rendszermag ekkor tudomásul veszi a vonal
	észlelését és a
	<command>getty</command> segítségével
	megindítja a kommunikációt.  A
	<command>getty</command> egy <prompt>login:</prompt>
	szöveget küld át a vonalhoz megadott
	sebességgel.  A <command>getty</command> elkezdi
	figyelni, hogy a értelmes karakterek érkeznek-e
	vissza, és egy átlagos
	konfigurációban, ha ezt szemétnek
	találja (mert például a modem nem a
	<command>getty</command> számára
	beállított sebességgel csatlakozott), akkor
	megpróbálja egészen addig hangolni a vonal
	sebességét, amíg feldolgozásra
	alkalmas karaktereket nem kap.</para>

      <indexterm><primary><command>/usr/bin/login</command></primary></indexterm>

      <para>Miután a felhasználó megadta a
	felhasználói nevét, a
	<command>getty</command> elindítja a
	<filename>/usr/bin/login</filename> programot, amely befejezi a
	beléptetést a felhasználó
	jelszavának bekérésével és
	annak elfogadása esetén a
	hozzá tartozó parancsértelmezõ
	elindításával.</para>

    </sect2>

    <sect2>
      <title>A konfigurációs
	állományok</title>

      <para>&os; rendszerünkben a betárcsázós
	kapcsolatok engedélyezéséhez az
	<filename>/etc</filename> könyvtárban három
	állomány módosítására
	lesz szükségünk.  Közülük az
	elsõ, az <filename>/etc/gettytab</filename> a
	<filename>/usr/libexec/getty</filename> démon
	beállításait tartalmazza.  A
	második, az <filename>/etc/ttys</filename> az
	<filename>/sbin/init</filename> számára mondja
	meg, hogy melyik <filename>tty</filename>
	eszközökhöz tartozik <command>getty</command>.
	Végezetül a portok
	inicializálásához kötõdõ
	beállításokat az
	<filename>/etc/rc.d/serial</filename> szkriptben kell
	megadnunk.</para>

      <para>Két <quote>iskola</quote> jött létre
	aszerint, hogy &unix; alatt hogyan használják a
	betárcsázós modemeket.  Az egyik csoport
	úgy szereti beállítani a modemeit és
	rendszerit, hogy a távoli felhasználó
	által választott sebességtõl
	függetlenül a számítógép
	és a modem közti RS-232 felület egy fix
	sebességen fut.  Ennek a
	beállításnak megvan az az elõnye, hogy
	a távoli felhasználó ilyenkor szinte
	azonnal megkapja a bejelentkezõ képernyõt.  A
	hátránya viszont, hogy ebben az esetben a rendszer
	nem ismeri a felhasználó valódi
	adatátviteli sebességét, ezért az
	olyan teljes képernyõs alkalmazások, mint
	például az <application>Emacs</application>, nem
	lesznek képesek a lassabb kapcsolatokhoz szabni a
	megjelenítésüket.</para>

      <para>A másik csoport a modemek RS-232-es
	felületét a távoli felhasználó
	kapcsolódási sebessége szerint
	állítja be.  Így például egy
	V.32bis (14,4&nbsp;Kbps) kapcsolat esetén a modemhez
	tartozó RS-232 felület 19,2&nbsp;Kbps-on fog menni,
	miközben a 2400&nbsp;bps sebességû
	kapcsolatokhoz egy vele azonos sebességû RS-232-es
	felület fog tartozni.  Mivel a <command>getty</command> nem
	képes kommunikálni a modemek által
	lejelentett csatlakozási sebességen, ezért
	úgy próbálja azt
	megállapítani, hogy elküldi a
	<prompt>login:</prompt> szöveget az alap
	sebességgel, majd figyeli a válaszul
	érkezõ karaktereket.  Ha a felhasználó
	ilyenkor szemetet lát, akkor feltételezik, hogy
	addig fogja nyomkodni az <keycap>Enter</keycap> billentyût,
	amíg valami értelmes szöveget meg nem
	lát.  Amikor az adatátviteli sebesség
	eltér, akkor a <command>getty</command> ebbõl
	csupán csak annyit vesz észre, hogy a
	felhasználó <quote>szemetet</quote> küld,
	ezért egy újabb sebességgel
	megpróbálja megint elküldeni a
	<prompt>login:</prompt> szöveget.  Hivatalosan ez a
	folyamat ismétlõdik orrvérzésig, de
	általában csak egy-két billentyût kell
	leütni a megfelelõ
	beállításokhoz.  Nyilvánvaló,
	hogy ilyenkor a bejelentkezés messze nem olyan
	zavartalan, mint a <quote>rögzített
	sebességû</quote> esetben, de így a lassabb
	kapcsolattal rendelkezõ felhasználók is jobb
	használatóságot kapnak a teljes
	képernyõs programokkal.</para>

      <para>Ebben a szakaszban egy valamennyire kiegyensúlyozott
	beállítást igyekszünk bemutatni, de
	részben elfogunk hajlani abban az irányba, amikor
	a modem a kapcsolat sebességét követi.</para>

      <sect3>
	<title><filename>/etc/gettytab</filename></title>

	<indexterm><primary><filename>/etc/gettytab</filename></primary></indexterm>

	<para>A <filename>/etc/gettytab</filename> egy
	  &man.termcap.5;-szerû állomány, amely a
	  &man.getty.8; beállításait tartalmazza.
	  A &man.gettytab.5; man oldalon olvashatunk az
	  állomány pontos
	  felépítésérõl és benne
	  felsorolt beállításokról.</para>

	<sect4>
	  <title>A rögzített sebességû
	    beállítás</title>

	  <para>Ha a modem kommunikációs
	    sebességét rögzíteni akarjuk,
	    akkor ehhez többnyire semmit sem kell
	    megváltoztatnunk az
	    <filename>/etc/gettytab</filename>
	    állományban.</para>

	</sect4>

	<sect4>
	  <title>Az alkalmazkodó sebességû
	    beállítás</title>

	  <para>Az <filename>/etc/gettytab</filename>
	    állományban létre kell hoznunk egy
	    olyan bejegyzést, amelyen keresztül a
	    <command>getty</command> tudni fogja, hogy milyen
	    sebességeken akarjuk használni a modemet.  Ha
	    egy 2400&nbsp;bps sebességû modemünk van,
	    akkor hozzá a már meglevõ
	    <literal>D2400</literal>-as bejegyzést kell
	    használnunk.</para>

	  <programlisting>#
# A gyors betárcsázós terminálokhoz íme egy 2400/1200/300-as váltás
# (bárhonnan kezdõdhet):
#
D2400|d2400|Fast-Dial-2400:\
        :nx=D1200:tc=2400-baud:
3|D1200|Fast-Dial-1200:\
        :nx=D300:tc=1200-baud:
5|D300|Fast-Dial-300:\
        :nx=D2400:tc=300-baud:</programlisting>

	  <para>Ha ennél gyorsabb modemünk van, akkor
	    már mindenképpen fel kell vennünk
	    hozzá egy új bejegyzést az
	    <filename>/etc/gettytab</filename> állományba.
	    Ezzel a beállítással egy 14,4&nbsp;Kbps
	    sebességû modemet tudunk legfeljebb
	    19,2&nbsp;Kbps-en használni:</para>

	  <programlisting>#
# Kiegészítések egy V.32bis modemhez:
#
um|V300|High Speed Modem at 300,8-bit:\
        :nx=V19200:tc=std.300:
un|V1200|High Speed Modem at 1200,8-bit:\
        :nx=V300:tc=std.1200:
uo|V2400|High Speed Modem at 2400,8-bit:\
        :nx=V1200:tc=std.2400:
up|V9600|High Speed Modem at 9600,8-bit:\
        :nx=V2400:tc=std.9600:
uq|V19200|High Speed Modem at 19200,8-bit:\
        :nx=V9600:tc=std.19200:</programlisting>

	  <para>Ennek eredménye egy 8&nbsp;bites,
	    paritásmentes kapcsolat lesz.</para>

	  <para>A fenti példában a
	    kommunikációt 19,2&nbsp;Kbps-en (V.32bis
	    kapcsolaton) kezdjük, majd utána haladunk
	    végig a 9600&nbsp;bps (V.32), 2400&nbsp;,
	    1200&nbsp;bps és 300&nbsp;bps sebességû
	    kapcsolatokon, majd vissza ismét a 19,2&nbsp;Kbps-re.
	    Az adatátviteli sebesség ilyen
	    típusú váltogatását az
	    <literal>nx=</literal> (<quote>next table</quote>, azaz
	    <quote>következõ táblázat</quote>)
	    tulajdonság segítségével
	    valósítják meg.  Minden sorban
	    látható még egy <literal>tc=</literal>
	    (<quote>table continuation</quote>, vagyis <quote>a
	    táblázat folytatása</quote>)
	    bejegyzés is, amivel az adott adatátviteli
	    sebesség <quote>szabványos</quote>
	    beállításait adjuk meg.</para>

	  <para>Ha egy 28,8&nbsp;Kbps sebességû
	    modemünk van és/vagy egy 14,4&nbsp;Kbps
	    sebességû modemen akarunk
	    tömörítést használni, akkor a
	    19,2&nbsp;Kbps-nél nagyobb
	    kommunikációs sebességet kell
	    használnunk.  Íme egy olyan
	    <filename>gettytab</filename>.  ami 57,6&nbsp;Kbps-rõl
	    indít:</para>

	  <programlisting>#
# A V.32bis vagy V.34 modemekhez kiegészítés,
# 57,6 Kbps-rõl indulunk:
#
vm|VH300|Very High Speed Modem at 300,8-bit:\
        :nx=VH57600:tc=std.300:
vn|VH1200|Very High Speed Modem at 1200,8-bit:\
        :nx=VH300:tc=std.1200:
vo|VH2400|Very High Speed Modem at 2400,8-bit:\
        :nx=VH1200:tc=std.2400:
vp|VH9600|Very High Speed Modem at 9600,8-bit:\
        :nx=VH2400:tc=std.9600:
vq|VH57600|Very High Speed Modem at 57600,8-bit:\
        :nx=VH9600:tc=std.57600:</programlisting>

	  <para>Ha lassú a processzorunk, vagy a rendszerünk
	    túlságosan terhelt és nincs 16550A
	    típusú soros portunk, akkor 57,6&nbsp;Kbps-en
	    <errorname>sio</errorname> <quote>silo</quote> hibák
	    keletkezhetnek.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="dialup-ttys">
	<title><filename>/etc/ttys</filename></title>

	<indexterm><primary><filename>/etc/ttys</filename></primary></indexterm>

	<para>Az <filename>/etc/ttys</filename> állomány
	  beállításáról már a
	  <xref linkend="ex-etc-ttys"/> adott képet.  Ez a modemek
	  esetében sem tér el különösebben,
	  habár a <command>getty</command> programnak más
	  termináltípust és
	  -beállításokat kell átadnunk.
	  Akár rögzített, akár
	  alkalmazkodó sebességet akarunk
	  beállítani, ennek általános alakja
	  az alábbi:</para>

	<programlisting>ttyd0   "/usr/libexec/getty <replaceable>xxx</replaceable>"   dialup on</programlisting>

	<para>A sorban látható elsõ elem a
	  megfelelõ speciális eszköz neve &mdash; jelen
	  esetben ez a <filename>ttyd0</filename>, amely a
	  <filename>/dev/ttyd0</filename> eszközre vonatkozik
	  és ezt fogja a <command>getty</command> figyelni.  A
	  második elem, vagyis a <literal>"/usr/libexec/getty
	  xxx"</literal> (ahol a
	  <replaceable>xxx</replaceable> helyére kell
	  beírni a megfelelõ <filename>gettytab</filename>
	  állománybeli bejegyzést nevét)
	  lesz az a parancs, amelyet az <command>init</command>
	  meghív.  A harmadik elem, a <literal>dialup</literal> a
	  terminálok alapértelmezett típusa.  A
	  negyedik paraméter, az <literal>on</literal> jelzi az
	  <command>init</command> programnak, hogy aktiválja a
	  vonalat.  A sorban megjelenhetne továbbá
	  még egy ötödik paraméter is, a
	  <literal>secure</literal>, de ezt csak olyan terminálok
	  esetében érdemes megadni, amelyek fizikailag
	  megbízhatóak (például a
	  rendszerkonzol).</para>

	<para>Az alapértelmezett termináltípus
	  (vagyis a fenti példában a
	  <literal>dialup</literal>) a helyi
	  beállításoktól függ.  A
	  betárcsázós vonalak esetében
	  hagyományosan a <literal>dialup</literal> a
	  terminál alapértelmezett típusa, amit
	  aztán a felhasználók a
	  bejelentkezéskor lefutó szkriptjeiken
	  keresztül a automatikusan át tudnak
	  állítani a nekik megfelelõ
	  terminálra.  A szerzõ saját
	  rendszerében azonban inkább a
	  <literal>vt102</literal> termináltípust volt
	  érdemes megadni alapértelmezettként,
	  mivel ott a felhasználók csak ilyen
	  típusú terminálokat
	  használnak.</para>

	<para>Miután az <filename>/etc/ttys</filename>
	  állományban elvégeztük a
	  szükséges módosításokat, egy
	  <acronym>HUP</acronym> jelzéssel figyelmeztessük
	  az <command>init</command> programot az újbóli
	  beolvasására.  Ehhez a következõ
	  parancs ajánlott:</para>

	<screen>&prompt.root; <userinput>kill -HUP 1</userinput></screen>

	<para>Ha még csak állítjuk be
	  elõször a rendszerünket, akkor az
	  <command>init</command> figyelmeztetése elõtt
	  legyünk türelmesek, és várjuk meg,
	  amíg a modemek befejezik az
	  inicializálást és kapcsolódnak a
	  vonalakra.</para>

	<sect4>
	  <title>A rögzített sebességû
	    beállítás</title>

	  <para>A rögzített sebesség
	    beállításánál a
	    <filename>ttys</filename> állományban a
	    <command>getty</command> paramétereként egy
	    szintén rögzített sebességû
	    bejegyzést kell megadnunk.  Például az
	    olyan modemeknél, ahol a sebességet
	    19,2&nbsp;Kbps-re rögzítjük, a
	    <filename>ttys</filename> így fog
	    kinézni:</para>

	  <programlisting>ttyd0   "/usr/libexec/getty std.19200"   dialup on</programlisting>

	  <para>Amennyiben a modemünk nem ezen a sebességen
	    üzemelne, akkor az
	    <literal>std.sebesség</literal>
	    paramétert használjuk az
	    <literal>std.19200</literal> helyett.  Elõtte azonban
	    ne felejtsük el ellenõrizni, hogy a megadott
	    típus szerepel-e az
	    <filename>/etc/gettytab</filename>
	    állományban.</para>

	</sect4>

	<sect4>
	  <title>Az alkalmazkodó sebességû
	    beállítás</title>

	  <para>Az alkalmazkodó sebességû
	    beállításnál a
	    <filename>ttys</filename> állományban az
	    <filename>/etc/gettytab</filename>
	    állományból a megfelelõ
	    <quote>auto-baud</quote> (sic) kell megadnunk.
	    Például, ha modemünk
	    kezdõsebessége 19,2&nbsp;Kbps (és a
	    <filename>gettytab</filename> ehhez tartalmaz egy
	    <literal>V19200</literal> nevû bejegyzést),
	    akkor a <filename>ttys</filename> így fog
	    kinézni:</para>

	  <programlisting>ttyd0   "/usr/libexec/getty V19200"   dialup on</programlisting>

	</sect4>
      </sect3>

      <sect3>
	<title><filename>/etc/rc.d/serial</filename></title>

	<indexterm>
	  <primary>rc állományok</primary>
	  <secondary><filename>rc.serial</filename></secondary>
	</indexterm>

	<para>A gyorsabb, mint például a V.32, V.32bis
	  és V.34 modemeknél meg kell adnunk a hardveres
	  forgalomirányítás
	  (<literal>RTS/CTS</literal>) használatát is.  Az
	  <filename>/etc/rc.d/serial</filename>
	  állományban tudjuk megadni a &os; rendszermagban
	  a vonal használatához szükséges
	  vezérlési beállításokra
	  vonatkozó <command>stty</command> parancsokat.</para>

	<para>Például állítsuk be az 1-es
	  sorszámú (vagyis a
	  <filename>COM2</filename>) soros porton a
	  <varname>crtscts</varname> <literal>termios</literal>
	  beállítást a behíváshoz
	  és a híváshoz használt
	  eszközök inicializálásakor.  Ehhez a
	  következõ sorokat kell felvennünk az
	  <filename>/etc/rc.d/serial</filename>
	  állományba:</para>

	<programlisting># A soros portok kezdeti beállításai:
stty -f /dev/ttyd1.init crtscts
stty -f /dev/cuad1.init crtscts</programlisting>

      </sect3>
    </sect2>

    <sect2>
      <title>A modemek beállításai</title>

      <para>Ha olyan modemeink vannak, amelyek paramétereit egy
	statikus memóriában tárolták le,
	akkor ezek beállításához egy
	terminálprogramot kell használnunk (amilyen
	például &ms-dos; alatt a
	<application>Telix</application> vagy &os; alatt a
	<command>tip</command>).  A modemet a <command>getty</command>
	programnak megadott kezdeti sebességen csatlakoztassuk
	és az alábbi elvárások
	alapján állítsuk be a
	paramétereit:</para>

      <itemizedlist>
	<listitem>
	  <para>Kapcsolódáskor <acronym>CD</acronym>
	    jelzése.</para>
	</listitem>

	<listitem>
	  <para>Mûködéskor <acronym>DTR</acronym>
	    jelzése.  A DTR küldésekor bontsa a
	    vonalat és hozza alapállapotba a
	    modemet.</para>
	</listitem>

	<listitem>
	  <para><acronym>CTS</acronym> vezérlésû
	    kimenõ adatforgalom.</para>
	</listitem>

	<listitem>
	  <para>A <acronym>XON/XOFF</acronym>
	    forgalomvezérlés tiltása.</para>
	</listitem>

	<listitem>
	  <para><acronym>RTS</acronym> vezérlésû
	    bejövõ adatforgalom.</para>
	</listitem>

	<listitem>
	  <para>Csendes mód (ne adjon
	    értesítést az
	    eredményekrõl).</para>
	</listitem>

	<listitem>
	  <para>A parancsokat ne írja vissza.</para>
	</listitem>
      </itemizedlist>

      <para>A modemhez tartozó dokumentációban kell
	utánajárnunk, hogy milyen parancsok és/vagy
	DIP kapcsolók
	átállításával lehet
	mindezeket elérni.</para>

      <para>Például, ha a fenti paramétereket egy
	&usrobotics; &sportster; 14400-as külsõ modem
	esetében a következõ neki kiküldött
	paranccsal lehet beállítani:</para>

      <programlisting>ATZ
AT&amp;C1&amp;D2&amp;H1&amp;I0&amp;R2&amp;W</programlisting>

      <para>Ilyenkor még akár más egyéb
	paramétereket is beállíthatunk,
	például a V.42bis és/vagy az MNP5
	tömörítést.</para>

      <para>Az &usrobotics; &sportster; 14400 külsõ modemen
	ezenkívül még találunk
	néhány DIP kapcsolót is.  Az ilyen modemek
	esetében például ezeket a
	beállításokat tudjuk
	használni:</para>

      <itemizedlist>
	<listitem>
	  <para>1.  kapcsoló: FEL &mdash; normális
	    DTR</para>
	</listitem>

	<listitem>
	  <para>2.  kapcsoló: N/A (verbális/numerikus
	    eredményjelzõ kódok)</para>
	</listitem>

	<listitem>
	  <para>3.  kapcsoló: FEL &mdash; az
	    eredményjelzõ kódok
	    küldésének tiltása</para>
	</listitem>

	<listitem>
	  <para>4.  kapcsoló: LE &mdash; nem küldi vissza a
	    parancsokat</para>
	</listitem>

	<listitem>
	  <para>5.  kapcsoló: FEL &mdash; automatikus
	    válasz</para>
	</listitem>

	<listitem>
	  <para>6.  kapcsoló: FEL &mdash; normális Carrier
	    Detect</para>
	</listitem>

	<listitem>
	  <para>7.  kapcsoló: FEL &mdash; a
	    memóriában tárolt
	    alapértelmezések betöltése</para>
	</listitem>

	<listitem>
	  <para>8.  kapcsoló: N/A (intelligens/buta
	    mód)</para>
	</listitem>
      </itemizedlist>

      <para>A modemeknél az eredményjelzõ
	kódok kikapcsolása/letiltása ezért
	fontos, mert így el tudunk kerülni az olyan
	problémákat, hogy a <command>getty</command>
	tévesen egy <prompt>login:</prompt> promptot küld a
	parancs módban levõ modemnek, amikor az
	visszaküldi a parancsot és az eredmény
	kódját.  Ennek eredménye egy
	hosszúra nyúló, zavaros
	társalgás lesz a <command>getty</command>
	és a modem között.</para>

      <sect3>
	<title>A rögzített sebességû
	  beállítás</title>

	<para>A rögzített sebességû
	  konfiguráció használata esetén
	  úgy kell beállítanunk a modemet, hogy a
	  konkrét adatátviteli sebsségtõl
	  függetlenül is egy állandó
	  sebességû kapcsolat álljon fenn a
	  számítógép és a modem
	  között.  A &usrobotics; &sportster; 14400-as
	  külsõ modem esetében a most
	  következõ parancsokkal tudjuk rögzíteni
	  a kapcsolat sebességét:</para>

	<programlisting>ATZ
AT&amp;B1&amp;W</programlisting>

      </sect3>

      <sect3>
	<title>Az alkalmazkodó sebességû
	  beállítás</title>

	<para>Amikor változó sebességû
	  konfigurációval dolgozunk, akkor a modemet
	  úgy kell beállítani, hogy a
	  bejövõ hívásnak megfelelõ
	  adatátviteli sebességre váltson a soros
	  portján.  A &usrobotics; &sportster; 14400-as
	  külsõ modem esetében az alábbi
	  parancsokkal rögzítjük a modemnek
	  küldött hibamentesített parancsok
	  sebességét, miközben
	  engedélyezzük, hogy a soros port sebessége
	  változhasson a nem hibamentesített
	  kapcsolatoknál:</para>

	<programlisting>ATZ
AT&amp;B2&amp;W</programlisting>

      </sect3>

      <sect3>
	<title>A modem beállításainak
	  ellenõrzése</title>

	<para>A legtöbb nagysebességû modem
	  biztosít valamilyen lehetõséget arra, hogy
	  emberi formában is le tudjuk kérdezni a
	  belsõ mûködésének
	  paramétereit.  A &usrobotics; &sportster; 14400-as
	  külsõ modem esetében az
	  <command>ATI5</command> parancs a statikus
	  memóriában tárolt
	  beállításokat mutatja meg.  A modem
	  valós mûködési paramétereit
	  (amit ugyebár befolyásolnak a DIP
	  kapcsolók állásai is) viszont az
	  <command>ATZ</command> majd <command>ATI4</command> parancsok
	  küldésével tudjuk lekérni.</para>

	<para>Ha azonban másmilyen márkájú
	  modemünk lenne, akkor a modem
	  leírásában próbáljunk
	  tájékozódni arról, miként
	  tudjuk a modem beállításait
	  ellenõrizni.</para>

      </sect3>
    </sect2>

    <sect2>
      <title>Hibaelhárítás</title>

      <para>Ebben a szakaszban bemutatunk néhány
	lépést, amelyeken keresztül
	ellenõrizhetjük a rendszerünkhöz
	csatlakoztatott modemet.</para>

      <sect3>
	<title>A &os; rendszer ellenõrzése</title>

	<para>Csatlakoztassuk a modemet a &os; rendszerre,
	  indítsuk be a gépet, majd ezután
	  figyeljük a modemünk állapotát
	  jelzõ lámpákat, hogy közülük
	  a <acronym>DTR</acronym> világít-e, amikor a
	  <prompt>login:</prompt> felirat megjelenik a rendszerkonzolon.
	  Amennyiben erre a válasz igen, akkor az arra utal, hogy
	  a &os; a hozzá tartozó
	  kommunikációs porton elindította a
	  megfelelõ <command>getty</command> programot és a
	  modem várja a hívásokat.</para>

	<para>Amikor viszont a <acronym>DTR</acronym> lámpa nem
	  világít, a konzolon keresztül
	  jelentkezzünk be a &os; rendszerbe és adjuk ki egy
	  <command>ps ax</command> parancsot, amivel így
	  ellenõrizni tudjuk, hogy a porthoz tartozó
	  <command>getty</command> elindult.  A futó programok
	  között tehát valami ilyesmit kell majd
	  látnunk:</para>

	<screen>  114 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd0
  115 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd1</screen>

	<para>Ha viszont például ezt látjuk:</para>

	<screen>  114 d0  I      0:00.10 /usr/libexec/getty V19200 ttyd0</screen>

	<para>és modem még nem fogadott
	  hívást, akkor ez azt jelenit, hogy a
	  <command>getty</command> megnyitotta a
	  kommunikációs csatornát.  Ez utalhat
	  egyaránt egy hibás kábelre vagy a modem
	  helytelen beállítására, mivel a
	  <command>getty</command> egészen addig nem lesz
	  képes megnyitni az adott portot, amíg a modem
	  vissza nem küld neki egy <acronym>CD</acronym> (Carrier
	  Detect) jelet.</para>

	<para>Ha a listában az adott
	  <filename>ttydN</filename>
	  eszközhöz semmilyen <command>getty</command>
	  programot nem találunk, akkor újra
	  nézzük át az <filename>/etc/ttys</filename>
	  állományban szereplõ bejegyzéseket,
	  mert elõfordulhat, hogy azokban vétettünk
	  valamilyen hibát.  Emellett még a
	  <filename>/var/log/messages</filename> naplóban is
	  érdemes utánanézni, hátha az
	  <command>init</command> vagy a <command>getty</command>
	  küldött valamilyen hibáról
	  értesítést.  Ha még ezek
	  után sem találunk semmit, akkor megint
	  kezdjük el keresni hibákat, hiányzó
	  bejegyzéseket vagy eszközöket az
	  <filename>/etc/ttys</filename>,
	  <filename>/etc/gettytab</filename> és a megfelelõ
	  <filename>/dev/ttydN</filename>
	  állományokban.</para>

      </sect3>

      <sect3>
	<title>A betárcsázás
	  kipróbálása</title>

	<para>Próbáljunk meg bejutni a rendszerünkbe.
	  Ehhez a távoli rendszeren ne felejtsük el
	  beállítani a 8&nbsp;bites adatátvitelt
	  és az 1 stopbitet, illetve a paritást
	  kikapcsolni.  Ha erre közvetlenül nem kapunk egy
	  bejelentkezési képernyõt vagy csak
	  szemét jelenik meg, akkor kb.
	  másodpercenként egyszer nyomjuk le az
	  <keycap>Enter</keycap> billentyût.  Ha még
	  ezután sem látjuk a bejelentkezési
	  képernyõt felbukkani, akkor
	  próbáljunk kiküldeni egy
	  <command>BREAK</command> parancsot.  Ha a
	  híváshoz nagysebességû modemet
	  használunk, akkor próbáljuk meg a modem
	  sebességét rögzíteni és
	  úgy tárcsázni (ezt például
	  a &usrobotics; &sportster; modemnél az
	  <command>AT&amp;B1</command> paranccsal tudjuk
	  elérni):</para>

	<para>Ha viszont még ezek után sem kapjuk meg a
	  bejelentkezõ képernyõt, akkor a
	  <filename>/etc/gettytab</filename> állományban
	  megint nézzük át az összes
	  beállítást:</para>

	<itemizedlist>
	  <listitem>
	    <para>Az <filename>/etc/ttys</filename>
	      állományban megadott alaptulajdonság
	      neve egyezik az <filename>/etc/gettytab</filename>
	      állományban
	      találhatóval.</para>
	  </listitem>

	  <listitem>
	    <para>Mindegyik <literal>nx=</literal> bejegyzés
	      után egy másik <filename>gettytab</filename>
	      tulajdonság neve jön.</para>
	  </listitem>

	  <listitem>
	    <para>Mindegyik <literal>tc=</literal> bejegyzés
	      után egy másik <filename>gettytab</filename>
	      tulajdonság neve következik.</para>
	  </listitem>
	</itemizedlist>

	<para>Ha hívunk, de a &os; rendszerünkre kapcsolt
	  modem továbbra sem veszi fel, akkor a modem
	  beállításai között
	  ellenõrizzük, hogy a <acronym>DTR</acronym> jel
	  küldésekor a modem fogadja-e a
	  hívást.  Ha úgy tûnik, hogy a modem
	  minden ezzel kapcsolatos beállítása
	  stimmel, akkor nézzük meg, hogy a modem
	  lámpái közül a DTR
	  világít-e (már ha van ilyen).</para>

	<para>Ha mindent többször is
	  végignéztünk és még mindig
	  nem leljük a megoldást, akkor tartsunk egy kis
	  szünetet és térjünk vissza a
	  problémához késõbb.  Ha még
	  ezután sem tudjuk mûködésre
	  bírni, akkor küldjünk egy levelet a
	  &a.questions; címére, amelyben leírjuk a
	  modemünket és a vele kapcsolatos
	  problémát, és a lista tagjai majd
	  megpróbálnak nekünk segíteni.</para>

      </sect3>
    </sect2>

  </sect1>

  <sect1 xml:id="dialout">
    <title>A betárcsázós
      szolgáltatások használata</title>

    <indexterm><primary>betárcsázós
      szolgáltatások
      használata</primary></indexterm>

    <para>A következõkben arra vonatkozóan
      igyekszünk tanácsokat adni, amikor mi magunk akarunk
      modemmel csatlakozni valamilyen
      számítógéphez.  Ezek tehát
      olyan esetekben hasznosak, amikor egy távoli géppel
      akarunk terminálkapcsolatot
      létesíteni.</para>

    <para>A BBS-ek használatára is
      érvényes.</para>

    <para>Ez ilyen típusú kapcsolatok kifejezetten
      hasznosak tudnak lenni olyan esetekben, amikor az interneten el
      akarunk érni egy állományt, de gondjaink
      akadtak a PPP használatával.  Ha
      például egy állományt akarunk
      letölteni, de a PPP valamiért nem mûködik,
      akkor ezt a terminál alapú kapcsolaton
      keresztül is meg tudjuk tenni.  Ilyenkor egy zmodem
      segítségével tudjuk áttölteni a
      számítógépünkre.</para>

    <sect2 xml:id="hayes-unsupported">
      <title>A gyári Hayes-modem erre nem alkalmas, mihez tudunk
	vele kezdeni?</title>

      <para>A <command>tip</command> man oldala valójában
	már nem is teljesen aktuális, ugyanis tartalmaz
	egy beépített
	Hayes-tárcsázót.  Úgy tudjuk
	engedélyezni, ha az <filename>/etc/remote</filename>
	állományban megadjuk az
	<literal>at=hayes</literal>
	beállítást.</para>

      <para>A Hayes-eszközök meghajtója nem elég
	ügyes ahhoz, hogy felismerje az újabb modemek
	által felkínált fejlettebb
	lehetõségeket &mdash; például a
	<literal>BUSY</literal>, <literal>NO DIALTONE</literal> vagy a
	<literal>CONNECT 115200</literal> üzenetek csak
	megzavarják.  Ezért a <command>tip</command>
	használata során kapcsoljuk ki ezeket az
	üzeneteket (az <command>ATXO&amp;W</command>
	paranccsal).</para>

      <para>Emellett még érdemes tudni, hogy a
	<command>tip</command> a híváskor 60
	másodpercig vár.  A modemünkön
	ennél kisebb idõt kell beállítanunk,
	máskülönben a <command>tip</command> azt hiszi,
	hogy valamilyen kommunikációs probléma
	merült fel.  Ehhez próbálkozzunk az
	<command>ATS7=45&amp;W</command> paranccsal.</para>
    </sect2>

    <sect2 xml:id="direct-at">
      <title>Hogyan adjuk meg ezeket az AT parancsokat?</title>

      <indexterm><primary><filename>/etc/remote</filename></primary></indexterm>

      <para>Az <filename>/etc/remote</filename>
	állományban hozzunk létre egy
	<quote>direct</quote> bejegyzést.  Például,
	ha a modemünk az elsõ soros porton, vagyis a
	<filename>/dev/cuad0</filename> eszközön
	tanyázik, akkor a következõ sort kell
	beleírnunk:</para>

      <programlisting>cuad0:dv=/dev/cuad0:br#19200:pa=none</programlisting>

      <para>A <literal>br</literal> tulajdonságnál a modem
	által ismert legnagyobb adatátviteli
	sebességet adjuk meg.  Ezután gépeljük
	be a <command>tip cuad0</command> parancsot és már
	kapcsolódunk is a modemhez.</para>

      <para>Vagy <systemitem class="username">root</systemitem>
	felhasználóként a <command>cu</command>
	parancsot is használhatjuk:</para>

      <screen>&prompt.root; <userinput>cu -lvonal -ssebesség</userinput></screen>

      <para>Itt a <replaceable>vonal</replaceable> a soros port
	(például <filename>/dev/cuad0</filename>)
	és a <replaceable>sebesség</replaceable> annak
	sebessége (például
	<literal>57600</literal>) lesz.  Miután befejeztük
	az AT parancsok kiadását, az <command>~.</command>
	begépelésével tudunk kilépni.</para>

    </sect2>

    <sect2 xml:id="gt-failure">
      <title>A pn tulajdonságnál a <literal>@</literal>
	jel nem használható!</title>

      <para>A pn (<quote>phone number</quote>) tulajdonság
	értékében szereplõ
	<literal>@</literal> jel segítségével az
	<filename>/etc/phones</filename> állományban
	tudunk hivatkozni egy telefonszámra.  A
	<literal>@</literal> a tulajdonságokat
	tároló állományok azonban,
	így például az
	<filename>/etc/remote</filename> állomány
	esetén is megkülönböztetett
	jelentéssel bírnak.  Ezért itt csak egy
	visszaper jellel tudjuk beírni:</para>

      <programlisting>pn=\@</programlisting>

    </sect2>

    <sect2 xml:id="dial-command-line">
      <title>Hogyan hívjunk fel egy számot
	parancssorból?</title>

      <para>Tegyünk egy <quote>általános</quote>
	bejegyzést az <filename>/etc/remote</filename>
	állományunkba.  Például egy
	ilyet:</para>

      <programlisting>tip115200|Dial any phone number at 115200 bps:\
        :dv=/dev/cuad0:br#115200:at=hayes:pa=none:du:
tip57600|Dial any phone number at 57600 bps:\
        :dv=/dev/cuad0:br#57600:at=hayes:pa=none:du:</programlisting>

      <para>Ezután már ilyet is tudni fogunk:</para>

      <screen>&prompt.root; <userinput>tip -115200 5551234</userinput></screen>

      <para>Ha viszont a <command>tip</command> helyett inkább a
	<command>cu</command> programot használnánk
	szívesen, akkor ehhez készítsünk egy
	általános bejegyzést:</para>

      <programlisting>cu115200|Use cu to dial any number at 115200bps:\
        :dv=/dev/cuad1:br#57600:at=hayes:pa=none:du:</programlisting>

      <para>Majd gépeljük be ezt:</para>

      <screen>&prompt.root; <userinput>cu 5551234 -s 115200</userinput></screen>

    </sect2>

    <sect2 xml:id="set-bps">
      <title>Ehhez minden adandó alkalommal meg kell adnom a
	sebességet is?</title>

      <para>Hozzunk létre egy <literal>tip1200</literal> vagy
	<literal>cu1200</literal> nevû bejegyzést, de a
	<literal>br</literal> tulajdonságnál adjuk meg a
	használni kívánt sebességet.  Mivel
	a <command>tip</command> szerint az 1200&nbsp;bps egy
	megfelelõ alapértelmezés, ezért
	alapból a <literal>tip1200</literal> bejegyzést
	fogja keresni.  Ez természetesen nem jelenti azt, hogy
	ilyen sebsséggel is akarunk dolgozni.</para>

    </sect2>

    <sect2 xml:id="terminal-server">
      <title>A terminálszerveren keresztül több
	más gépet is elérek</title>

      <para>Ahelyett, hogy minden alkalommal megvárnánk a
	kapcsolódás befejezést és
	begépelnénk a <command>CONNECT
	gép</command> parancsot,
	használjuk a <literal>cm</literal>
	tulajdonságát.  Például
	nézzük meg ilyen bejegyzést az
	<filename>/etc/remote</filename>
	állományban:</para>

      <programlisting>pain|pain.deep13.com|Forrester's machine:\
        :cm=CONNECT pain\n:tc=deep13:
muffin|muffin.deep13.com|Frank's machine:\
        :cm=CONNECT muffin\n:tc=deep13:
deep13:Gizmonics Institute terminal server:\
        :dv=/dev/cuad2:br#38400:at=hayes:du:pa=none:pn=5551234:</programlisting>

      <para>Ennek hatására elég csak annyit
	megadnunk, hogy <command>tip pain</command> vagy <command>tip
	muffin</command>, és már kapcsolódunk is a
	<systemitem>pain</systemitem> vagy <systemitem>muffin</systemitem>
	gépekhez.  A <command>tip deep13</command> paranccsal
	pedig egyenesen a terminálszerverhez jutunk el.</para>

    </sect2>

    <sect2 xml:id="tip-multiline">
      <title>Több vonalon is lehet egy géphez
	csatlakozni?</title>

      <para>Ez gyakran okoz gondot olyan esetekben, amikor egy
	egyetemnek több betárcsázó vonala van,
	és azokon keresztül többezer hallgató
	próbál meg dolgozni.</para>

      <para>Vegyük fel az egyetemet az
	<filename>/etc/remote</filename> állományba
	és használjuk a <literal>pn</literal>
	tulajdonság megadásánál a
	<literal>@</literal> jelet:</para>

      <programlisting>nagy-egyetem:\
        :pn=\@:tc=dialout
dialout:\
        :dv=/dev/cuad3:br#9600:at=courier:du:pa=none:</programlisting>

      <para>Ezután adjuk hozzá az
	<filename>/etc/phones</filename> állományhoz az
	egyetem telefonszámait:</para>

      <programlisting>nagy-egyetem 5551111
nagy-egyetem 5551112
nagy-egyetem 5551113
nagy-egyetem 5551114</programlisting>

      <para>A <command>tip</command> mindegyik telefonszámot az
	adott sorrendben próbálja tárcsázni
	és végén feladja a
	próbálkozást.  Ha folyamatosan akarjuk
	ezeket a számokat hívni, akkor
	<command>tip</command> parancsot tegyük egy
	ciklusba.</para>

    </sect2>

    <sect2 xml:id="multi-controlp">
      <title>Miért kell kétszer lenyomni a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap>
	  <keycap>P</keycap>
	</keycombo>
	gombokat, hogy egyszer elküldje a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap>
	  <keycap>P</keycap>
	</keycombo>
	kombinációt?</title>

      <para>A <keycombo action="simul"><keycap>Ctrl</keycap><keycap>P</keycap></keycombo>
	billentyûkombináció
	alapértelmezés szerint a
	<quote>kikényszerítést</quote> jelenti,
	amivel a <command>tip</command> programnak tudunk szólni,
	hogy a következõ adat szó szerint
	értendõ.  A <command>~s</command>
	szekvenciával bármelyik másik karakternek
	át tudjuk adni ezt a szerepet, ami egy
	változó beállítását
	jelenti (<quote>set a variable</quote>).</para>

      <para>Gépeljük be, hogy
      <command>~sforce=egyetlen-karakter</command>
	és zárjuk le egy újsorral.  Az
	<replaceable>egyetlen-karakter</replaceable> helyére
	tetszõleges, egykarakteres szimbólumot megadhatunk.
	Ha itt nem adunk meg semmit, akkor a
	kikényszerítõ karakter a
	<literal>nul</literal> lesz, amit a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap><keycap>2</keycap>
	</keycombo>
	vagy a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap><keycap>Szóköz</keycap>
	</keycombo>
	lenyomásával tudunk elõhozni.  Az
	<replaceable>egyetlen-karakter</replaceable> szerepére
	például tökéletes a
	<keycombo action="simul">
	  <keycap>Shift</keycap>
	  <keycap>Ctrl</keycap>
	  <keycap>6</keycap>
	</keycombo>, amit csak nagyon kevés
	terminálszerver alkalmaz.</para>

      <para>A kikényszerítést végzõ
	karaktert az <filename>&#36;HOME/.tiprc</filename>
	állományban tetszõleges karakterre át
	tudjuk állítani:</para>

      <programlisting>force=<replaceable>egyetlen-karakter</replaceable></programlisting>

    </sect2>

    <sect2 xml:id="uppercase">
      <title>Miért lett hirtelen minden begépelt betû
	nagybetûs??</title>

      <para>Valószínûleg sikerült lenyomnunk a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap>
	  <keycap>A</keycap>
	</keycombo> gombkombinációt, ami a
	<command>tip</command> <quote>betûmód
	váltás</quote> funkciójának felel
	meg.  Ezt olyanok számára dolgozták ki,
	akiknél nem mûködik a <keycap>Caps
	Lock</keycap> billentyû.  Az elõbb bemutatott
	<command>~s</command> használatával
	állítsuk át a <literal>raisechar</literal>
	változót valami másra.
	Tulajdonképpen akár ugyanarra is
	állíthatjuk, mint a
	kikényszerítõ karaktert, ha nem áll
	szándékunkban használni.</para>

      <para>Ebben a példában egy olyan
	<filename>.tiprc</filename> állomány szerepel, amely
	tökéletesen megfelel azon
	<application>Emacs</application> felhasználók
	számára, akik sokat használják a
	<keycombo action="simul">
	  <keycap>Ctrl</keycap><keycap>2</keycap>
	</keycombo>
	és
	<keycombo action="simul">
	  <keycap>Ctrl</keycap><keycap>A</keycap>
	</keycombo>
	kombinációkat:</para>

      <programlisting>force=^^
raisechar=^^</programlisting>

      <para>A <literal>^^</literal> a
	<keycombo action="simul">
	  <keycap>Shift</keycap><keycap>Ctrl</keycap><keycap>6</keycap>
	</keycombo>
	billentyûkombinációt jelenti.</para>

    </sect2>

    <sect2 xml:id="tip-filetransfer">
      <title>Hogyan mozgassunk állományokat a
	<command>tip</command> használatával?</title>

      <para>Amikor más &unix; rendszerekkel vesszük fel a
	kapcsolatot, akkor állományokat a
	<command>~p</command> (mint put, vagyis adni) és
	<command>~t</command> (mint take, vagyis venni)
	használatával tudunk mozgatni.  Ezek a parancsok a
	távoli rendszeren a <command>cat</command> és az
	<command>echo</command> felhasználásával
	fogadnak és küldenek állományokat.
	Alakjuk a következõ:</para>

      <cmdsynopsis>
	<command>~p</command>
	<arg choice="plain">helyi-állomány</arg>
	<arg choice="opt">távoli-állomány</arg>
      </cmdsynopsis>

      <cmdsynopsis>
	<command>~t</command>
	<arg choice="plain">távoli-állomány</arg>
	<arg choice="opt">helyi-állomány</arg>
      </cmdsynopsis>

      <para>Ilyenkor nincs hibaellenõrzés, ezért
	inkább egy másik protokollt, például
	zmodemet érdemes használnunk.</para>

    </sect2>

    <sect2 xml:id="zmodem-tip">
      <title>Hogyan lehet zmodemet használni a
	<command>tip</command> programban?</title>

      <para>Állományokat úgy tudunk fogadni, ha
	elõtte a kapcsolat távolabbi végén
	elindítjuk a küldést végzõ
	programot.  Ezután a <command>~C rz</command> parancs
	kiadásával kezdhetjük meg helyben a
	fogadását.</para>

      <para>Állományokat úgy tudunk küldeni,
	ha elõtte a kapcsolat másik végén
	elindítjuk a fogadó programot.  Ezután a
	<command>~C sz
	állományok</command>
	parancs kiadásával tudjuk megkezdeni a
	küldést.</para>

    </sect2>
  </sect1>

  <sect1 xml:id="serialconsole-setup">
    <info><title>A soros vonali konzol beállítása</title>
      <authorgroup>
	<author><personname><firstname>Kazutaka</firstname><surname>YOKOTA</surname></personname><contrib>Készítette: </contrib></author>
      </authorgroup>
      <authorgroup>
	<author><personname><firstname>Bill</firstname><surname>Paul</surname></personname><contrib>Az alapján szolgáló
	    írást készítette: </contrib></author>
      </authorgroup>
    </info>

    

    <indexterm><primary>soros konzol</primary></indexterm>

    <sect2 xml:id="serialconsole-intro">
      <title>Bevezetés</title>

      <para>A &os; képes úgy is elindulni, ha
	konzolként mindössze egy buta terminált
	kapcsolunk rá soros porton keresztül.  Az ilyen
	típusú konfigurációs alapvetõen
	két típus számára bizonyul
	hasznosnak: azon rendszergazdák számára,
	akik billentyûzettel és monitorral nem
	rendelkezõ gépekre akarnak &os;-t telepíteni,
	és olyan fejlesztõk számára, akik a
	rendszermag vagy különbözõ
	eszközmeghajtók mûködését
	akarják nyomon követni.</para>

      <para>Ahogy arról már a <xref linkend="boot"/>ben is
	szó esett, a &os; három indítási
	fokozattal rendelkezik.  Az elsõ két fokozat a
	rendszerindító blokk kódjában foglal
	helyet, amely pedig a lemezen található &os; slice
	elején.  A rendszer indulásakor ez a blokk
	betöltõdik és lefuttatja a harmadik fokozatot
	képviselõ rendszertöltõt (a
	<filename>/boot/loader</filename>
	állományt).</para>

      <para>Ha soros vonali konzol
	beállításához tehát be kell
	állítanunk a rendszerindító blokkot,
	a rendszertöltõt és a rendszermagot.</para>

    </sect2>

    <sect2 xml:id="serialconsole-howto-fast">
      <title>A soros konzol beállítása,
	rövidített változat</title>

      <para>Ebben a szakaszban azt feltételezzük, hogy az
	alap beállításokkal dolgozunk és
	csupán egy gyors áttekintésre van
	szükségünk a soros vonali
	konzolról.</para>

      <procedure>
	<step>
	  <para>Csatlakoztassunk egy soros kábelt a
	    <filename>COM1</filename> portra és a
	    terminálra.</para>
	</step>

	<step>
	  <para>Rendszeradminisztrátorként a
	    következõ parancs kell kiadnunk ahhoz, hogy a
	    soros konzolon láthassuk az összes
	    rendszerindításhoz tartozó
	    üzenetet:</para>

	  <screen>&prompt.root; echo 'console="comconsole"' &gt;&gt; /boot/loader.conf</screen>
	</step>

	<step>
	  <para>Nyissuk meg az <filename>/etc/ttys</filename>
	    állományt, és a
	    <filename>ttyd0</filename> eszközhöz
	    tartozó sorban írjuk át az
	    <literal>off</literal> paramétert az
	    <literal>on</literal> értékre és a
	    <literal>dialup</literal> paramétert a
	    <literal>vt100</literal> értékre.  Ha nem
	    ezeket állítjuk be, akkor a soros konzol
	    keresztül jelszó megadása
	    nélkül is be tudunk jelentkezni, ami viszont egy
	    biztonsági rés veszélyével
	    fenyeget.</para>
	</step>

	<step>
	  <para>A változtatások
	    érvényesítéséhez
	    indítsuk újra a rendszerünket.</para>
	</step>
      </procedure>

      <para>Ha ettõl eltérõ
	beállításokra lenne
	szükségünk, akkor a folyamat egyes
	lépéseibe a <xref linkend="serialconsole-howto"/>ban kaphatunk mélyebb
	betekintést.</para>

    </sect2>

    <sect2 xml:id="serialconsole-howto">
      <title>A soros vonali konzol
	beállítása</title>

      <procedure>
	<step>
	  <para>Készítsük elõ a soros
	    kábelt.</para>

	  <indexterm><primary>null-modem
	    kábel</primary></indexterm>

	  <para>Vagy a null-modem kábelre vagy pedig egy
	    szabványos soros kábelre és egy
	    null-modem átalakítóra lesz
	    szükségünk.  A soros kábelekkel
	    kapcsolatosan a <xref linkend="serial-cables-ports"/>t
	    érdemes elolvasni.</para>
	</step>

	<step>
	  <para>Húzzuk ki a billentyûzetet.</para>

	  <para>A legtöbb személyi
	    számítógép az
	    indítása (vagyis a Power-On Self-Test, POST)
	    során hibát jelez, ha nem
	    érzékel billentyûzetet.  Egyes
	    gépek hangosan panaszolják a billentyûzet
	    hiányát, és nem is hajlandóak
	    egészen addig elindulni, amíg nem
	    csatlakoztatunk egyet.</para>

	  <para>Ha a számítógépünk
	    hibát küld, de ennek ellenére
	    mégis elindul, akkor semmit nem kell
	    csinálnunk.  (Némelyik Phonix BIOS-os
	    gépen ilyenkor megjelenik a <errorname>Keyboard
	    failed</errorname> hibaüzenet, de ettõl még
	    rendesen elindul a gép.)</para>

	  <para>Amennyiben a
	    számítógépünk nem
	    hajlandó billentyûzet nélkül
	    elindulni, állítsuk be a BIOS-ban a
	    <quote>hiba</quote> figyelmen kívül
	    hagyását (már ha ez lehetséges).
	    Az alaplap leírásában
	    találhatjuk meg ennek pontos részleit.</para>

	  <tip>
	    <para>A BIOS paraméterei között a
	      billentyûzetet állítsuk <quote>Not
	      installed</quote> állapotúra.  Ilyenkor
	      még továbbra is használható a
	      billentyûzet, ezzel mindössze csak a BIOS
	      számára tiltjuk le az
	      indításkori ellenõrzést,
	      ezért nem fog panaszkodni a hiánya miatt.
	      Tehát a billentyûzetet még a <quote>Not
	      installed</quote> beállítása
	      esetén is nyugodtan csatlakoztatjuk, mert
	      mûködni fog.</para>
	  </tip>

	  <note>
	    <para>Ha a rendszerünkön &ps2;-es egér is
	      található, akkor jó eséllyel a
	      billentyûzettel együtt az egeret is ki tudjuk
	      húzni.  Mivel a &ps2;-es egér osztozik a
	      billentyûzettel bizonyos hardvereken, ezért ha
	      nem húzzuk ki az egeret is, akkor az alaplap
	      még továbbra is képes azt gondolni,
	      hogy a billentyûzet ott van.  Például
	      az AMI BIOS-os Gateway 2000-as 90&nbsp;MHz-es Pentium
	      rendszer pontosan így mûködik.
	      Általában véve azonban ez nem szokott
	      gondot okozni, mivel az egér billentyûzet
	      nélkül úgy sem ér
	      túlságosan sokat.</para>
	  </note>
	</step>

	<step>
	  <para>Csatlakoztassunk egy buta terminált a
	    <filename>COM1</filename>
	    (<filename>sio0</filename>) portra.</para>

	  <para>Ha nem rendelkezünk buta terminállal, akkor
	    erre célra ugyanúgy alkalmas egy régi
	    XT-s PC valamilyen modemprogrammal vagy egy soros porton
	    csatlakozó másik &unix;-os gép.  Ha
	    nincs <filename>COM1</filename>
	    (<filename>sio0</filename>) portunk, akkor
	    szerezzünk egyet.  Jelen pillanatban a
	    rendszerindító blokk
	    újrafordítása nélkül a
	    <filename>COM1</filename> porton kívül nem
	    tudunk másikat választani.  Ha a
	    <filename>COM1</filename> portra már raktunk
	    valamilyen másik eszközt, akkor azt ideiglenesen
	    húzzuk le, majd a &os; telepítése
	    és elindítása után tegyünk
	    fel egy másik rendszerindító blokkot.
	    (Egyébként feltételezzük, hogy a
	    <filename>COM1</filename> elérhetõ egy
	    állomány/számító/terminálszerveren
	    &mdash; ha valóban valamilyen másik
	    célra szükségünk lenne a
	    <filename>COM1</filename> portra (és
	    semmiképpen sem tudjuk átrakni a
	    <filename>COM2</filename>
	    (<filename>sio1</filename>) portra), akkor
	    valószínûleg nem is ezzel kellene
	    elsõként foglalkoznunk.)</para>
	</step>

	<step>
	  <para>Gondoskodjunk róla, hogy a rendszermag
	    beállításait tartalmazó
	    állományban a <filename>COM1</filename>
	    (<filename>sio0</filename>) eszközhöz megadtuk
	    a megfelelõ paramétereket.</para>

	  <para>Ezek az alábbiak:</para>

	  <variablelist>
	    <varlistentry>
	      <term><literal>0x10</literal></term>

	      <listitem>
		<para>A konzolos mûködési mód
		  engedélyezése az adott egységhez.
		  Ha megadjuk ezt a paramétert, akkor a
		  többit a rendszer figyelmen kívül
		  hagyja.  Pillanatnyilag legfeljebb egy egység
		  birtokolhatja ezt a beállítást.
		  Ha több ilyet adtunk volna meg, akkor (a
		  felírás sorrendje szerint) az elsõ
		  kap ilyen szerepet.  Ez a
		  beállítás önmagában
		  még nem teszi a soros portot konzollá.
		  Ehhez még szükségünk van a
		  következõ beállításra,
		  vagy a <option>-h</option> megadására
		  is.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term><literal>0x20</literal></term>

	      <listitem>
		<para>Az egység konzollá
		  nyilvánítása (hacsak nincs egy
		  tõle nagyobb prioritású konzol),
		  függetlenül a lentebb ismertetendõ
		  <option>-h</option> opciótól.  A
		  <literal>0x20</literal> értéket a
		  <option>0x10</option> értékkel
		  együtt kell megadni.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term><literal>0x40</literal></term>

	      <listitem>
		<para>(A <literal>0x10</literal> értékkel
		  együtt) az egységet kivonja a
		  normális elérés alól.  Ezt
		  a beállítást ne
		  használjuk, ha soros vonali konzolt akarunk
		  üzemeltetni az adott porton.  Ezzel az
		  egységet csak a rendszermag távoli
		  nyomkövetéséhez tudjuk
		  használni.  A távoli
		  nyomkövetésrõl a <link xlink:href="&url.books.developers-handbook.en;/index.html">
		  fejlesztõk
		  kézikönyvében</link> olvastunk
		  bõvebben.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Példa:</para>

	  <programlisting>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</programlisting>

	  <para>A további részletekrõl a &man.sio.4;
	    man oldal tud felvilágosítást
	    nyújtani.</para>

	  <para>Ha nem állítottuk be a megfelelõ
	    paramétereket, akkor (egy másik konzolon)
	    futtassuk a UserConfig programot vagy fordítsuk
	    újra a rendszermagot.</para>
	</step>

	<step>
	  <para>Hozzunk létre egy
	    <filename>boot.config</filename> állományt a
	    rendszer indításához használt
	    meghajtó <literal>a</literal>
	    partíciójának
	    gyökerében.</para>

	  <para>Ez az állomány mondja meg a
	    rendszerindító blokkban
	    található kódnak, hogy miként
	    akarjuk indítani a rendszerünket.  A soros
	    vonali konzol életrekeltéséhez a most
	    következõ opciók közül kell
	    megadnunk egyet vagy többet &mdash; amennyiben
	    többet akarunk megadni, akkor mindegyiket egyetlen
	    sorban szerepeltessük:</para>

	  <variablelist>
	    <varlistentry>
	      <term><option>-h</option></term>

	      <listitem>
		<para>A belsõ és a soros vonali konzolok
		  közti átkapcsolás.  Ezzel tudunk a
		  konzolos eszközök között
		  váltani.  Például, ha egy
		  belsõ (video) konzolról indítjuk a
		  rendszert, akkor a rendszertöltõnek
		  és a rendszermagnak átadott
		  <option>-h</option> paraméterrel arra tudjuk
		  ezeket utasítani, hogy konzolként a
		  soros portot használják.  Vagy ha soros
		  porton keresztül indítjuk a rendszert,
		  akkor <option>-h</option> megadásával
		  megkérhetjük a rendszertöltõt
		  és a rendszermagot, hogy ezután
		  már a videokártyát
		  használja konzolként.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term><option>-D</option></term>

	      <listitem>
		<para>Az egy- és kétkonzolos
		  beállítások közti
		  váltás.  Az egykonzolos
		  konfigurációban a konzol lehet
		  belsõ (video) vagy soros vonali, attól
		  függõen, hogy miként
		  használtuk a fenti <option>-h</option>
		  opciót.  A kétkonzolos
		  konfigurációban azonban a
		  videokártyán és a soros vonalon
		  keresztül is egyszerre megjelenik a konzol,
		  függetlenül a <option>-h</option>
		  hatásától.  Ilyenkor viszont
		  vegyük figyelembe, hogy ez a kétkonzolos
		  konfiguráció csak a
		  rendszerindító blokk futása alatt
		  él.  Amint a rendszerindító
		  megkapja a vezérlést, a
		  <option>-h</option> által megadott konzol
		  válik az egyedülivé.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term><option>-P</option></term>

	      <listitem>
		<para>A rendszerindító blokk
		  megpróbálja megkeresni a
		  billentyûzetet.  Ha nem találja, akkor
		  magától beállítja a
		  <option>-D</option> és <option>-h</option>
		  opciókat.</para>

		<note>
		  <para>Tárbeli korlátozások miatt
		    a rendszerindító blokk jelenlegi
		    változata a <option>-P</option>
		    paraméterrel csak a kiterjesztett
		    billentyûzeteket képes kezelni.  A 101
		    gombnál kevesebbel (tehát F11
		    és F12 gombokkal nem) rendelkezõ
		    billentyûzeteket ezért nem
		    feltétlenül fogja észlelni.
		    Ugyanezen korlátozás miatt egyes
		    laptopokon sem minden esetben sikerül
		    érzékelni a billentyûzetet.  Ha
		    ez a rendszerünkön
		    problémához vezetne, akkor
		    egyszerûbb lesz elhagyni a <option>-P</option>
		    használatát.  Sajnos, jelenleg
		    semmilyen megoldás nincs erre.</para>
		</note>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Vagy a <option>-P</option> opcióval
	    állítassuk be automatikusan a konzolt, vagy
	    pedig a <option>-h</option> opcióval
	    engedélyezzük a soros vonali konzolt.</para>

	  <para>Természetesen itt a &man.boot.8; man oldalon
	    szereplõ összes többi paramétert is
	    megadhatjuk.</para>

	  <para>A <option>-P</option> kivételével az
	    összes opció a rendszertöltõnek
	    (<filename>/boot/loader</filename>) kerül
	    átadásra.  A rendszertöltõ
	    egyedül a <option>-h</option>
	    állapotából dönti el, hogy mely
	    belsõ videoeszközön vagy soros porton legyen
	    a konzol.  Ez azt jelenti, hogy a
	    <filename>/boot.config</filename> állományban
	    ha megadjuk a <option>-D</option> opciót, de mellette
	    nem szerepel a <option>-h</option>, akkor a soros vonali
	    konzolt csak a rendszerindító blokk
	    futása alatt tudjuk elérni &mdash; a
	    rendszertöltõ ugyanis alapból a
	    videokártyát használja
	    konzolként.</para>
	</step>

	<step>
	  <para>Kapcsoljuk be a
	    számítógépünket.</para>

	  <para>Amikor elindítjuk a &os;-s gépünket,
	    a rendszerindító blokk kiírja a
	    <filename>/boot.config</filename> tartalmát a
	    konzolra.  Például így:</para>

	  <screen>/boot.config: -P
Keyboard: no</screen>

	  <para>A második sor csak olyankor jelenik meg, ha a
	    <filename>/boot.config</filename> állományban
	    a <option>-P</option> beállítás is
	    szerepel, és a billentyûzet
	    jelenlétét (yes) vagy hiányát
	    (no) jelzi.  A <filename>/boot.config</filename>
	    tartalmától függõen ezek az
	    üzenetek vagy a soros vonali vagy a belsõ konzolon
	    jelennek meg, esetleg mind a kettõn.</para>

	  <informaltable frame="none" pgwide="1">
	    <tgroup cols="2">
	      <thead>
		<row>
		  <entry align="left">Beállítás</entry>
		  <entry align="left">Ahol megjelenik</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry>nincs</entry>
		  <entry>belsõ konzol</entry>
		</row>

		<row>
		  <entry><option>-h</option></entry>
		  <entry>soros vonali konzol</entry>
		</row>

		<row>
		  <entry><option>-D</option></entry>
		  <entry>soros vonali és belsõ
		    konzol</entry>
		</row>

		<row>
		  <entry><option>-Dh</option></entry>
		  <entry>soros vonali és belsõ
		    konzol</entry>
		</row>

		<row>
		  <entry><option>-P</option>, van
		    billentyûzet</entry>
		  <entry>belsõ konzol</entry>
		</row>

		<row>
		  <entry><option>-P</option>, nincs
		    billentyûzet</entry>
		  <entry>soros vonali konzol</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </informaltable>

	  <para>Az iménti üzenetek felbukkanása
	    után a további konzolos üzenetek
	    küldésében egy rövid szünet
	    következik, amíg a rendszerindító
	    blokk a rendszertöltõ
	    betöltésével folytatja a rendszer
	    indítását.  Normális
	    körülmények között ezt a
	    folyamatot nem kell megszakítanunk, de esetleg
	    olyankor mégis érdemes lehet, ha le akarjuk
	    ellenõrizni a
	    beállításainkat.</para>

	  <para>A rendszerindítási folyamat
	    félbeszakításához az
	    <keycap>Enter</keycap> billentyûn kívül
	    nyomjuk le valamelyik másikat.  Ekkor a
	    rendszerindító blokk megáll és
	    várja a további parancsokat.  Ekkor valami
	    ilyesmit láthatunk:</para>

	  <screen>&gt;&gt; FreeBSD/i386 BOOT
Default: 0:ad(0,a)/boot/loader
boot:</screen>

	  <para>Nézzük meg, hogy
	    <filename>/boot.config</filename>
	    beállításainak megfelelõen a fenti
	    üzenet a soros vonali konzolon vagy a belsõ
	    konzolon, illetve mind a kettõn megjelenik-e.  Ha az
	    üzenet a megfelelõ konzolon megjelenik, akkor az
	    <keycap>Enter</keycap> lenyomásával
	    folytathatjuk a rendszer
	    indítását.</para>

	  <para>Ha nekünk a soros vonali konzolra lenne
	    szükségünk, de semmi nem jelenik meg a
	    soros terminálon, akkor valamit
	    valószínûleg nem jól
	    állítottunk be.  A
	    rendszerindító blokktól kapott
	    parancssorban a <option>-h</option>
	    begépelésével és az
	    <keycap>Enter</keycap> vagy <keycap>Return</keycap>
	    lenyomásával (ha lehetséges)
	    jelezzük neki (és így a
	    rendszertöltõnek és a rendszermagnak is) a
	    soros vonali konzol kiválasztását.
	    Miután befejezõdött a rendszer
	    indítása, menjünk vissza és
	    ellenõrizzük a megfelelõ
	    paramétereket.</para>
	</step>
      </procedure>

      <para>Ahogy sikerült elindítani a
	rendszertöltõt és a
	rendszerindítás harmadik fokozatába
	léptünk, a rendszertöltõ megfelelõ
	környezeti változóin keresztül
	még mindig van lehetõségünk
	váltani a soros vonali és a belsõ konzol
	között, lásd <xref linkend="serialconsole-loader"/>.</para>

    </sect2>

    <sect2 xml:id="serialconsole-summary">
      <title>Összefoglalás</title>

      <para>Itt most röviden összefoglaljuk az eddig
	tárgyalt különbözõ
	beállításokat és ténylegesen
	kiválasztott konzolt.</para>

      <sect3>
	<title>1.  eset: a <filename>sio0</filename>
	  eszköznél a 0x10 beállítást
	  adjuk meg</title>

	<programlisting>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</programlisting>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="4">
	    <thead>
	      <row>
		<entry align="left">A /boot.config
		  beállításai</entry>
		<entry align="left">Konzol a
		  rendszerindító blokk alatt</entry>
		<entry align="left">Konzol a rendszertöltõ
		  alatt</entry>
		<entry align="left">Konzol a rendszermagban</entry>
	      </row>
	    </thead>

	    <tbody>
	      <row>
		<entry>nincsenek</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
	      </row>

	      <row>
		<entry><option>-h</option></entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-D</option></entry>
		<entry>soros vonali és belsõ</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
	      </row>

	      <row>
		<entry><option>-Dh</option></entry>
		<entry>soros vonali és belsõ</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-P</option>, van
		  billentyûzet</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
	      </row>

	      <row>
		<entry><option>-P</option>, nincs
		  billentyûzet</entry>
		<entry>soros vonali és belsõ</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>
      </sect3>

      <sect3>
	<title>2.  eset: a <filename>sio0</filename>
	  eszköznél 0x30
	  beállítása</title>

	<programlisting>device sio0 at isa? port IO_COM1 flags 0x30 irq 4</programlisting>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="4">
	    <thead>
	      <row>
		<entry align="left">A /boot.config
		  beállításai</entry>
		<entry align="left">Konzol a
		  rendszerindító blokk alatt</entry>
		<entry align="left">Konzol a rendszertöltõ
		  alatt</entry>
		<entry align="left">Konzol a rendszermagban</entry>
	      </row>
	    </thead>

	    <tbody>
	      <row>
		<entry>nincsenek</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-h</option></entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-D</option></entry>
		<entry>soros vonali és belsõ</entry>
		<entry>belsõ</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-Dh</option></entry>
		<entry>soros vonali és belsõ</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-P</option>, van
		  billentyûzet</entry>
		<entry>belsõ</entry>
		<entry>belsõ</entry>
		<entry>soros vonali</entry>
	      </row>

	      <row>
		<entry><option>-P</option>, nincs
		  billentyûzet</entry>
		<entry>soros vonali és belsõ</entry>
		<entry>soros vonali</entry>
		<entry>soros vonali</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

      </sect3>
    </sect2>

    <sect2 xml:id="serialconsole-tips">
      <title>Tanácsok a soros vonali konzol
	használatához</title>

      <sect3>
	<title>Nagyobb soros vonali sebesség
	  beállítása</title>

	<para>A soros port alapértelmezései a
	  következõk: 9600&nbsp;baud, 8&nbsp;bites
	  átvitel, paritás nincs és 1 stopbit.  Ha
	  a konzol alapsebességét meg akarjuk
	  változtatni, akkor ahhoz a következõket kell
	  tennünk:</para>

	<itemizedlist>
	  <listitem>
	    <para>Fordítsuk újra a
	      rendszerindító blokkokat úgy, hogy a
	      <varname>BOOT_COMCONSOLE_SPEED</varname>
	      változóban a konzolnak egy másik
	      sebességet adunk meg.  Az új
	      rendszerindító blokkok
	      fordításáról és
	      telepítésérõl a <xref linkend="serialconsole-com2"/>ban kapunk részletes
	      leírást.</para>

	    <para>Ha a soros vonali konzolt nem a <option>-h</option>
	      opcióval állítottuk be, vagy ha a
	      rendszermag a rendszerindító
	      blokkoktól eltérõ módon
	      éri el a soros vonali konzolt, akkor a rendszermag
	      beállításai közé
	      még az alábbit is fel kell vennünk,
	      majd újra kell fordítanunk:</para>

	    <programlisting>options CONSPEED=19200</programlisting>
	  </listitem>

	  <listitem>
	    <para>A rendszermagnak adjuk át a <option>-S</option>
	      rendszerindítási paramétert.  A
	      <option>-S</option> parancssori opció a
	      <filename>/boot.config</filename>
	      állományban is megadható.  A
	      &man.boot.8; man oldalon tudhatjuk meg, hogy a
	      <filename>/boot.config</filename>
	      beállításai közé hogyan
	      tudjuk felvenni és ott milyen további
	      lehetõségeink vannak még.</para>
	  </listitem>

	  <listitem>
	    <para>A <filename>/boot/loader.conf</filename>
	      állományban engedélyezzük a
	      <varname>comconsole_speed</varname>
	      beállítást.</para>

	    <para>Ez a beállítás a szintén a
	      <filename>/boot/loader.conf</filename>
	      állományban megadható
	      <varname>console</varname>, <varname>boot_serial</varname>
	      és <varname>boot_multicons</varname>
	      változóktól függ.  A soros
	      vonali konzol sebességét tehát
	      például így tudjuk
	      megváltoztatni a
	      <varname>comconsole_speed</varname>
	      megadásával:</para>

	    <programlisting>boot_multicons="YES"
boot_serial="YES"
comconsole_speed="115200"
console="comconsole,vidconsole"</programlisting>
	  </listitem>
	</itemizedlist>

      </sect3>

      <sect3 xml:id="serialconsole-com2">
	<title>Soros vonali konzol a <filename>sio0</filename>
	  porton kívül máshol</title>

	<para>Ha valamilyen okból kifolyólag nem a
	  <filename>sio0</filename> porton keresztül akarjuk
	  használni a konzolt, akkor ahhoz a
	  rendszerindító blokkok, a
	  rendszertöltõ és a rendszermag
	  forrásait újra kell fordítanunk az
	  alábbiak szerint:</para>

	<procedure>
	  <step>
	    <para>Szerezzük be a rendszermag
	      forrását.  (Lásd <xref linkend="updating-upgrading"/>)</para>
	  </step>

	  <step>
	    <para>Írjuk át a
	      <filename>/etc/make.conf</filename>
	      állományban a
	      <literal>BOOT_COMCONSOLE_PORT</literal>
	      címét az általunk használt
	      porthoz tartozóéra (0x3F8, 0x2F8, 0x3E8 vagy
	      0x2E8).  Itt csak a <filename>sio0</filename>
	      és <filename>sio3</filename>
	      (<filename>COM1</filename> és
	      <filename>COM4</filename>) közti portok
	      használhatóak &mdash; a töbportos soros
	      kártyák címei nem adhatóak
	      meg.  A megszakításokat nem kell
	      beállítanunk.</para>
	  </step>

	  <step>
	    <para>Készítsünk egy saját
	      rendszermag beállításait
	      tartalmazó állományt, és
	      vegyük fel bele a használni
	      kívánt soros port megfelelõ
	      paramétereit.  Például, ha a
	      <filename>sio1</filename>
	      (<filename>COM2</filename>) eszközt akarjuk
	      konzolként használni:</para>

	    <programlisting>device sio1 at isa? port IO_COM2 flags 0x10 irq 3</programlisting>

	    <para>vagy</para>

	    <programlisting>device sio1 at isa? port IO_COM2 flags 0x30 irq 3</programlisting>

	    <para>A konzolra vonatkozó
	      beállításokat a többi soros
	      portnál ne adjuk meg.</para>
	  </step>

	  <step>
	    <para>Fordítsuk újra és
	      telepítsük a rendszerindító
	      blokkot és a rendszertöltõt:</para>

	    <screen>&prompt.root; <userinput>cd /sys/boot</userinput>
&prompt.root; <userinput>make clean</userinput>
&prompt.root; <userinput>make</userinput>
&prompt.root; <userinput>make install</userinput></screen>
	  </step>

	  <step>
	    <para>Fordítsuk és telepítsük
	      újra a rendszermagot.</para>
	  </step>

	  <step>
	    <para>A &man.bsdlabel.8; segítségével
	      másoljuk az új rendszerindító
	      blokkot a rendszer indítását
	      végzõ lemezre és töltsük be
	      az új rendszermagot.</para>
	  </step>
	</procedure>
      </sect3>

      <sect3 xml:id="serialconsole-ddb">
	<title>A DDB elérése a soros
	  vonalról</title>

	<para>Ha a soros vonali konzolról akarjuk
	  használni a rendszermagba épített
	  nyomkövetõt (ami hasznos lehet távoli
	  vizsgálódáskor, de egyben
	  veszélyes is, ha a soros porton tévesen
	  kiküldünk egy BREAK jelzést!), akkor a
	  rendszermagot a következõ
	  beállításokkal kell
	  fordítanunk:</para>

	<programlisting>options BREAK_TO_DEBUGGER
options DDB</programlisting>

      </sect3>

      <sect3>
	<title>A bejelentkezõ képernyõ
	  elérése a soros vonali konzolról</title>

	<para>Habár erre nincs feltétlenül
	  szükségünk, a rendszer üzeneteinek
	  és a rendszermag nyomkövetõjének
	  elérése után akár <emphasis>be is
	  tudunk jelentkezni</emphasis> a soros vonalon keresztül.
	  Íme!</para>

	<para>Nyissuk meg az <filename>/etc/ttys</filename>
	  állományt a kedvenc
	  szövegszerkesztõnkkel és keressük meg a
	  következõ sorokat:</para>

      <programlisting>ttyd0 "/usr/libexec/getty std.9600" unknown off secure
ttyd1 "/usr/libexec/getty std.9600" unknown off secure
ttyd2 "/usr/libexec/getty std.9600" unknown off secure
ttyd3 "/usr/libexec/getty std.9600" unknown off secure</programlisting>

	<para>A <filename>ttyd0</filename> és
	  <filename>ttyd3</filename> közti sorok pontosan a
	  <filename>COM1</filename> és
	  <filename>COM4</filename> közti portoknak felelnek
	  meg.  A használni kívánt port
	  sorában szereplõ <literal>off</literal>
	  paramétert írjuk át az
	  <literal>on</literal> értékre.  Ha a soros port
	  sebességét is megváltoztattuk, minden
	  bizonnyal a <literal>std.9600</literal> helyett is az adott
	  sebességhez illeszkedõ paramétert kell
	  megadnunk, például az
	  <literal>std.19200</literal> értékkel.</para>

	<para>Érdemes továbbá még az
	  <literal>unknown</literal> helyett megadni az adott
	  terminál típusát.</para>

	<para>Az állomány
	  módosítását követõen a
	  változatások
	  érvényesítéséhez ki kell
	  adnunk a <command>kill -HUP 1</command> parancsot is.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="serialconsole-loader">
      <title>A konzol megváltoztatása a
	rendszertöltõbõl</title>

      <para>A korábbi szakaszokban arról
	beszéltünk, hogy miként
	állítsuk be a soros vonali konzolt a
	rendszerindító blokk
	megpiszkálásával.  Ebben a szakaszban
	viszont azt mutatjuk meg, hogy különbözõ
	parancsokon és környezeti változókon
	keresztül miként tudjuk megadni a konzolt a
	rendszertöltõben.  Mivel a rendszertöltõre a
	rendszerindítás harmadik fokozatában
	kerül sor, az ott megadott értékekkel
	felül tudjuk bírálni a
	rendszerindító blokk
	beállításait.</para>

      <sect3>
	<title>A soros vonali konzol
	  beállítása</title>

	<para>A rendszertöltõ és a rendszermag az
	  <filename>/boot/loader.conf</filename>
	  állományon keresztül elég
	  könnyen rávehetõ a soros vonali konzol
	  használatára:</para>

	<programlisting>set console="comconsole"</programlisting>

	<para>Ez a rendszerindító blokk elõzõ
	  szakaszban tárgyalt
	  beállításaitól
	  függetlenül érvényesül.</para>

	<para>A fenti sort a <filename>/boot/loader.conf</filename>
	  állomány elejére érdemes
	  tennünk, így a soros vonali konzolon már a
	  lehetõ leghamarabb megjelennek a rendszer
	  üzenetei.</para>

	<para>Ehhez hasonló módon a belsõ konzolt is
	  megadhatjuk:</para>

	<programlisting>set console="vidconsole"</programlisting>

	<para>Ha a rendszertöltõben nem adjuk meg a
	  <envar>console</envar> környezeti változó
	  értékét, akkor a rendszertöltõ,
	  és így a rendszermag is, a
	  rendszerindító blokkban a <option>-h</option>
	  opció által meghatározott konzolt fogja
	  használni.</para>

	<para>A konzol a <filename>/boot/loader.conf.local</filename>
	  vagy a <filename>/boot/loader.conf</filename>
	  állományokban adható meg.</para>

	<para>A részletekkel kapcsolatban lásd a
	  &man.loader.conf.5; man oldalt.</para>

	<note>
	  <para>Jelen pillanatban a rendszertöltõnek nincs a
	    <option>-P</option> paraméterrel ekvivalens
	    értékû beállítása,
	    ezért a billentyûzet jelenléte
	    alapján nem képes magától
	    választani a belsõ és a soros vonali
	    konzol között.</para>
	</note>

      </sect3>

      <sect3>
	<title>Soros vonali konzol a <filename>sio0</filename>
	  porton kívül máshol</title>

	<para>A rendszertöltõt ne a
	  <filename>sio0</filename> eszközzel fordítsuk
	  újra a soros vonali konzolhoz.  Ehhez
	  kövessük a <xref linkend="serialconsole-com2"/>ban
	  leírt eljárás
	  lépéseit.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="serialconsole-caveats">
      <title>Figyelmeztetések</title>

      <para>A szakaszban szereplõ ötletek alapján sokan
	így most már könnyen be tudnak
	állítani egy billentyûzet és grafikus
	hardver nélküli dedikált szervert.  Sajnos
	azonban a legtöbb rendszer nem engedi a billentyûzet
	nélküli indítást, és akad
	néhány olyan is, amely pedig a grafikus
	kártya hiányában nem is indul el.  Az AMI
	BIOS-os gépeknél a grafikus kártya
	nélküli indításhoz elegendõ
	csupán a beállítások
	között a grafikus kártyát
	(<quote>graphics adapter</quote>) <quote>Not installed</quote>
	(nem telepített) állapotúra
	állítani.  Ha ilyen opció nem
	található a BIOS-ban, akkor helyette keressük
	a <quote>Halt on Error</quote> (leállás hiba
	esetén) változatot.  Ha ezt a <quote>All but
	Keyboard</quote> (a billentyûzet kivételével
	minden) vagy akár a <quote>No Error</quote> (soha)
	értékre állítjuk, az elõbbi
	eredményt kapjuk.</para>

      <para>Ennek ellenére elõfordulhat azonban, hogy egyes
	gépeken egyáltalán nem találunk
	ilyen lehetõséget és videokártya
	nélkül nem indulnak el.  Ezekben az esetekben
	tegyünk a gépbe valamilyen kártyát
	(ehhez elég egy egyszerû típus is), de
	monitort már ne kössünk rá.  Esetleg
	megpróbálkozhatunk még AMI BIOS
	telepítésével is.</para>

    </sect2>
  </sect1>
</chapter>
