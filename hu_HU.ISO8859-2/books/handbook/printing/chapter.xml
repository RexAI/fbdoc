<?xml version="1.0" encoding="iso-8859-2"?>
<!--
     The FreeBSD Documentation Project

     $FreeBSD$
-->
<!-- The FreeBSD Hungarian Documentation Project
     Translated by: PALI, Gabor <pgj@FreeBSD.org>
     %SOURCE%	en_US.ISO8859-1/books/handbook/printing/chapter.xml
     %SRCID%	1.122
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="printing" xml:lang="hu">
  <info><title>Nyomtatás</title>
    <authorgroup>
      <author><personname><firstname>Sean</firstname><surname>Kelly</surname></personname><contrib>Írta: </contrib></author>
    </authorgroup>
    <authorgroup>
      <author><personname><firstname>Jim</firstname><surname>Mock</surname></personname><contrib>Átdolgozta és frissítette:
	  </contrib></author>
    </authorgroup>
  </info>

  

  <sect1 xml:id="printing-synopsis">
    <title>Áttekintés</title>

    <indexterm><primary>LPD nyomtatási
      rendszer</primary></indexterm>
    <indexterm><primary>nyomtatás</primary></indexterm>

    <para>A &os; a nyomtatók széles skálájával
      képes együttmûködni, a
      legrégebbi vegyszeres nyomtatótól kezdve
      egészen napjaink lézernyomtatójáig,
      aminek köszönhetõen alkalmazásainkkal nagyon
      jó minõségû nyomtatásokat tudunk
      készíteni.</para>

    <para>A &os; a helyi hálózaton
      nyomtatószervernek is beállítható.
      Ekkor a vele közös hálózatra
      csatlakozó többi, &os;, &windows; vagy &macos;
      rendszerû számítógéptõl
      képes nyomtatási kéréseket elfogadni.
      A &os; gondoskodik róla, hogy egyszerre csak egy
      nyomtatás készüljön el, számon
      tartja, hogy mely felhasználók és
      számítógépek nyomtatnak a
      legtöbbet, és minden feladathoz
      <quote>munkalapot</quote> (banner page) készít,
      amiben többek közt megtalálhatjuk, hogy kihez
      tartozik.</para>

    <para>A fejezet elolvasása során
      megismerjük:</para>

    <itemizedlist>
      <listitem>
	<para>hogyan állítsuk be a &os; nyomtatási
	  sorát;</para>
      </listitem>

      <listitem>
	<para>hogyan telepítsünk nyomtatási
	  szûrõket, hogyan kezeljünk
	  különbözõ speciális
	  nyomtatási feladatokat, tehát
	  például miként alakítsuk át
	  a beérkezõ dokumentumokat olyan nyomtatási
	  formátumra, amelyet a nyomtatónk is
	  megért;</para>
      </listitem>

      <listitem>
	<para>hogyan engedélyezzük a fejléc- vagy
	  nyomtatási információk
	  kinyomtatását;</para>
      </listitem>

      <listitem>
	<para>hogyan nyomtassunk más
	  számítógépekhez csatlakoztatott
	  nyomtatókkal;</para>
      </listitem>

      <listitem>
	<para>hogyan nyomtassunk a hálózatra
	  közvetlenül kapcsolt nyomtatókkal;</para>
      </listitem>

      <listitem>
	<para>hogyan állítsuk be a nyomtatási
	  korlátozásokat, például a
	  nyomtatási feladatok méretét, amivel
	  egyes felhasználók nyomtatását
	  visszafoghatjuk;</para>
      </listitem>

      <listitem>
	<para>hogyan készítsünk nyomtatási
	  kimutatásokat és nyilvántartást a
	  nyomtató használatáról;</para>
      </listitem>

      <listitem>
	<para>hogyan keressük meg a nyomtatás során
	  felmerülõ problémák okait.</para>
      </listitem>
    </itemizedlist>

    <para>A fejezet elolvasásához ajánlott:</para>

    <itemizedlist>
      <listitem>
	<para>egy új rendszermag
	  beállításának és
	  telepítésének ismerete (<xref linkend="kernelconfig"/>).</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="printing-intro-spooler">
    <title>Bevezetés</title>

    <para>A &os;-ben a nyomtatók
      mûködéséhez be kell állítani
      az <application>LPD</application> nyomtatási rendszert.  Ez
      a Berkeley sornyomtatási rendszere, amelyet ezentúl
      röviden csak <application>LPD</application>-nek fogunk
      hívni.  Ez a &os; alapértelmezett szabványos
      nyomtatásvezérlõ rendszere.  Ebben a fejezetben
      az <application>LPD</application> és annak
      konfigurációja kerül bemutatásra.</para>

    <para>Ha már találkoztunk az
      <application>LPD</application>-vel vagy hozzá
      hasonló rendszerekkel, akkor innen nyugodtan ugorhatunk a
      <link linkend="printing-intro-setup">Kezdeti
	beállítások</link> címû
      szakaszra.</para>

    <para>Az <application>LPD</application> vezérli a
      számítógéphez csatlakoztatott
      nyomtató összes funkcióját.
      Számos feladata van:</para>

    <itemizedlist>
      <listitem>
	<para>Felügyeli a lokálisan és
	  hálózaton keresztül csatlakoztatott
	  nyomtatók hozzáféréseit.</para>
      </listitem>

      <listitem>
	<indexterm><primary>nyomtatási
	  munkák</primary></indexterm>

	<para>Lehetõvé teszi az átküldött
	  állományok kinyomtatását,
	  amelyeket <emphasis>nyomtatási feladatoknak</emphasis>
	  nevezünk.</para>
      </listitem>

      <listitem>
	<para>Minden nyomtatóhoz fenntart egy nyomtatási
	  <emphasis>sort</emphasis>, amivel meg tudja
	  akadályozni, hogy egyszerre több
	  felhasználó is hozzá tudjon férni
	  az egyes nyomtatókhoz.</para>
      </listitem>

      <listitem>
	<para>A <emphasis>fejléceket</emphasis> (vagy más
	  néven <emphasis>munka-</emphasis> vagy
	  <emphasis>elválasztó lapokat</emphasis>)
	  nyomtat, így a felhasználók könnyen
	  megtalálják a saját nyomtatásaikat
	  a többi közt.</para>
      </listitem>

      <listitem>
	<para>Felügyeli a soros portokon csatlakozó
	  nyomtatók kommunikációs
	  beállításait.</para>
      </listitem>

      <listitem>
	<para>A hálózaton keresztül
	  átküldi a nyomtatási feladatokat egy
	  másik számítógép
	  <application>LPD</application> sorába.</para>
      </listitem>

      <listitem>
	<para>A nyomtatási feladatok
	  formázásához lefuttatja az adott
	  nyomtató nyelvéhez és
	  képességeihez illeszkedõ speciális
	  szûrõket.</para>
      </listitem>

      <listitem>
	<para>Nyilvántartja a nyomtató
	  kihasználtságát.</para>
      </listitem>
    </itemizedlist>

    <para>A beállításait tartalmazó
      állomány (<filename>/etc/printcap</filename>)
      és a speciális szûrõprogramok
      segítségével az
      <application>LPD</application> sokféle nyomtatón
      képes az összes említett feladatot vagy annak
      egy részét megvalósítani.</para>

    <sect2 xml:id="printing-intro-why">
      <title>Amiért nyomtatási sort érdemes
	használni</title>

      <para>Amikor csak egyedül vagyunk a rendszerben,
	felmerülhet bennünk a kérdés, hogy minek
	is kellene nekünk veszõdni a nyomtatási sor
	beállításával, hiszen nincs
	szükségünk sem a
	hozzáférések
	vezérlésére, sem fejlécekre, sem
	pedig nyilvántartásra.  Noha akár
	közvetlenül is el tudjuk érni a
	nyomtatót, néhány okból azért
	mégis érdemes nyomtatási sort
	használni:</para>

      <itemizedlist>
	<listitem>
	  <para>Az <application>LPD</application> a
	    háttérben nyomtat, ezért ilyenkor nem
	    kell megvárni, amíg az adat
	    átmásolódik a nyomtatóra.</para>
	</listitem>

	<listitem>
	  <indexterm><primary>&tex;</primary></indexterm>

	  <para>Az <application>LPD</application> tetszõlegesen
	    tudja alakítani a nyomtatási feladatokat:
	    hozzájuk tud tenni különbözõ
	    adatokat (dátum és idõ), vagy a
	    speciális állományokat
	    (például a &tex; DVI formátumát)
	    képes megértetni a nyomtatóval,
	    és nem nekünk kell mindezeket a
	    lépéseket elvégeznünk.</para>
	</listitem>

	<listitem>
	  <para>Számos nyomtatási lehetõséggel
	    rendelkezõ szabad és kereskedelmi program arra
	    számít, hogy a rendszerünkben
	    nyomtatási sor található, ezért
	    annak beállításával sokkal
	    könnyebb használni ezeket a szoftvereket.</para>
	</listitem>
      </itemizedlist>

    </sect2>
  </sect1>

  <sect1 xml:id="printing-intro-setup">
    <title>Kezdeti beállítások</title>

    <para>Úgy tudjuk használni a nyomtatókat az
      <application>LPD</application> nyomtatási
      rendszerével, ha egyaránt beállítjuk a
      nyomtatót és magát az
      <application>LPD</application>-t is.  Itt a
      beállítás két szintjét
      tárgyaljuk:</para>

    <itemizedlist>
      <listitem>
	<para>Az <link linkend="printing-simple">Alacsonyszintû
	  nyomtatóbeállítás</link>
	  címû szakaszból megtudhatjuk, hogyan tudunk
	  csatlakoztatni egy nyomtatót, hogyan adjuk meg az
	  <application>LPD</application>-nek, miként
	  kommunikáljon vele, hogyan nyomtassunk ki egyszerû
	  szöveges állományokat a
	  nyomtatón.</para>
      </listitem>

      <listitem>
	<para>A <link linkend="printing-advanced">Magasszintû
	    nyomtatóbeállítás</link>
	  szakaszban bemutatjuk, hogyan nyomtassunk ki
	  különféle speciális
	  állományokat, hogyan
	  készíttessünk fejléceket, hogyan
	  nyomtassunk hálózaton keresztül, hogyan
	  vezéreljük a nyomtatók
	  hozzáférését és hogyan
	  tartsuk nyilván a nyomtató
	  használatát.</para>
      </listitem>
    </itemizedlist>

    <sect2 xml:id="printing-simple">
      <title>Alacsonyszintû
	nyomtatóbeállítás</title>

      <para>Ebben a szakaszban láthatjuk, miképpen kell
	beállítani a nyomtatónkat és az
	<application>LPD</application> hogyan lesz képes azt
	használatba venni.  Az alapoktól
	kezdünk:</para>

      <itemizedlist>
	<listitem>
	  <para>A <link linkend="printing-hardware">Hardveres
	      beállítás</link> címû
	    szakaszban abban kapunk segítséget, hogyan
	    kell a nyomtatót a
	    számítógéphez
	    csatlakoztatni.</para>
	</listitem>

	<listitem>
	  <para>A <link linkend="printing-software">Szoftveres
	      beállítás</link> címû
	    szakaszban az <application>LPD</application>
	    nyomtatási rendszer
	    beállítását tartalmazó
	    állományt (<filename>/etc/printcap</filename>)
	    vesszük sorra.</para>
	</listitem>
      </itemizedlist>

      <para>Amennyiben olyan nyomtatót akarunk
	beállítani, amely nem helyileg, hanem valamilyen
	hálózati protokollon keresztül csatlakozik,
	nézzük meg a <link linkend="printing-advanced-network-net-if">Nyomtatók
	  hálózati adatcsatlakozással</link>
	címû szakaszt.</para>

      <para>Habár ez a szakasz nevében csupán
	<quote>Alacsonyszintû
	nyomtatóbeállításról</quote>
	szól, meglehetõsen szerteágazó tud
	lenni.  A nyomtató hardveres és szoftveres
	életre keltése az egyik legnehezebb feladat.  Ha
	van egy mûködõ nyomtatónk, a
	fejlécek és a nyilvántartás
	beállítása tulajdonképpen már
	gyerekjáték.</para>

      <sect3 xml:id="printing-hardware">
	<title>Hardveres beállítás</title>

	<para>Ebben a szakaszban a nyomtatók
	  csatlakoztatásának lehetséges
	  módozatairól esik szó.  Beszélni
	  fogunk mindenféle portokról és
	  kábelekrõl, és a &os;
	  rendszermagjának az egyes nyomtatók
	  használatához szükséges
	  beállításairól is.</para>

	<para>Ha korábban tudtuk csatlakoztatni a
	  nyomtatónkat, és más
	  operációs rendszerekkel már sikeresen
	  nyomtattunk is vele, akkor rögtön ugorhatunk is a <link linkend="printing-software">Szoftveres
	    beállítás</link>okat tartalmazó
	  szakaszra.</para>

	<sect4 xml:id="printing-ports">
	  <title>Portok és kábelek</title>

	  <para>A személyi
	    számítógépekhez kapható
	    nyomtatók általában a
	    következõ három csatolófelület
	    egyikével rendelkeznek:</para>

	  <itemizedlist>
	    <listitem>
	      <indexterm>
		<primary>nyomtató</primary>
		<secondary>soros</secondary>
	      </indexterm>

	      <para>A <emphasis>soros</emphasis>, más
		néven RS-232-es vagy COM porton keresztül
		kommunikáló felületek a
		számítógép soros
		portján küldenek adatot a
		nyomtatónak.  A soros
		csatolófelületek igen elterjedtek a
		számítógépiparban,
		könnyen tudunk ilyen kábelt szerezni,
		gyorsan is gyártható.  Elõfordulhat,
		hogy a soros csatolófelületek
		használatához valamilyen
		különleges kábelre, valamint bonyolult
		kommunikációs
		beállítások
		megadására van szükség.  A
		legtöbb soros port által
		elérhetõ legnagyobb adatátviteli
		sebesség másodpercenként
		115&nbsp;200 bit, ami miatt azonban a komolyabb grafikai
		tartalmak nyomtatása szinte lehetetlen.</para>
	    </listitem>

	    <listitem>
	      <indexterm>
		<primary>nyomtató</primary>
		<secondary>párhuzamos</secondary>
	      </indexterm>

	      <para>A <emphasis>párhuzamos</emphasis>
		csatolófelületek a
		számítógépünk
		párhuzamos portjával küldenek
		adatokat a nyomtatónak.  A párhuzamos
		felületek gyorsabbak az RS-232 soros
		felületnél, és a
		számítógéppiacon is gyakran
		megtalálhatóak.  Könnyen tudunk ilyen
		kábelt szerezni, azonban kézileg nehezebb
		elkészíteni.  A párhuzamos
		csatolófelületekhez általában
		nem tartoznak kommunikációs
		beállítások, ezért
		rendkívül egyszerûen el lehet
		boldogulni velük.</para>

	      <indexterm>
		<primary>centronics</primary>
		<see>párhuzamos nyomtató</see>
	      </indexterm>

	      <para>A párhuzamos felületekre olykor
		<quote>Centronics</quote>
		csatolófelületként is hivatkoznak,
		amelyet egy nyomtatótípus után
		neveztek el.</para>
	    </listitem>

	    <listitem>
	      <indexterm>
		<primary>nyomtató</primary>
		<secondary>USB</secondary>
	      </indexterm>

	      <para>A Universal Serial Bus (Univerzális soros
		busz) rövidítéseként
		használt USB elnevezésû
		csatolófelület a párhuzamos és
		a soros felületeknél jóval nagyobb
		sebességre képes.  A
		hozzá tartozó kábelek
		felépítése egyszerû és
		az áruk olcsó.  Habár a
		nyomtatás terén az USB hivatott
		leváltani az RS-232-es soros és a
		párhuzamos felületeket, nem mindegyik &unix;
		rendszer támogatja kellõképpen.  Ezt
		a problémát például
		úgy kerülhetjük el, ha olyan
		nyomtatót vásárolunk, amelyen a
		legtöbbhöz hasonlóan a
		párhuzamos és az USB csatlakozás is
		megtalálható.</para>
	    </listitem>
	  </itemizedlist>

	  <para>A párhuzamos felületeken
	    általában csak egy irányban tudunk
	    üzeneteket küldeni (a
	    számítógéptõl a
	    nyomtatóhoz), miközben az USB és a soros
	    felület használatával mind a két
	    irányban is.  &os; alatt viszont már az
	    újabb (EPP és ECP) párhuzamos portok
	    egy IEEE&nbsp;1284 szabványú kábellel
	    képesek oda-vissza kommunikálni.</para>

	  <indexterm><primary>PostScript</primary></indexterm>

	  <para>A párhuzamos nyomtatók
	    kétirányú
	    kommunikációját általában
	    két mód közül az egyiken
	    szokták megvalósítani.  Az elsõ
	    esetben a &os; a nyomtatóhoz egy speciális
	    meghajtót használ, amely ismeri az
	    általa beszélt nyelvet.  Ilyenek a
	    tintasugaras nyomtatók, amelyek más
	    egyéb állapotinformációk mellett
	    ezen keresztül képesek jelezni a tintapatronokban
	    levõ tinta mennyiségét.  A második
	    esetben a nyomtató ismeri a &postscript;
	    nyelvet.</para>

	  <para>A &postscript; nyelvû nyomtatási feladatok
	    valójában a nyomtatónak
	    küldött programok.  Használatukhoz
	    még papírra sincs feltétlenül
	    szükség, és elõfordulhat, hogy
	    közvetlenül a
	    számítógépnek
	    válaszolnak.  A &postscript; is
	    kétirányú kommunikáción
	    keresztül értesíti a
	    számítógépet az olyan
	    gondokról, mint például a &postscript;
	    programokban levõ hibák vagy a papír
	    beakadása, amely információnak a
	    felhasználók szoktak örülni.
	    Hovatovább ez a kétirányú
	    kommunikáció a kulcsa a &postscript;
	    nyomtatók hatékony
	    nyilvántartásának is: egyszerûen
	    lekérdezzük a nyomtatótól a
	    lapszámlálót (ami megadja, hogy a
	    nyomtató eddig mennyi lapot nyomtatott ki),
	    kiküldjük a felhasználóhoz
	    tartozó feladatot és ismét
	    lekérdezzük a lapszámlálót.
	    A két érték
	    kivonásából
	    tájékozódhatunk a
	    felhasználó által igényelt lapok
	    mennyiségérõl.</para>

	</sect4>

	<sect4 xml:id="printing-parallel">
	  <title>Párhuzamos portok</title>

	  <para>A párhuzamos csatolófelületen
	    érintkezõ nyomtató
	    használatához kapcsoljunk össze
	    számítógépünket és
	    nyomtatónkat egy párhuzamos kábellel.
	    Az erre vonatkozó konkrét
	    utasítások a nyomtató és/vagy a
	    számítógép
	    kézikönyvében olvashatóak.</para>

	  <para>Jegyezzük meg, hogy a
	    számítógép melyik
	    párhuzamos portjára csatlakoztattuk a
	    kábelt.  &os; alatt az elsõ ilyen port a
	    <filename>ppc0</filename> eszköz, a
	    második pedig a <filename>ppc1</filename> eszköz lesz
	    és így tovább.  A
	    nyomtatóeszköz elnevezése ugyanezt a
	    sémát követi: a <filename>/dev/lpt0</filename> lesz az elsõ
	    párhuzamos porton levõ nyomtató
	    stb.</para>

	</sect4>

	<sect4 xml:id="printing-serial">
	  <title>Soros portok</title>

	  <para>A soros csatolófelületet
	    használó nyomtatók
	    beüzemeléséhez elõször egy
	    soros kábel segítségével
	    kapcsoljuk össze a
	    számítógépünkkel.  Ennek
	    pontos részleteit a nyomtató és/vagy a
	    számítógépünk
	    kézikönyvében találhatjuk
	    meg.</para>

	  <para>Ha nem vagyunk benne biztosak, hogy milyen a
	    <quote>megfelelõ soros kábel</quote>,
	    próbáljunk az alábbiak alapján
	    dönteni:</para>

	  <itemizedlist>
	    <listitem>
	      <para>A <emphasis>modem</emphasis> kábele a
		két oldalán levõ, egymásnak
		megfelelõ tüskéket
		közvetlenül összeköti.  Ezt a
		típust nevezik <quote>DTE-DCE</quote>
		kábelnek.</para>
	    </listitem>

	    <listitem>
	      <indexterm><primary>null-modem kábel</primary></indexterm>

	      <para>A <emphasis>null-modem</emphasis> kábel
		bizonyos érintkezõket rendesen,
		másokat pedig fordítva köt össze
		(például a küldõt a
		fogadóval), illetve némelyeket
		rövidre zár közvetlenül a
		csatlakozón belül.  Ez a típus a
		<quote>DTE-DTE</quote> kábel.</para>
	    </listitem>

	    <listitem>
	      <para>Néhány speciális
		nyomtató esetén elõfordul még
		a <emphasis>soros
		nyomtató</emphasis>kábel, amely
		leginkább a null-modem kábelekhez
		hasonlít, azonban az ott rövidre
		zárt csatornák itt a nekik megfelelõ
		érintkezõknek továbbítanak
		jeleket.</para>
	    </listitem>
	  </itemizedlist>

	  <indexterm><primary>jelváltási
	    sebesség</primary></indexterm>
	  <indexterm><primary>paritás</primary></indexterm>
	  <indexterm><primary>forgalomirányítási
	    protokoll</primary></indexterm>

	  <para>Emellett még a nyomtató
	    elõlapján vagy az alján
	    található kapcsolók
	    segítségével be kell
	    állítanunk a nyomtatóhoz tartozó
	    kommunikációs paramétereket is.  Itt
	    válasszuk azt a <literal>bps</literal> (a bitek
	    száma másodpercenként)
	    értéket, amelyet még a
	    számítógépünk és a
	    nyomtatónk is egyaránt képes
	    támogatni.  Válasszunk 7 vagy 8 adatbitet,
	    páros, páratlan vagy kikapcsolt
	    paritásbitet és 1 vagy 2 stopbitet.  Ekkor
	    tudjuk megadni a forgalomirányítási
	    protokollt is: lehet kikapcsolt, XON/XOFF (ez az ún.
	    <quote>sávon belüli</quote> vagy
	    <quote>szoftveres</quote>)
	    forgalomirányítás.  Ne felejtsük
	    el ezeket a beállításokat a most
	    következõ szoftveres
	    beállítások elvégzése
	    során sem.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="printing-software">
	<title>Szoftveres beállítás</title>

	<para>Ebben a fejezetben tárgyaljuk a &os;-ben
	  található <application>LPD</application>
	  nyomtatási rendszer mûködéséhez
	  és a nyomtatáshoz szükséges
	  szoftveres beállításokat.</para>

	<para>Íme az elvégzendõ lépések
	  rövid vázlata:</para>

	<procedure>
	  <step>
	    <para>Amennyiben szükséges,
	      állítsuk be a rendszermagunkat
	      a nyomtató által használt portra.
	      Ehhez <link linkend="printing-kernel">A rendszermag
		beállítása</link> szakaszban
	      olvashatjuk el, mit is kell pontosan tenni.</para>
	  </step>

	  <step>
	    <para>Ha párhuzamos portot használunk, akkor
	      állítsuk be, hogy a párhuzamos port
	      miként fog kommunikálni.  <link linkend="printing-parallel-port-mode">A párhuzamos
	      port kommunikációs módjának
	      beállítása</link> címû
	      szakasz tárja fel ennek részleteit.</para>
	  </step>

	  <step>
	    <para>Próbáljuk ki, hogy ezek után az
	      operációs rendszer képes-e adatot
	      küldeni a nyomtatónak.  <link linkend="printing-testing">A nyomtató
		kommunikációjának
		ellenõrzése</link> szakaszban kapunk erre
	      pár javaslatot.</para>
	  </step>

	  <step>
	    <para>Az <filename>/etc/printcap</filename>
	      állomány
	      felhasználásával
	      állítsuk be a nyomtatónkhoz az
	      <application>LPD</application>-t.  Errõl a fejezet
	      további részei adnak majd
	      felvilágosítást.</para>
	  </step>
	</procedure>

	<sect4 xml:id="printing-kernel">
	  <title>A rendszermag beállítása</title>

	  <para>Az operációs rendszer magja
	    eszközök egy adott csoportjával
	    képes együttmûködni, amelyben a soros
	    és párhuzamos felületen csatlakozó
	    nyomtatók is megtalálhatóak.  Azonban
	    ha a rendszermag nem ismeri fel még valamelyiket,
	    akkor a soros vagy párhuzamos portok
	    használatához külön
	    támogatásra van szükség.</para>

	  <para>Így tudjuk megnézni, hogy a jelenleg
	    használt rendszermag támogatja-e a soros
	    csatolófelületet:</para>

	  <screen>&prompt.root; <userinput>grep sioN /var/run/dmesg.boot</userinput></screen>

	  <para>Itt az <replaceable>N</replaceable>
	    nullától kezdõdõen adja meg a soros
	    port sorszámát.  Amennyiben látunk
	    valami ilyesmit:</para>

	  <screen>sio2 at port 0x3e8-0x3ef irq 5 on isa
sio2: type 16550A</screen>

	  <para>Ez azt jelenti, hogy a rendszermag sikeresen
	    észlelte a portot.</para>

	  <para>A párhuzamos csatolófelület
	    támogatásáról így
	    gyõzõdhetünk meg:</para>

	  <screen>&prompt.root; <userinput>grep ppcN /var/run/dmesg.boot</userinput></screen>

	  <para>Itt az <replaceable>N</replaceable>
	    nullától kezdõdõen
	    sorszámozza a párhuzamos portot.  Ha
	    eredményül valami hasonlót kapunk:</para>

	  <screen>ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</screen>

	  <para>Ez arra utal, hogy a rendszermagunk tud a
	    portról.</para>

	  <para>Elõfordulhat azonban, hogy az
	    operációs rendszer csak akkor fogja
	    észrevenni a nyomtatásra használt soros
	    vagy párhuzamos portot, ha
	    átállítjuk a rendszermagunkat.</para>

	  <para>A soros port támogatásának
	    beállításához olvassuk el a
	    rendszermag beállításáról
	    szóló szakaszt.  A párhuzamos port
	    támogatásához szintén olvassuk
	    el ugyanazt a szakaszt <emphasis>és</emphasis> a most
	    következõt.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="printing-parallel-port-mode">
	<title>A párhuzamos port kommunikációs
	  módjának beállítása</title>

	<para>A párhuzamos csatolófelület
	  használata esetén választhatunk, hogy a
	  &os; milyen módon tartsa a kapcsolatot a
	  nyomtatóval: megszakításokkal
	  vezérelje (interrupt-driven), vagy esetleg folyamatosan
	  kérdezgesse (polled).  A &os; általános
	  meghajtója (&man.lpt.4;) a &man.ppbus.4; alrendszert
	  használja, ami a portot a &man.ppc.4; meghajtón
	  keresztül vezérli.</para>

	<itemizedlist>
	  <listitem>
	    <para>A <emphasis>megszakítás
	      alapú</emphasis> módszer a GENERIC
	      rendszermagban alapértelmezés.  Ilyenkor az
	      operációs rendszer egy
	      megszakításkérés
	      felhasználásával értesül
	      arról, hogy a nyomtató mikor áll
	      készen adatok fogadására.</para>
	  </listitem>

	  <listitem>
	    <para>A <emphasis>lekérdezéses</emphasis>
	      módszer használata során az
	      operációs rendszer folyamatosan
	      érdeklõdik a nyomtató
	      rendelkezésre
	      állásáról.  Amikor erre
	      pozitív megerõsítést kap, akkor
	      a rendszermag újabb adatokat küld.</para>
	  </listitem>
	</itemizedlist>

	<para>A megszakításos módszer valamivel
	  gyorsabb, azonban cserébe lefoglal egy
	  értékes IRQ vonalat.  A HP újabb
	  nyomtatói állítólag nem
	  mûködnek megfelelõen ilyen módban,
	  valamilyen (pillanatnyilag még nem teljesen
	  tisztázott) idõzítési
	  probléma miatt.  Ezért az ilyen
	  nyomtatóknak is valószínûleg a
	  lekérdezéses módszert kell
	  használniuk.  Más nyomtatók pedig,
	  habár mûködnek mind a két
	  módszerrel, hihetetlenül lassúak a
	  megszakításokkal.</para>

	<para>Kétféleképpen
	  állíthatjuk be a kommunikációs
	  módot: a rendszermagon keresztül, vagy az
	  &man.lptcontrol.8; segédprogrammal.</para>

	<para><emphasis>A rendszermagban így
	  állíthatjuk be a
	  kommunikációt:</emphasis></para>

	<procedure>
	  <step>
	    <para>Írjuk át a rendszermag
	      beállításait tartalmazó
	      állományt.  Keressük meg benne a
	      használt párhuzamos portnak megfelelõen
	      a <literal>ppc0</literal>, <literal>ppc1</literal>
	      (második párhuzamos port) vagy
	      <literal>ppc2</literal> (harmadik párhuzamos port)
	      bejegyzést, és
	      engedélyezzük.</para>

	    <itemizedlist>
	      <listitem>
		<para>A megszakításos mód
		  használatához nyissuk meg a
		  <filename>/boot/device.hints</filename>
		  állományt, és az
		  <replaceable>N</replaceable> helyére
		  írjuk be a</para>

		<programlisting>hint.ppc.0.irq="<replaceable>N</replaceable>"</programlisting>

		<para>sorba a megfelelõ IRQ számát.
		  A rendszermag beállításait
		  tartalmazó állománynak
		  tartalmaznia kell a &man.ppc.4; meghajtót
		  is:</para>

		 <screen>device ppc</screen>

	      </listitem>

	      <listitem>
		<para>A lekérdezéses mód
		  használatához a
		  <filename>/boot/device.hints</filename>
		  állományból
		  távolítsuk el a következõ
		  sort:</para>

		<programlisting>hint.ppc.0.irq="<replaceable>N</replaceable>"</programlisting>

		<para>Némely esetben azonban ennyi még nem
		  lesz elég a port lekérdezéses
		  beállításához.  Ugyanis ha
		  a hozzá tartozó meghajtó az
		  &man.acpi.4;, akkor ez fogja felismerni, kezelni
		  és a nyomtatóhoz tartozó portok
		  hozzáférési módját
		  vezérelni.  A problémát
		  ezért gyakran érdemes az &man.acpi.4;
		  beállításai között is
		  keresni.</para>
	      </listitem>
	    </itemizedlist>
	  </step>

	  <step>
	    <para>Mentsük el az állományt.
	      Konfiguráljuk be, fordítsuk le és
	      telepítsük az új rendszermagot.  Ennek
	      pontos részleteit <link linkend="kernelconfig">a
	      rendszermag
	      beállításáról</link>
	      szóló fejezetben olvashatjuk.</para>
	  </step>
	</procedure>

	<para><emphasis>A kommunikáció
	  módjának
	  beállítása</emphasis> az
	  &man.lptcontrol.8; programmal:</para>

	<procedure>
	  <step>
	    <para>A megszakításos mód
	      beállításához írjuk
	      be:</para>

	    <screen>&prompt.root; <userinput>lptcontrol -i -d /dev/lptN</userinput></screen>

	    <para>ahol az
	      <literal>lptN</literal> a
	      nyomtatóhoz tartozó eszköz neve.</para>
	  </step>

	  <step>
	    <para>A lekérdezéses mód
	      beállításához írjuk
	      be:</para>

	    <screen>&prompt.root; <userinput>lptcontrol -p -d /dev/lptN</userinput></screen>

	    <para>ahol az
	      <literal>lptN</literal> a
	      nyomtatóhoz tartozó eszköz neve.</para>
	  </step>
	</procedure>

	<para>Ha ezeket a parancsokat berakjuk az
	  <filename>/etc/rc.local</filename>
	  állományunkba, akkor azzal a rendszer minden
	  egyes indítása során
	  beállítjuk a számunkra megfelelõ
	  módot.  Errõl többet az &man.lptcontrol.8;
	  man oldaláról tudhatunk meg.</para>
      </sect3>

      <sect3 xml:id="printing-testing">
	<title>A kommunikáció
	  ellenõrzése</title>

	<para>Még mielõtt nekilátnánk a
	  nyomtatási rendszer
	  beállításának, bizonyosodjuk meg
	  róla, hogy az operációs rendszer
	  képes adatokat továbbítani a
	  nyomtatónak.  Sokkal könnyebb
	  egymástól függetlenül
	  megvizsgálni a kommunikáció és
	  a nyomtatási rendszer
	  mûködését.</para>

	<para>A nyomtatót úgy tudjuk
	  kipróbálni, ha küldünk neki valamilyen
	  szöveget.  Az &man.lptest.1; tökéletesen
	  megfelelõ akkor, ha olyan nyomtatónk van, amely
	  azonnal kinyomtatja a kapott szöveget.  Ez a program 96
	  sorban létrehozza mind a 96
	  kinyomtatható ASCII karaktert.</para>

	<indexterm><primary>PostScript</primary></indexterm>

	<para>A &postscript; (vagy más egyéb nyelvet
	  ismerõ) nyomtatóknak azonban ennél
	  kifinomultabb próbára van szüksége.
	  Erre a célra tökéletesen megfelel egy olyan
	  kisebb &postscript; programocska, mint például
	  ez:</para>

	<programlisting>%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Remek! Ez mukodik!) show
showpage</programlisting>

	<para>Ezt a &postscript; kódot nyugodtan
	  elmenthetjük egy állományba, amelyet
	  aztán a késõbbi szakaszokban megjelenõ
	  példák szerint használni is tudunk
	  majd.</para>

	<indexterm><primary>PCL</primary></indexterm>

	<note>
	  <para>A kézikönyvben a nyomtató nyelve
	    alatt leginkább egy &postscript;-szerû nyelvet
	    értünk, nem pedig a Hewlett Packard PCL
	    típusú nyelvét.  Habár a PCL
	    nagyon sokra képes, hiszen keverhetjük
	    még benne akár a programokat és a nyers
	    szövegeket is.  Ezzel szemben a &postscript; nem
	    képes nyers szöveget kinyomtatni, ezért
	    az ilyen típusú nyomtatók
	    mûködtetéséhez külön
	    támogatásra van
	    szükségünk.</para>
	</note>

	<sect4 xml:id="printing-checking-parallel">
	  <title>A párhuzamos nyomtató
	    ellenõrzése</title>

	  <indexterm>
	    <primary>nyomtató</primary>
	    <secondary>párhuzamos</secondary>
	  </indexterm>

	  <para>Ebben a szakaszban megtudhatjuk, hogy &os; alatt
	    miként ellenõrizzük a párhuzamos
	    portra csatlakozó nyomtatók
	    mûködését.</para>

	  <para><emphasis>A párhuzamos porton levõ
	    nyomtató
	    kipróbálásához:</emphasis></para>

	  <procedure>
	    <step>
	      <para>A &man.su.1; segítségével
		váljunk <systemitem class="username">root</systemitem>
		felhasználóvá.</para>
	    </step>

	    <step>
	      <para>Küldjünk a nyomtatónak valamilyen
		adatot.</para>

	      <itemizedlist>
		<listitem>
		  <para>Ha a nyomtató képes nyers
		    szöveget fogadni, akkor használjuk az
		    &man.lptest.1; programot.  Ehhez
		    gépeljük be:</para>

		  <screen>&prompt.root; <userinput>lptest &gt; /dev/lptN</userinput></screen>

		  <para>ahol az <replaceable>N</replaceable>
		    nullától kezdõdõen a
		    párhuzamos port sorszáma.</para>
		</listitem>

		<listitem>
		  <para>Ha a nyomtató &postscript; vagy
		    más nyomtatási nyelvet ismer, akkor
		    egy apró programot kell küldenünk
		    neki.  Ehhez írjuk be:</para>

		  <screen>&prompt.root; <userinput>cat &gt; /dev/lptN</userinput></screen>

		  <para>Ezután soronként írjuk be a
		    programot, de
		    <emphasis>vigyázzunk</emphasis>, mert az
		    <keycap>Enter</keycap> vagy a
		    <keycap>Return</keycap> lenyomása után
		    már nem tudjuk kijavítani!  A program
		    begépelése után nyomjuk meg a
		    <keycombo action="simul">
		    <keycap>Ctrl</keycap><keycap>D</keycap> </keycombo>
		    vagy bármely más olyan
		    billentyûkombinációt, amivel ki
		    tudunk lépni.</para>

		  <para>Ezt a programot belerakhatjuk egy
		    állományba is, amire aztán
		    adjuk ki az alábbi parancsot:</para>

		  <screen>&prompt.root; <userinput>cat állomány &gt; /dev/lptN</userinput></screen>

		  <para>ahol az
		    <replaceable>állomány</replaceable> a
		    nyomtatóra küldendõ program neve
		    lesz.</para>
		</listitem>
	      </itemizedlist>
	    </step>
	  </procedure>

	  <para>Ezután a nyomtató megkezdi a
	    nyomtatást.  Ne aggódjunk, ha netalán
	    valami furcsán nézne ki, mert a
	    késõbbiekben ezt még úgyis
	    rendbetesszük.</para>

	</sect4>

	<sect4 xml:id="printing-checking-serial">
	  <title>A soros nyomtató ellenõrzése</title>

	  <indexterm>
	    <primary>nyomtató</primary>
	    <secondary>soros</secondary>
	  </indexterm>

	  <para>Ebben a szakaszban megtudhatjuk, hogyan
	    ellenõrizzük a &os; és soros portra
	    kötött nyomtató
	    kapcsolódását.</para>

	  <para><emphasis>Így tudjuk kipróbálni a
	    soros porton csatlakozó
	    nyomtatónkat:</emphasis></para>

	  <procedure>
	    <step>
	      <para>A &man.su.1; paranccsal váljunk
		<systemitem class="username">root</systemitem>
		felhasználóvá.</para>
	    </step>

	    <step>
	      <para>Nyissuk meg az <filename>/etc/remote</filename>
		állományt.  Tegyük hozzá a
		következõ sort:</para>

	      <programlisting>printer:dv=<filename>/dev/port</filename>:br#<replaceable>bps</replaceable>:pa=<replaceable>paritás</replaceable></programlisting>

	      <indexterm><primary>bit-per-másodperc</primary></indexterm>
	      <indexterm><primary>soros port</primary></indexterm>
	      <indexterm><primary>paritás</primary></indexterm>

	      <para>ahol a <replaceable>port</replaceable> a soros porthoz
		tartozó eszközleíró neve
		(<literal>ttyd0</literal>, <literal>ttyd1</literal>,
		stb.), a <replaceable>bps</replaceable> a
		nyomtató által használt
		adatátviteli sebesség, végül a
		<replaceable>paritás</replaceable> a
		nyomtatóhoz használt paritás (ami
		lehet <literal>even</literal> (páros),
		<literal>odd</literal> (páratlan),
		<literal>none</literal> (nincs), vagy
		<literal>zero</literal> (nulla)).</para>

	      <para>Íme egy olyan soros nyomtató
		beállítása
		(<literal>printer</literal> néven), amely
		sebessége 19&nbsp;200&nbsp;bps, a harmadik portra
		csatlakozik és nem használ
		paritást:</para>

	      <programlisting>printer:dv=<filename>/dev/ttyd2</filename>:br#19200:pa=none</programlisting>
	    </step>

	    <step>
	      <para>Kapcsolódjunk a nyomtatóhoz a
		&man.tip.1; segítségével.  Ennek
		parancsa:</para>

	      <screen>&prompt.root; <userinput>tip printer</userinput></screen>

	      <para>Ha az iménti lépés nem
		mûködne, próbálkozzunk az
		<filename>/etc/remote</filename> állomány
		újbóli
		módosításával, és a
		<filename>/dev/cuaaN</filename>
		eszköz helyett használjuk a <filename>/dev/ttydN</filename>
		eszközt!</para>
	    </step>

	    <step>
	      <para>Küldjünk adatot a
		nyomtatónak.</para>

	      <itemizedlist>
		<listitem>
		  <para>Ha a nyomtató képes nyers
		    szöveget nyomtatni, akkor használjuk az
		    &man.lptest.1; segédprogramot.
		    Gépeljük be:</para>

		  <screen>&prompt.user; <userinput>$lptest</userinput></screen>
		</listitem>

		<listitem>
		  <para>Ha a nyomtató a &postscript; vagy egy
		    hozzá hasonló nyomtatási
		    nyelven kommunikál, akkor a
		    nyomtatónak egy rövid programot kell
		    küldenünk.  Soronként
		    gépeljük be a programot, azonban
		    <emphasis>vigyázzunk</emphasis> arra, hogy a
		    törlés és minden más
		    szerkesztésre használt billentyû
		    a nyomtató számára is
		    értelmes lehet.  Az is elõfordulhat,
		    hogy a program küldését egy
		    speciális jelsorozattal tudjuk csak
		    lezárni.  A &postscript; nyomtatók
		    esetén ilyenkor elegendõ a <keycombo action="simul"><keycap>Ctrl</keycap>
		    <keycap>D</keycap></keycombo> billentyûk
		    együttes lenyomása.</para>

		  <para>Vagy tehetjük az egész programot egy
		    állományba, amihez aztán
		    írjuk be ezt:</para>

		  <screen>&prompt.user; <userinput>&gt;állomány</userinput></screen>

		  <para>ahol az
		    <replaceable>állomány</replaceable> a
		    programot tartalmazó állomány
		    neve.  Miután a &man.tip.1; elküldte az
		    állományt, nyomjuk le a
		    lezáráshoz szükséges
		    billentyûkombinációt.</para>
		</listitem>
	      </itemizedlist>
	    </step>
	  </procedure>

	  <para>Most már meg kellene jelennie valaminek a
	    nyomtatón.  Az még nem számít,
	    pontosan mi is lesz az &mdash; késõbb még
	    majd úgyis beállítjuk.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="printing-printcap">
	<title>A nyomtatási rendszer aktiválása: a
	  <filename>/etc/printcap</filename>
	  állomány</title>

	<para>Csatlakoztattuk a nyomtatónkat, a
	  mûködtetéséhez
	  beállítottuk a rendszermagot (amennyiben erre
	  szükségünk volt), és tudtunk neki
	  adatokat küldeni.  Most már készen
	  állunk arra, hogy <application>LDP</application>
	  alkalmazáson keresztül beállítsuk a
	  nyomtató hozzáférésének
	  vezérlését.</para>

	<para>Az <application>LPD</application>
	  beállításait az
	  <filename>/etc/printcap</filename> állományban
	  találjuk.  Az <application>LPD</application>
	  nyomtatási rendszer minden egyes mûvelet
	  elõtt beolvassa ezt az állományt,
	  ezért a benne végzett
	  módosítások szinte azonnal életbe
	  is lépnek.</para>

	<indexterm>
	  <primary>nyomtató</primary>
	  <secondary>tulajdonságai</secondary>
  </indexterm>

	<para>A &man.printcap.5; tartalma könnyen
	  érthetõ, a <filename>/etc/printcap</filename>
	  állományt egyszerûen
	  módosíthatjuk a kedvenc
	  szövegszerkesztõnkkel.  A
	  felépítése teljesen megegyezik a
	  többi hozzá hasonló
	  állományéval: ilyenek
	  például a
	  <filename>/usr/share/misc/termcap</filename> és a
	  <filename>/etc/remote</filename>.  Az itt alkalmazott
	  formátum teljes leírását a
	  &man.cgetent.3; man oldalon találjuk.</para>

	<para>A nyomtatási rendszer egyszerû
	  beállítása az alábbi
	  lépésekbõl áll:</para>

	<procedure>
	  <step>
	    <para>Adjunk nevet (és még
	      néhány álnevet) a nyomtatónak,
	      írjuk ezeket az <filename>/etc/printcap</filename>
	      állományba.  A nevekrõl <link linkend="printing-naming">A nyomtató
		elnevezése</link> címû szakaszban
	      kapunk felvilágosítást.</para>
	  </step>

	  <step>
	    <indexterm><primary>fejléclapok</primary></indexterm>

	    <para>A(z alapból bekapcsolt) fejléclapokat az
	      <literal>sh</literal> tulajdonság
	      megadásával kapcsolhatjuk ki.  A
	      részleteket <link linkend="printing-no-header-pages">A fejléclapok
		letiltása</link> címû szakaszban
	      találjuk.</para>
	  </step>

	  <step>
	    <para>Hozzunk létre egy nyomtatási
	      könyvtárat, és adjuk meg a
	      helyét az <literal>sd</literal> tulajdonság
	      beállításával.  <link linkend="printing-spooldir">A nyomtatási
		könyvtár létrehozása</link>
	      címû szakaszban fogunk errõl többet
	      mondani.</para>
	  </step>

	  <step>
	    <para>Állítsunk be egy nyomtató
	      által használt <filename>/dev</filename> könyvtárbeli
	      leírót, és az <literal>lp</literal>
	      tulajdonsággal adjuk meg az
	      <filename>/etc/printcap</filename>
	      állományban.  Errõl
	      részletesebben <link linkend="printing-device">A
		nyomtatóeszköz
		azonosítása</link> címû
	      szakaszban olvashatunk.  Ha a nyomtató soros porton
	      keresztül csatlakozik, az <literal>ms#</literal>
	      tulajdonsággal még meg kell adnunk <link linkend="printing-commparam">A nyomtatási rendszer
		kommunikációs paraméterei</link>
	      szakaszban tárgyaltakat is.</para>
	  </step>

	  <step>
	    <para>Helyezzünk el egy szûrõt a
	      beérkezõ nyers szövegek
	      számára.  Errõl <link linkend="printing-textfilter">A szövegszûrõ
		telepítése</link> címû szakasz
	      értekezik.</para>
	  </step>

	  <step>
	    <para>Az &man.lpr.1; parancs
	      segítségével próbáljuk
	      ki a nyomtatást.  Ennek pontos részleteit a
	      <link linkend="printing-trying">Próbáljuk
		ki!</link> és a <link linkend="printing-troubleshooting">Hibakeresés</link>
	      címû fejezetekben találhatjuk
	      meg.</para>
	  </step>
	</procedure>

	<note>
	  <para>A magasabb szintû nyomtatók, mint
	    például a &postscript; nyomtatók nem
	    képesek közvetlenül nyers szöveget
	    nyomtatni.  Az imént felvázolt egyszerû
	    beállítási séma
	    feltételezi, hogy csak olyan
	    állományokat fogunk nyomtatni a
	    nyomtatón, amelyeket meg is ért.</para>
	</note>

	<para>A felhasználók gyakran arra
	  számítanak, hogy bármelyik általuk
	  elérhetõ nyomtatón képesek nyers
	  szöveget kinyomtatni.  Az <application>LPD</application>
	  alkalmazással kapcsolatban álló programok
	  is általában ugyanezt az elgondolást
	  követik.  Ha egy saját nyelvvel rendelkezõ
	  nyomtatót akarunk telepíteni, de a
	  nyomtató saját nyelvén
	  <emphasis>és</emphasis> a nyers szöveg
	  formájában érkezõ nyomtatási
	  feladatok is rendesen ki akarjuk nyomtatni, akkor
	  mindenképpen javasoljuk, hogy illeszünk még
	  egy további lépést is ebbe a sorba:
	  illesszünk a rendszerbe egy nyers szövegrõl
	  automatikusan &postscript; (vagy más egyéb)
	  nyelvre tolmácsoló programot.  Errõl a
	  <link linkend="printing-advanced-if-conversion">Szöveges
	    nyomtatási feladatok &postscript;
	    nyomtatókon</link> címû fejezetben
	  olvashatunk.</para>

	<sect4 xml:id="printing-naming">
	  <title>A nyomtató elnevezése</title>

	  <para>Az elsõ (egyszerû) lépés a
	    nyomtatónk nevének kiválasztása.
	    Igazából nem számít, mennyire
	    kifejezõ vagy éppen hóbortos nevet adunk
	    neki, hiszen emellett még számos
	    álnévvel is illethetjük.</para>

	  <para>Az <filename>/etc/printcap</filename>
	    állományban megtalálható
	    nyomtatók egyikének legalább az
	    <literal>lp</literal> álnévvel rendelkeznie
	    kell, mivel ez lesz az alapértelmezett
	    nyomtató neve.  Tehát ha a
	    felhasználó nem adja meg sem a
	    <envar>PRINTER</envar> környezeti
	    változót, sem pedig az
	    <application>LPD</application>-vel kapcsolatban
	    álló aktuális parancsban a
	    használni kívánt nyomtató
	    nevét, akkor a rendszer az <literal>lp</literal>
	    nevût fogja keresni.</para>

	  <para>Ezenkívül általában még
	    gyakran adnak egy olyan álnevet is a
	    nyomtatónak, ahol annak teljes leírása,
	    többek közt a gyártmánya és a
	    típusa szerepel.</para>

	  <para>Ahogy sikerült nevet és álneveket
	    adni a nyomtatónak, írjuk is be ezeket az
	    <filename>/etc/printcap</filename> állományba.
	    Itt a nyomtató neveit balról  kezdjük
	    felsorolni, mindegyik álnevet egy
	    függõleges vonallal válasszunk el,
	    és az utolsó után tegyünk
	    pontosvesszõt.</para>

	  <para>A most következõ példában egy
	    olyan vázt mutatunk be az
	    <filename>/etc/printcap</filename>
	    állományhoz, amelyben két
	    nyomtatót (egy Diablo 630
	    márkájú sornyomtatót és
	    egy Panasonic KX-P4455 típusú &postscript;
	    lézernyomtatót) adunk meg:</para>

	  <programlisting>#
#  /etc/printcap (rose)
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</programlisting>

	  <para>Ebben a példában az elsõ
	    nyomtató neve <literal>rattan</literal>, és
	    ehhez tartozik még a <literal>line</literal>,
	    <literal>diablo</literal>, <literal>lp</literal>, és
	    <literal>Diablo 630 Line Printer</literal>
	    álnév.  Mivel itt soroltuk fel az
	    <literal>lp</literal> álnevet is, ezért a
	    rendszerben ez lesz az alapértelmezett
	    nyomtató.  A második nyomtató neve
	    <literal>bamboo</literal>, és álnevei
	    többek közt a <literal>ps</literal>,
	    <literal>PS</literal>, <literal>S</literal>,
	    <literal>panasonic</literal>, valamint a <literal>Panasonic
	    KX-P4455 PostScript v51.4</literal>.</para>
	</sect4>

	<sect4 xml:id="printing-no-header-pages">
	  <title>A fejléclapok letiltása</title>

	  <indexterm>
	    <primary>nyomtatás</primary>
	    <secondary>fejléclapok</secondary>
	  </indexterm>

	  <para>Az <application>LPD</application> nyomtatási
	    rendszer alapértelmezés szerint minden egyes
	    feladathoz <emphasis>fejléclapot</emphasis>
	    készít.  Ez a lap szép nagy
	    betûkkel tartalmazza a nyomtatási feladatot
	    kiadó felhasználó nevét, a
	    gépet, amirõl küldték, és a
	    feladat nevét.  Sajnálatos módon ez
	    azonban inkább akadályozza a
	    hibakeresést a nyomtató
	    beállításában, ezért most
	    inkább kapcsoljuk ki ezeket.</para>

	  <para>Ha le akarjuk tiltani a fejléclapokat, az
	    <filename>/etc/printcap</filename> állományban
	    adjuk meg az <literal>sh</literal> (úgymint
	    <quote>suppress header pages</quote>) tulajdonságot.
	    Íme egy példa az <literal>sh</literal>
	    tulajdonsággal bõvített
	    <filename>/etc/printcap</filename>
	    állományra:</para>

	  <programlisting>#
#  /etc/printcap (rose) - sehol sem lesznek fejléclapok
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</programlisting>

	  <para>Ebben a példában megfigyelhetjük a
	    helyes felírási módot: az elsõ sor
	    a bal szélsõ oszlopban kezdõdik, az azt
	    követõ sorok pedig bentebb.  Minden
	    bejegyzésben az utolsó
	    kivételével mindegyik sor egy visszaper
	    (backslash) karakterrel zárul.</para>

	</sect4>

	<sect4 xml:id="printing-spooldir">
	  <title>A nyomtatási könyvtár
	    létrehozása</title>

	  <indexterm><primary>nyomtatási
	    rendszer</primary></indexterm>
	  <indexterm><primary>nyomtatási
	    feladatok</primary></indexterm>

	  <para>A nyomtatási rendszerünk
	    beállításának
	    következõ lépése a
	    <emphasis>nyomtatási könyvtár</emphasis>
	    létrehozása.  Ez egy olyan
	    könyvtár, ahová a
	    különbözõ nyomtatási feladatok
	    kerülnek a feldolgozásuk elõtt, valamint
	    ahol a nyomtatási rendszer többi
	    állománya lakozik.</para>

	  <para>A nyomtatási rendszer adatait
	    tároló könyvtárakat tartalmuk
	    gyakori változása miatt
	    általában a <filename>/var/spool</filename>
	    könyvtárba szokás tenni.  Ezen
	    könyvtárak tartalmát nem
	    szükséges menteni sem.  Az &man.mkdir.1; parancs
	    futtatásával egyszerûen újra
	    létre tudjuk hozni.</para>

	  <para>Általában minden nyomtatóhoz
	    külön létre szoktak hozni egy
	    könyvtárat az adott nyomtató
	    nevén.  Erre példa:</para>

	  <screen>&prompt.root; <userinput>mkdir /var/spool/nyomtatónév</userinput></screen>

	  <para>Azonban ha a hálózatunkon rengeteg
	    nyomtató található, akkor
	    érdemes inkább egyetlen könyvtárat
	    használni, amelyet az <application>LPD</application>
	    számára tartunk fenn.</para>

	  <screen>&prompt.root; <userinput>mkdir /var/spool/lpd</userinput>
&prompt.root; <userinput>mkdir /var/spool/lpd/rattan</userinput>
&prompt.root; <userinput>mkdir /var/spool/lpd/bamboo</userinput></screen>

	  <note>
	    <para>Amennyiben fontos nekünk a
	      felhasználói nyomtatások
	      titkosságának megóvása,
	      érdemes levédenünk a nyomtatási
	      könyvtárat, így az nem lesz mindenki
	      által elérhetõ.  A nyomtatási
	      könyvtárak tulajdonosa egyedül és
	      kizárólag a <systemitem class="username">daemon</systemitem>
	      felhasználó és a
	      <systemitem class="groupname">daemon</systemitem> csoport legyen, és
	      hozzá olvasási, írási
	      és keresési engedélyekkel
	      rendelkezzen.  Ezt fogjuk most beállítani a
	      példáinkban szereplõ
	      nyomtatóinkhoz is:</para>

	    <screen>&prompt.root; <userinput>chown daemon:daemon /var/spool/lpd/rattan</userinput>
&prompt.root; <userinput>chown daemon:daemon /var/spool/lpd/bamboo</userinput>
&prompt.root; <userinput>chmod 770 /var/spool/lpd/rattan</userinput>
&prompt.root; <userinput>chmod 770 /var/spool/lpd/bamboo</userinput></screen>
	  </note>

	  <para>Végezetül az
	    <filename>/etc/printcap</filename> állományban
	    ezeket a könyvtárakat se felejtsük el
	    megadni az <application>LPD</application>-nek.  Itt a
	    nyomtatási könyvtár nevét az
	    <literal>sd</literal> tulajdonsággal írjuk
	    le:</para>

	  <programlisting>#
#  /etc/printcap (rose) - a nyomtatási könyvtárak hozzáadása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:</programlisting>

	  <para>Vegyük észre, hogy a nyomtató neve
	    ugyan a sor elején kezdõdik, azonban a
	    hozzá tartozó összes többi sor mind
	    bentebb kezdõdik és egy visszaper (backslash)
	    karakterrel választjuk le.</para>

	  <para>Ha az <literal>sd</literal> tulajdonsággal nem
	    adunk meg semmilyen nyomtatási
	    könyvtárat, akkor ennek az értéke
	    alapértelmezés szerint a <filename>/var/spool/lpd</filename> lesz.</para>

	</sect4>

	<sect4 xml:id="printing-device">
	  <title>A nyomtatóeszköz
	    azonosítása</title>

	  <para>A <link linkend="printing-hardware">Hardveres beállítás</link>
	    címû szakaszban már
	    beazonosítottuk, hogy a &os; a <filename>/dev</filename> könyvtárban
	    melyik eszközleírón keresztül fogja
	    megszólítani a nyomtatót.  Most ideje
	    ugyanezt tudatni az <application>LPD</application>
	    démonnal is.  Így amikor a nyomtatási
	    rendszer végre szeretne hajtani egy nyomtatási
	    feladatot, a szûrõprogram nevében ezt az
	    eszközt nyitja meg (ahol a szûrõn
	    keresztül továbbítjuk az adatokat a
	    nyomtató felé).</para>

	  <para>Az <literal>lp</literal> tulajdonság
	    segítségével a
	    <filename>/etc/printcap</filename> állományban
	    soroljuk fel a nyomtatók <filename>/dev</filename> könyvtárban
	    található leíróit.</para>

	  <para>Az eddig használt példánkban most
	    tételezzük fel, hogy a <literal>rattan</literal>
	    nevû nyomtató az elsõ párhuzamos
	    porton található, míg a
	    <literal>bamboo</literal> nevû a hatodik soros porton.
	    Ebben a helyzetben így kellene
	    kiegészítenünk az
	    <filename>/etc/printcap</filename>
	    állományunkat:</para>

	  <programlisting>#
#  /etc/printcap (rose) - a használni kívánt eszközök
#  beazonosítása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:\
        :lp=<filename>/dev/ttyd5</filename>:</programlisting>

	  <para>Az <application>LPD</application>
	    alapértelmezés szerint a <filename>/dev/lp</filename> eszközt fogja
	    használni, ha nem adjuk meg az <literal>lp</literal>
	    tulajdonságot az <filename>/etc/printcap</filename>
	    állományban.  A <filename>/dev/lp</filename> azonban a &os;-ben
	    jelenleg nem létezik.</para>

	  <para>Ha a telepítendõ nyomtatónk
	    valamelyik párhuzamos portra csatlakozik, akkor innen
	    akár tovább is léphetünk <link linkend="printing-textfilter">A szövegszûrõ
	      telepítése</link> címû szakaszra.
	    Ha viszont nem, kövessük a most
	    következõ szakaszban szereplõ
	    utasításokat.</para>

	</sect4>

	<sect4 xml:id="printing-commparam">
	  <title>A nyomtatási rendszer
	    kommunikációs paraméterei</title>

	  <indexterm>
	    <primary>nyomtató</primary>
	    <secondary>soros</secondary>
	  </indexterm>

	  <para>A soros portra csatlakozó
	    nyomtatóknál az <application>LPD</application>
	    képes beállítani az adatátviteli
	    sebességet, a paritást, valamint más
	    egyéb olyan kommunikációs
	    paramétereket, amelyekkel a szûrõprogram
	    adatokat tud továbbítani a nyomtató
	    felé.  Ez több szempontból is
	    elõnyös, mivel:</para>

	  <itemizedlist>
	    <listitem>
	      <para>Egyszerûen az
		<filename>/etc/printcap</filename>
		állomány
		átírásával ki tudunk
		próbálni több
		kommunikációs
		beállítást, nem kell magát a
		szûrõprogramot
		újrafordítanunk.</para>
	    </listitem>

	    <listitem>
	      <para>A nyomtatási rendszer képes ugyanazt a
		szûrõt több,
		különbözõ
		kommunikációs
		beállítást alkalmazó
		nyomtatóhoz is használni.</para>
	    </listitem>
	  </itemizedlist>

	  <para>Az <filename>/etc/printcap</filename>
	    állományban az <literal>lp</literal>
	    tulajdonsággal megadott eszközök soros
	    kommunikációjának
	    beállításait az alábbi
	    tulajdonságok határozzák meg:</para>

	  <variablelist>
	    <varlistentry>
	      <term><literal>br#sebesség</literal></term>
	      <listitem>
		<para>Beállítja az eszköz
		  adatátviteli sebességét a
		  <replaceable>sebesség</replaceable>
		  értékre, ahol a
		  <replaceable>sebesség</replaceable> lehet 50,
		  75, 110, 134, 150, 200, 300, 600, 1200, 1800, 2400,
		  4800, 9600, 19&nbsp;200, 38&nbsp;400, 57&nbsp;600 vagy
		  115&nbsp;200 bit másodpercenként
		  (bps).</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term><literal>ms#stty-mód</literal></term>
	      <listitem>
		<para>Beállítja az eszköz
		  megnyitása után használt
		  termináleszköz
		  mûködésének
		  paramétereit.  Az &man.stty.1; man oldalon
		  többet is megtudhatunk róluk.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Miután az <application>LPD</application>
	    megnyitja az <literal>lp</literal> tulajdonsággal
	    megadott eszközt, beállítja az
	    <literal>ms#</literal> tulajdonság
	    értéke szerint annak jellemzõit.  Itt a
	    <literal>parenb</literal>, <literal>parodd</literal>,
	    <literal>cs5</literal>, <literal>cs6</literal>,
	    <literal>cs7</literal>, <literal>cs8</literal>,
	    <literal>cstopb</literal>, <literal>crtscts</literal>,
	    és <literal>ixon</literal> módok lehetnek
	    lényegesek, melyekrõl az &man.stty.1; man
	    oldalon többet is megtudhatunk.</para>

	  <para>Állítsuk most be az egyik
	    képzeletbeli nyomtatónkat a hatodik soros
	    portra.  Az adatátviteli sebessége 38&nbsp;400
	    bps lesz.  A kommunikáció
	    módjánál kapcsoljuk ki a
	    paritást (<literal>-parenb</literal>), 8&nbsp;bites
	    karakterek legyenek (<literal>cs8</literal>), ne legyen
	    modemes vezérlés (<literal>clocal</literal>)
	    és a hardveres forgalomirányítás
	    legyen <literal>crtscts</literal>:</para>

	  <programlisting>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:</programlisting>

	</sect4>

	<sect4 xml:id="printing-textfilter">
	  <title>A szövegszûrõ
	    telepítése</title>

	  <indexterm>
	    <primary>nyomtatás</primary>
	    <secondary>szûrõk</secondary>
	  </indexterm>

	  <para>Most már utasíthatjuk az
	    <application>LPD</application>-t, hogy milyen
	    szövegszûrõt használjon a
	    nyomtatási feladatok eszközre
	    küldéséhez.  A
	    <emphasis>szövegszûrõ</emphasis> (text
	    filter), vagy más néven <emphasis>bemeneti
	    szûrõ</emphasis> (input filter) egy olyan program,
	    amelyet az <application>LPD</application> egy
	    nyomtatási feladat elvégzésekor
	    lefuttat.  Amikor az <application>LPD</application>
	    lefuttatja a nyomtatóhoz tartozó
	    szövegszûrõt, a szûrõ
	    szabványos bemenetére elküldi az
	    elvégzendõ nyomtatási feladatot,
	    és a szabványos kimenetét pedig
	    átirányítja az <literal>lp</literal>
	    tulajdonság által megadott
	    nyomtatóeszközre.  Ennek megfelelõen a
	    szûrõnek a szabványos bemenetrõl kell
	    olvasnia az elvégzendõ feladatot, a
	    szabványos kimenetre pedig a ténylegesen
	    nyomtatandót kell kiírnia.  A
	    szövegszûrõk részleteirõl a <link linkend="printing-advanced-filters">Hogyan
	      mûködnek a szûrõk?</link> szakasz
	    szól.</para>

	  <para>A mi esetünkben most szövegszûrõnek
	    tökéletesen megfelel egy olyan rövid
	    szkript, ami a nyomtatóra a nyomtatási
	    feladatot a <command>/bin/cat</command> paranccsal
	    küldi ki.  A &os;-ben még találhatunk egy
	    másik szûrõt is, amelynek a neve
	    <filename>lpf</filename>.  Ez képes a
	    törlést és aláhúzást
	    jelzõ karaktereket érthetõvé tenni
	    bizonyos nyomtatók számára.
	    Természetesen itt használhatunk kedvünk
	    szerinti szûrõt is.  Az <command>lpf</command>
	    szûrõ mûködésének
	    részleteit <link linkend="printing-advanced-lpf">Az
	      lpf szövegszûrõ</link> címû
	    szakaszban fejtjük ki bõvebben.</para>

	  <para>Elõször is készítsünk egy
	    <filename>/usr/local/libexec/if-simple</filename> nevû
	    egyszerû szövegszûrõ szkriptet.  A
	    kedvenc szövegszerkesztõnkkel írjuk bele a
	    következõ sorokat:</para>

	  <programlisting>#!/bin/sh
#
# if-simple - egyszerû szövegszûrõ szkript az lpd-hez
# Helye: /usr/local/libexec/if-simple
#
# Egyszerûen átmásolja a kimenetére a bemenetérõl érkezõ adatokat; nem
# fogad el semmilyen paramétert.

/bin/cat &amp;&amp; exit 0
exit 2</programlisting>

	  <para>Tegyük indíthatóvá:</para>

	  <screen>&prompt.root; <userinput>chmod 555 /usr/local/libexec/if-simple</userinput></screen>

	  <para>Ezután tájékoztassuk róla az
	    <application>LPD</application>-t az
	    <filename>/etc/printcap</filename> állományban
	    található <literal>if</literal>
	    tulajdonság megadásával.  Itt most a
	    példánkban szereplõ mind a két
	    nyomtatóhoz beillesztjük:</para>

	  <programlisting>#
#  /etc/printcap (rose) - a szövegszûrõ hozzáadása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:</programlisting>

	  <note>
	    <para>Az <filename>if-simple</filename> szkript
	      megtalálható a <filename>/usr/share/examples/printing</filename>
	      könyvtárban.</para>
	  </note>

	</sect4>

	<sect4>
	  <title>Az <application>LPD</application>
	    elindítása</title>

	  <para>Az &man.lpd.8; az <filename>/etc/rc</filename>
	    szkriptbõl, az <literal>lpd_enable</literal>
	    változó értékének
	    megfelelõen indul el.  Ennek értéke
	    alapból <literal>NO</literal>, vagyis nem.  Ha eddig
	    még nem tettük volna meg, akkor az
	    <filename>/etc/rc.conf</filename> állományba
	    most vegyük fel a következõ sort:</para>

	  <programlisting>lpd_enable="YES"</programlisting>

	  <para>Ezután vagy indítsuk újra a
	    számítógépünket, vagy pedig
	    adjuk ki az &man.lpd.8; parancsot:</para>

	  <screen>&prompt.root; <userinput>lpd</userinput></screen>

	</sect4>

	<sect4 xml:id="printing-trying">
	  <title>Próbáljuk ki!</title>

	  <para>Elérkeztünk az
	    <application>LPD</application> egyszerû
	    beállításának utolsó
	    lépéséhez.  Sajnos azonban még
	    nem gratulálhatunk, hiszen hátra van
	    még a nyomtató
	    kipróbálása és az esetlegesen
	    elõforduló hibák
	    kijavítása.  A beállítást
	    úgy tudjuk a legegyszerûbben letesztelni, ha
	    megpróbálunk valamit kinyomtatni.  Az
	    <application>LPD</application> rendszerben az &man.lpr.1;
	    parancs használatával tudunk nyomtatási
	    feladatokat kiadni.</para>

	  <para><link linkend="printing-testing">A
	      kommunikáció ellenõrzése</link>
	    címû szakaszban megtalálhatjuk, hogy
	    hozzunk létre tesztelésre alkalmas
	    szövegeket az &man.lpr.1; és az &man.lptest.1;
	    programok segítségével.</para>

	  <para><emphasis>Az <application>LPD</application>
	    beállításainak egyszerû
	    tesztelése:</emphasis></para>

	  <para>Írjuk be:</para>

	  <screen>&prompt.root; <userinput>lptest 20 5 | lpr -Pnyomtatónév</userinput></screen>

	  <para>ahol a
	    <replaceable>nyomtatónév</replaceable> az
	    <filename>/etc/printcap</filename> állományban
	    megadott egyik nyomtató neve (vagy álneve)
	    lehet.  Az alapértelmezett nyomtató
	    kipróbálásához ne adjunk meg az
	    &man.lpr.1; parancsnak semmilyen <option>-P</option>
	    paramétert.  Még egyszer
	    megemlítenénk, hogy amennyiben &postscript;
	    nyomtatót tesztelünk, az elõbbi helyett az
	    &man.lptest.1; paranccsal küldjünk ki egy
	    &postscript; programot.  Ehhez tegyük a tesztelõ
	    programunkat egy állományba, majd írjuk
	    be az <command>lpr
	    állománynév</command>
	    parancsot.</para>

	  <para>A &postscript; nyomtató esetén a
	    kiküldött program eredményét kell
	    látnunk.  Amennyiben az &man.lptest.1; parancsot
	    használjuk, valami ilyesmire kell
	    számítanunk:</para>

	  <screen>!"#$%&amp;'()*+,-./01234
"#$%&amp;'()*+,-./012345
#$%&amp;'()*+,-./0123456
$%&amp;'()*+,-./01234567
%&amp;'()*+,-./012345678</screen>

	  <para>A nyomtató kimerítõbb
	    teszteléséhez próbáljunk meg
	    nagyobb programokat keríteni valahonnan (ha a
	    nyomtatónk valamilyen nyelven kommunikál) vagy
	    adjunk meg az &man.lptest.1; parancsnak más
	    paramétereket.  Például az
	    <command>lptest 80 60</command> soronként 80
	    karaktert írat ki 60 sorban.</para>

	  <para>Amennyiben a nyomtató nem mûködne,
	    nézzük meg a <link linkend="printing-troubleshooting">Hibakeresés</link>hez
	    tartozó szakaszt.</para>
	</sect4>
      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="printing-advanced">
    <title>Magasszintû
      nyomtatóbeállítás</title>

    <para>Ebben a szakaszban olyan szûrõket mutatunk be,
      amelyek speciálisan formázott
      állományok, fejléclapok,
      hálózati nyomtatás, nyomtatási
      nyilvántartás vagy szabályozás
      esetén használhatóak.</para>

    <sect2 xml:id="printing-advanced-filter-intro">
      <title>Szûrõk</title>

      <indexterm>
	<primary>nyomtatás</primary>
	<secondary>szûrõk</secondary>
      </indexterm>

      <para>Noha az <application>LPD</application> képes
	hálózati protokollokat, nyomtatási sorokat,
	hozzáférést és sok minden más
	nyomtatási feladatot kezelni, a
	<emphasis>tényleges</emphasis> munka legnagyobb
	része a <emphasis>szûrõkben</emphasis> (filter)
	történik.  A szûrõk olyan programok,
	amelyek tartják a kapcsolatot a nyomtatóval
	és megbirkóznak annak
	eszközfüggõségeivel és
	különleges igényeivel.  Az egyszerû
	beállítás során egy primitív
	szövegszûrõt állítottunk be
	(lásd <link linkend="printing-textfilter">A
	  szövegszûrõ telepítése</link>)
	&mdash; ami annyira egyszerû, hogy szinte minden
	nyomtatón mûködnie kell.</para>

      <para>Azonban mindahhoz, hogy ki tudjuk használni a
	különbözõ átalakítási,
	nyilvántartási lehetõségeket, valamint
	a nyomtatók különlegességeit és
	egyebeit, meg kell értenünk a szûrõk
	pontos mûködését.  Az elõbb
	említett feladatok ugyanis teljesen a szûrõ
	kezében vannak.  Ezzel kapcsolatban azonban rossz
	hír, hogy ezeket a szûrõket
	<emphasis>nekünk</emphasis> kell megírnunk.  A
	jó hír ellenben az, hogy könnyen
	találunk ilyen szûrõket, vagy ha éppen
	nem lelnénk valamelyiket, akkor is gyorsan meg tudjuk
	ezeket írni.</para>

      <para>Sõt, a &os; alapból tartalmaz is egyet, amit a
	<filename>/usr/libexec/lpr/lpf</filename> helyen találunk
	meg, és sok olyan nyomtatóval képes
	együttmûködni, amelyek nyers szöveget tudnak
	nyomtatni.  (Kezeli az állományokban
	felbukkanó törléseket és
	tabulálásokat, valamint képes
	nyilvántartást vezetni, de semmi többet.)
	Rajta kívül még számos
	szûrõt és szûrõelemet is
	találhatunk a &os;
	Portgyûjteményében.</para>

      <para>Lássuk, mit tartogat számunkra ez a
	rész:</para>

      <itemizedlist>
	<listitem>
	  <para>A <link linkend="printing-advanced-filters">Hogyan
	      mûködnek a szûrõk?</link>
	    címû szakaszban megpróbálunk
	    egyfajta áttekintést adni a szûrõk
	    nyomtatási folyamatban betöltött
	    szerepérõl.  Mindenképpen érdemes
	    elolvasnunk ezt a szakaszt, mivel ebben derül ki, hogy
	    valójában mi is történik a
	    <quote>függöny mögött</quote>, vagyis
	    amikor az <application>LPD</application> használja
	    ezeket a szûrõket.  Ezzel a tudással el
	    tudjuk kerülni vagy éppen nyakon tudjuk
	    csípni azokat a problémákat, amelyek a
	    nyomtatóinkhoz telepített szûrõk
	    hozzáadása során
	    adódhatnak.</para>
	</listitem>

	<listitem>
	  <para>Az <application>LPD</application> alapból arra
	    számít, hogy minden nyomtató
	    képes nyers szöveget nyomtatni.  Ez gondot okoz
	    a &postscript; (és minden más nyelv
	    alapú) nyomtatók esetén, mivel azok nem
	    képesek nyers szöveget nyomtatni.  <link linkend="printing-advanced-if-conversion"> Szöveges
	      nyomtatási feladatok &postscript;
	      nyomtatókon</link> címû szakaszban
	    viszont fény derül rá, hogyan
	    kerekedjünk felül ezen.  Feltétlenül
	    olvassuk el, ha &postscript; nyomtatónk van.</para>
	</listitem>

	<listitem>
	  <para>A &postscript; számos program közkedvelt
	    kimeneti formátuma, sõt gyakran maguk a
	    felhasználók is szeretnek ilyen programokat
	    írni.  Sajnos azonban a &postscript; nyomtatók
	    egyáltalán nem olcsók.  A <link linkend="printing-advanced-ps">&postscript;
	      szimulációja nem &postscript;
	      nyomtatókon</link> címû szakaszban
	    megtudhatjuk, miképp tudjuk úgy
	    módosítani a szûrõt, hogy
	    <emphasis>nem &postscript;</emphasis> nyomtatókon is
	    tudjunk &postscript; programokkal nyomtatni.  Ezt a szakaszt
	    akkor érdemes elolvasni, ha nincs &postscript;
	    nyomtatónk.</para>
	</listitem>

	<listitem>
	  <para>A <link linkend="printing-advanced-convfilters">Konverziós szûrõk</link>
	    címû szakaszban eláruljuk, miként
	    lehetséges automatizálni a
	    különbözõ
	    állományformátumok és a
	    nyomtatók által érthetõ
	    formátumok közti konverziókat, legyen az
	    grafikus vagy betûszedésre vonatkozó
	    adat.  A szakasz elolvasása során
	    megismerjük, hogyan tudjuk a nyomtatónkat
	    képessé tenni az
	    <command>lpr -t</command> paranccsal troff
	    adatok, vagy a <command>lpr -d</command>
	    paranccsal a &tex; DVI állományainak, esetleg
	    az <command>lpr -v</command> paranccsal
	    raszteres képek nyomtatására és
	    így tovább.  Csak ajánlani tudjuk ennek
	    elolvasását.</para>
	</listitem>

	<listitem>
	  <para>A <link linkend="printing-advanced-of">Kimeneti
	      szûrõk</link> címû szakaszban
	    kivesézzük az <application>LPD</application>
	    egyik kevésbé használt
	    lehetõségét is, a kimeneti
	    szûrõket.  Hacsak nem fejléclapokat akarunk
	    készíteni (lásd <link linkend="printing-advanced-header-pages">Fejléclapok</link>),
	    akkor ezt a szakaszt nyugodtan kihagyhatjuk.</para>
	</listitem>

	<listitem>
	  <para><link linkend="printing-advanced-lpf">Az lpf
	      szövegszûrõ</link> szakaszban
	    bemutatásra kerül a &os;-ben alapból
	    megtalálható <command>lpf</command>
	    szûrõ, amely egy sornyomtatóknál
	    (vagy az így viselkedõ
	    lézernyomtatóknál)
	    használható egyszerû
	    szövegszûrõ.  Ha nyers szövegek
	    nyomtatásánál meg akarjuk oldani a
	    nyomtatási feladatok
	    nyilvántartását, vagy a
	    törlés karakter láttán a
	    nyomtatónk füstölni kezdene, akkor
	    mindenképpen érdemes belemerülnünk
	    az <command>lpf</command> titkaiba.</para>
	</listitem>
      </itemizedlist>

      <note>
	<para>A most következõ szkriptek mindegyike
	  megtalálható a <filename>/usr/share/examples/printing</filename>
	  könyvtárban.</para>
      </note>

      <sect3 xml:id="printing-advanced-filters">
	<title>Hogyan mûködnek a szûrõk?</title>

	<para>Ahogy már korábban is jeleztük, a
	  szûrõ egy olyan végrehajtható program,
	  amelyet az <application>LPD</application> indít el,
	  amikor a nyomtatóval eszközfüggetlen
	  módon kommunikál.</para>

	<para>Amikor az <application>LPD</application> egy feladat
	  elvégzése során ki akar nyomtatni egy
	  állományt, akkor elindít egy ilyen
	  szûrõprogramot.  A szûrõ szabványos
	  bemenetére elküldi a kinyomtatandó
	  állományt, a szabványos kimenetét
	  a nyomtatóra, a szabványos hibajelzéseit
	  pedig egy naplóállományba
	  irányítja (ez utóbbit az
	  <filename>/etc/printcap</filename> állományban
	  az <literal>lf</literal> tulajdonsággal adhatjuk meg,
	  vagy alapértelmezés szerinti a
	  <filename>/dev/console</filename> állományba
	  kerül).</para>

	<indexterm><primary><command>troff</command></primary></indexterm>

	<para>Az <application>LPD</application> a használni
	  kívánt szûrõt és annak
	  paramétereit az <filename>/etc/printcap</filename>
	  állományban felsoroltak vagy az &man.lpr.1;
	  parancssorában megadottak szerint választja ki.
	  Például, ha a felhasználó a
	  <command>lpr -t</command> parancsot adja ki,
	  akkor az <application>LPD</application> a
	  célként megadott nyomtatónál
	  szereplõ <literal>tf</literal> tulajdonság
	  által megadott troff szûrõt kezdi el
	  használni.  Amennyiben a felhasználó
	  egyszerûen csak nyers szöveget akar nyomtatni, akkor
	  az <literal>if</literal> szûrõnek kellene elindulnia
	  (ez viszont csak részben igaz: lásd <link linkend="printing-advanced-of">Kimeneti szûrõk</link>).
	  </para>

	<para>Háromfajta szûrõ jelenhet meg az
	  <filename>/etc/printcap</filename>
	  állományban:</para>

	<itemizedlist>
	  <listitem>
	    <para>A <emphasis>szövegszûrõ</emphasis>
	      (text filter), ami a hagyományos szöveges
	      nyomtatásért felelõs, és amit az
	      <application>LPD</application>
	      dokumentációjában érdekes
	      módon <emphasis>bemeneti
	      szûrõnek</emphasis> (input filter)
	      hívnak.  Mivel az <application>LPD</application>
	      arra számít, hogy minden nyomtató
	      alapból képes kinyomtatni bármilyen
	      nyers szöveget, ezért a
	      szövegszûrõ feladata, hogy a
	      nyomtató számára gondoskodjon a
	      tabulátorok, törlések és
	      más egyéb speciális karakterek
	      megfelelõ kezelésérõl.  Emellett
	      ha olyan helyen vagyunk, ahol szükség van a
	      nyomtatási feladatok
	      nyilvántartására is, a
	      szövegszûrõ ennek megoldására
	      is képes, méghozzá úgy, hogy
	      összeszámolja a kinyomtatott sorokat,
	      és elosztja ezeket a nyomtató által
	      oldalanként nyomtatott sorok
	      számával.  Egy szövegszûrõ a
	      következõ paraméterekkel indulhat:</para>

	    <cmdsynopsis>
	      <command>szûrõnév</command>
	      <arg>-c</arg>
	      <arg choice="plain">-w
	      <replaceable>szélesség</replaceable></arg>
	      <arg choice="plain">-l
	      <replaceable>hossz</replaceable></arg>
	      <arg choice="plain">-i
	      <replaceable>behúzás</replaceable></arg>
	      <arg choice="plain">-n
	      <replaceable>hozzáférés</replaceable></arg>
	      <arg choice="plain">-h
	      <replaceable>gépnév</replaceable></arg>
	      <arg choice="plain"><replaceable>nyilvántartás</replaceable></arg>
	    </cmdsynopsis>

	    <para>ahol a</para>

	    <variablelist>
	      <varlistentry>
		<term><option>-c</option></term>
		  <listitem>
		    <para>akkor jelenik meg, ha egy nyomtatási feladatot az
		      <command>lpr -l</command>
		      paranccsal adunk át</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>szélesség</replaceable></term>
		  <listitem>
		    <para>az <filename>/etc/printcap</filename>
		      állományban definiált
		      <literal>pw</literal> (page width, avagy
		      oldalszélesség) tulajdonság
		      értéke, ami
		      alapbeállítás szerint
		      132</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>hossz</replaceable></term>
		  <listitem>
		    <para>a <literal>pl</literal> (page length, avagy
		      oldalhossz) tulajdonság
		      értéke, amely az
		      alapbeállítás szerint
		      66</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>behúzás</replaceable></term>
		  <listitem>
		    <para>az <command>lpr -i</command>
		      parancs megadása során használt
		      behúzás mértéke, ami
		      alapból 0</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>hozzáférés</replaceable></term>
		  <listitem>
		    <para>a nyomtatást végzõ
		      felhasználó
		      hozzáférésének
		      megnevezése</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>gépnév</replaceable></term>
		  <listitem>
		    <para>a gép neve, amirõl a
		      nyomtatási feladat érkezett</para>
		  </listitem>
		</varlistentry>

		<varlistentry>
		  <term><replaceable>nyilvántartás</replaceable></term>
		  <listitem>
		    <para>ez a nyilvántartást
		      tároló állomány
		      <literal>af</literal> tulajdonsággal
		      definiált neve</para>
		  </listitem>
		</varlistentry>
	    </variablelist>
	  </listitem>

	  <listitem>
	    <indexterm>
	      <primary>nyomtatás</primary>
	      <secondary>szûrõk</secondary>
	    </indexterm>

	    <para>A <emphasis>konverziós
	      szûrõk</emphasis> (conversion filter) egy adott
	      állományformátumot hoznak a
	      nyomtató számára értelmes
	      formára.  Például ditroff adatok
	      közvetlenül ugyan nem nyomtathatóak,
	      azonban a ditroff állományokhoz tudunk
	      telepíteni egy olyan szûrõt, amely a
	      ditroff adatokat a nyomtató számára
	      is emészthetõ és nyomtatható
	      formájúvá teszi.  A <link linkend="printing-advanced-convfilters">Konverziós
		szûrõk</link> címû szakasz tud
	      ezekrõl többet mondani.  Ilyen esetekben
	      kérhetünk nyilvántartást.  A
	      konverziós szûrõk az alábbi
	      paraméterekkel indulhatnak:</para>

	    <cmdsynopsis>
	      <command>szûrõnév</command>
	      <arg choice="plain">-x
	      <replaceable>pixelszélesség</replaceable></arg>
	      <arg choice="plain">-y
	      <replaceable>pixelmagasság</replaceable></arg>
	      <arg choice="plain">-n
	      <replaceable>hozzáférés</replaceable></arg>
	      <arg choice="plain">-h
	      <replaceable>gépnév</replaceable></arg>
	      <arg choice="plain"><replaceable>nyilvántartás</replaceable></arg>
	    </cmdsynopsis>

	    <para>ahol a
	      <replaceable>pixelszélesség</replaceable> a
	      <literal>px</literal> tulajdonság
	      értékébõl (ami alapból
	      0), a <replaceable>pixelmagasság</replaceable> a
	      <literal>py</literal> tulajdonság
	      értékébõl (ami alapból
	      szintén 0) származik.</para>
	  </listitem>

	  <listitem>
	    <para>A <emphasis>kimeneti szûrõ</emphasis>
	      (output filter), ami csak akkor aktív, ha a
	      szövegszûrõ nem, vagy ha
	      engedélyeztük fejléclapok
	      nyomtatását.  Tapasztalatom szerint az ilyen
	      szûrõket ritkán használják.
	      A <link linkend="printing-advanced-of">Kimeneti
		szûrõk</link> címû szakasz mutatja
	      be a mûködésüket.  Ekkor
	      csupán két paraméterünk
	      van:</para>

	    <cmdsynopsis>
	      <command>szûrõnév</command>
	      <arg choice="plain">-w
	      <replaceable>szélesség</replaceable></arg>
	      <arg choice="plain">-l
	      <replaceable>hosszúság</replaceable></arg>
	    </cmdsynopsis>

	    <para>amik rendre megegyeznek a szövegszûrõk
	      <option>-w</option> és <option>-l</option>
	      paramétereivel.</para>
	  </listitem>
	</itemizedlist>

	<para>A szûrõk <emphasis>ki is tudnak
	  lépni</emphasis> a következõ kódokkal
	  (exit status):</para>

	<variablelist>
	  <varlistentry>
	    <term>0</term>
	    <listitem>
	      <para>A szûrõ sikeresen kinyomtatta az
		állományt.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>1</term>
	    <listitem>
	      <para>A szûrõnek nem sikerült kinyomtatnia
		az állományt, azonban szeretné, ha
		az <application>LPD</application> újból
		megpróbálkozna vele.  Az
		<application>LPD</application> tehát ebben
		 az esetben újraindítja a
		szûrõt.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>2</term>
	    <listitem>
	      <para>A szûrõnek nem sikerült kinyomtatnia
		az állományt, és nem is
		kívánja újra
		megpróbálni.  Ekkor az
		<application>LPD</application> eldobja az
		állományt.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>

	<para>A &os; kiadásokban megtalálható
	  <filename>/usr/libexec/lpr/lpf</filename>
	  szövegszûrõ képes a kapott
	  szélesség és hossz paraméterekkel
	  megállapítani az oldaltöréseket
	  és a nyomtató használatát
	  nyilvántartani, amihez a
	  hozzáférés, gépnév
	  és nyilvántartás adatait használja
	  fel.</para>

	<para>Amikor majd igyekszünk mellé újabb
	  szûrõket beszerezni, ne felejtsük el
	  ellenõrizni, hogy együtt tudnak-e mûködni
	  az <application>LPD</application>-vel.  Ha a válasz
	  igen, akkor a fentebb említett paraméterek
	  mindegyikét ismerniük kell.  Az
	  általános használatra készült
	  szûrõk készítése során
	  mi magunknak is be kell tartanunk ezeket az
	  elvárásokat.</para>

      </sect3>

      <sect3 xml:id="printing-advanced-if-conversion">
	<title>Szöveges nyomtatási feladatok &postscript;
	  nyomtatókon</title>

	<indexterm><primary>nyomtatsái
	  feladatok</primary></indexterm>

	<para>Ha csak egyedül dolgozunk a
	  számítógépen és
	  &postscript; (vagy bármilyen más nyelvet
	  ismerõ) nyomtatónk van, valamint
	  megígérjük, hogy soha nem küldünk
	  sem mi, sem pedig nem küldetünk semmilyen más
	  programmal nyers szöveget a nyomtatóra, akkor
	  átléphetjük ezt a szakaszt.</para>

	<para>Ha viszont egyaránt akarunk küldeni
	  &postscript; programot és nyers szöveget
	  tartalmazó nyomtatási feladatot a
	  nyomtatónak, akkor ehhez kénytelenek vagyunk a
	  rendszerünket beállítani.
	  Elõször is szükségünk van
	  szövegszûrõre, ami megállapítja,
	  hogy a frissen érkezett nyomtatási feladat nyers
	  szöveget vagy &postscript; programot tartalmaz-e.  Minden
	  &postscript;-alapú feladat a <literal>%!</literal>
	  karaktersorozattal kezdõdik (a többi esetben
	  olvassuk a nyomtató leírását).
	  Szóval, ha a nyomtatandó állomány
	  elsõ két karaktere ilyen, akkor egy &postscript;
	  programmal van dolgunk és közvetlenül
	  továbbküldhetjük a nyomtatási
	  feladatot a nyomtatónak.  Minden más esetben a
	  szûrõnek elõbb át kell alakítania
	  a szöveget &postscript; nyelvre.</para>

	<para>Hogyan érhetjük el mindezt?</para>

	<indexterm>
	  <primary>nyomtató</primary>
	  <secondary>soros</secondary>
	</indexterm>

	<para>Ha soros nyomtatónk van, akkor erre a feladatra az
	  <command>lprps</command> parancs tökéletes.  Az
	  <command>lprps</command> egy olyan &postscript;
	  szûrõ, amely mind a két irányban
	  képes közvetíteni.  Folyamatosan
	  rögzíti egy állományba a
	  nyomtató állapotát, így a
	  felhasználók és rendszergazdák
	  pontosan látják a nyomtató jelenlegi
	  állapotát (például
	  <errorname>toner low</errorname> (a toner hamarosan kifogy)
	  vagy <errorname>paper jam</errorname> (a papír
	  beragadt)).  Ami viszont sokkal lényegesebb, hogy a
	  <command>psif</command> nevû program képes
	  megmondani az érkezõ nyomtatási feladat
	  valódi típusát, és ennek
	  megfelelõen meg tudja hívni nyers szöveg
	  átalakítására a
	  <command>textps</command> (egy másik program, amit a
	  <command>lprps</command> mellé kapunk) parancsot.
	  Ezután az <command>lprps</command> elküldi a
	  feladatot a nyomtatónak.</para>

	<para>Az <command>lprps</command> a &os;
	  Portgyûjteményének része
	  (lásd <link linkend="ports">A
	  Portgyûjtemény</link>), ezért a
	  használni kívánt papír
	  méretétõl függõen pillanatok
	  alatt magunk is letölhetjük, fordíthatjuk
	  és telepíthetjük a <package>print/lprps-a4</package> és <package>print/lprps-letter</package> csomagok
	  valamelyikét.  Az <command>lprps</command>
	  telepítése után egyszerûen csak
	  adjuk meg a <command>psif</command> elérési
	  útvonalát.  Ha tehát
	  telepítettük a Portgyûjteménybõl
	  az <command>lprps</command> csomagot, akkor egy soros portra
	  csatlakozó &postscript; nyomtató esetén
	  ezt kell beírnunk az <filename>/etc/printcap</filename>
	  állományba:</para>

	<programlisting>:if=<filename>/usr/local/libexec/psif</filename>:</programlisting>

	<para>Ezenkívül még az <literal>rw</literal>
	  tulajdonsággal meg kell mondanunk az
	  <application>LPD</application>-nek, hogy a nyomtatót
	  írásra és olvasásra nyissa
	  meg.</para>

	<para>Amennyiben a &postscript; nyomtatónk a
	  párhuzamos porton csatlakozik (és amiért
	  a nyomtatónk nem képes az
	  <command>lprps</command> által igényelt
	  kétirányú kommunikációra),
	  szövegszûrõként a következõ
	  szkriptet fogjuk használni:</para>

	<programlisting>#!/bin/sh
#
#  psif - PostScript vagy nyers szöveg nyomtatása PostScript nyomtatón
#  Ez a szkriptes változat, NEM pedig az lprps-hez mellékelt szûrõ
#  (a /usr/local/libexec/psif állomány)!
#

IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  PostScript: nyomtassuk ki.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
else
    #
    #  Nyers szöveg: alakítsuk át, majd nyomtassuk ki.
    #
    ( echo "$first_line"; cat ) | /usr/local/bin/textps &amp;&amp; printf "\004" &amp;&amp; exit 0
    exit 2
fi</programlisting>

	<para>A fentebb szereplõ szkriptben a
	  <command>textps</command> programot használjuk a nyers
	  szövegek &postscript; programokra
	  alakításához, de helyette
	  bármilyen más konvertáló programot
	  is igénybe vehetünk.  A &os;
	  Portgyûjteményében (lásd <link linkend="ports"> A Portgyûjtemény</link>)
	  találhatunk erre a célra egy
	  <literal>a2ps</literal> nevû programot is, amit esetleg
	  érdemes lehet közelebbrõl
	  megnéznünk.</para>

      </sect3>

      <sect3 xml:id="printing-advanced-ps">
	<title>&postscript; szimulációja nem &postscript;
	  nyomtatókon</title>

	<indexterm>
	  <primary>PostScript</primary>
	  <secondary>emuláció</secondary>
	</indexterm>
	<indexterm><primary>Ghostscript</primary></indexterm>

	<para>A &postscript; a magas színvonalú
	  betûszedés és nyomtatás <emphasis>de
	  facto</emphasis> szabványa.  Emellett azonban a
	  &postscript; egy <emphasis>költséges</emphasis>
	  szabvány is.  Az Aladdin Enterprises-nak hála
	  azonban létezik egy hozzá hasonló szabad
	  szoftver, a <application>Ghostscript</application>, amely
	  képes &os;-n is futni.  A
	  <application>Ghostscript</application> képes a
	  legtöbb &postscript; állomány
	  olvasására, megjelenítésére
	  mindenféle eszközökön, beleértve
	  a &postscript;et nem ismerõ nyomtatókat is.  A
	  <application>Ghostscript</application> és egy
	  speciális szövegszûrõ
	  telepítésével el tudjuk érni, hogy
	  egy nem &postscript; nyomtató valódi
	  &postscript; nyomtatóként viselkedjen.</para>

	<para>Ha telepíteni szeretnénk, a
	  <application>Ghostscript</application>
	  megtalálható a &os;
	  Portgyûjteményében.  Innen tehát
	  magunk is könnyedén le tudjuk tölteni,
	  fordítani és telepíteni.</para>

	<para>A &postscript; nyomtatás
	  szimulációjához elõször egy
	  szûrõ segítségével észre
	  kell vennünk, hogy egy &postscript;
	  formátumú állományt
	  készülünk kinyomtatni.  Ha nem ilyen a
	  nyomtatási feladat, akkor egyenesen a nyomtatóra
	  küldjük, azonban minden más esetben
	  elõször a <application>Ghostscript</application>
	  segítségével átalakítjuk
	  egy olyan formátumba, amit a nyomtató is
	  képes feldolgozni.</para>

	<para>Nézzünk erre egy példát: a most
	  következõ szövegszûrõ a Hewlett
	  Packard DeskJet 500-as nyomtatóihoz
	  használható.  Más nyomtató
	  esetén cseréljük ki a <command>gs</command>
	  (<application>Ghostscript</application>) parancs
	  <option>-sDEVICE</option> paraméterét a neki
	  megfelelõre.  (A telepített
	  <application>Ghostscript</application> által ismert
	  nyomtatók listáját a
	  <command>gs -h</command> paranccsal
	  kérdezhetjük le.)</para>

	<programlisting>#!/bin/sh
#
#  ifhp - Ghostscripttel szimulált Postscript nyomtatás DeskJet 500-on
#  Helye: /usr/local/libexec/ifhp

#
#  LF karaktereket CR+LF-ként kezeljük (elkerülve ezzel a HP/PCL
#  nyomtatókon a "lépcsõzést"):
#
printf "\033&amp;k2G" || exit 2

#
#  Az állomány elsõ két karakterének beolvasása
#
IFS="" read -r first_line
first_two_chars=`expr "$first_line" : '\(..\)'`

if [ "$first_two_chars" = "%!" ]; then
    #
    #  Ez PostScript: küldjük át a Ghostscripten és nyomtassuk ki.
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
      -sOutputFile=- - &amp;&amp; exit 0
else
    #
    #  Nyers szöveg vagy HP/PCL, ezért küldjük át közvetlenül. Az utolsó
    #  lap kidobásához küldünk még egy lapdobást is.
    #
    echo "$first_line" &amp;&amp; cat &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
exit 0
fi

exit 2</programlisting>

	<para>Befejezésül az <literal>if</literal>
	  tulajdonságon keresztül
	  értesítenünk kell errõl a
	  szûrõrõl az <application>LPD</application>-t
	  is:</para>

	<programlisting>:if=<filename>/usr/local/libexec/ifhp</filename>:</programlisting>

	<para>Készen is vagyunk!  Most már nyugodtan
	  beírhatjuk, hogy
	  <command>lpr sima.szöveg</command>
	  vagy
	  <command>lpr akármi.ps</command>,
	  mind a kettõnek ki kell tudnia
	  nyomtatódnia.</para>

      </sect3>

      <sect3 xml:id="printing-advanced-convfilters">
	<title>Konverziós szûrõk</title>

	<para>Miután elvégeztük az <link linkend="printing-simple">Alacsonyszintû
	    nyomtatóbeállítás</link>
	  címû szakaszban leírt
	  beállításokat, a (nyers ASCII szöveg
	  mellett) kedvenc állományformátumainkhoz
	  is minden bizonnyal szeretnénk telepíteni
	  néhány konverziós
	  szûrõt.</para>

	<sect4>
	  <title>Miért használjunk konverziós
	    szûrõket?</title>

	  <indexterm>
	    <primary>&tex;</primary>
	    <secondary>DVI állományok
	      nyomtatása</secondary>
	  </indexterm>

	  <para>A konverziós szûrõk
	    segítségével állományok
	    mindenféle formátumait könnyen ki tudjuk
	    nyomtatni.  Például tegyük fel, hogy
	    sokat dolgozunk a &tex; betûszedõ rendszerrel
	    és egy &postscript; nyomtatónk van.  Minden
	    alkalommal, amikor egy DVI állományt hozunk
	    létre a &tex; forrásból, azt
	    közvetlenül még nem tudjuk a
	    nyomtatóra küldeni.  Ehhez a következõ
	    parancsokat kell kiadnunk:</para>

	  <screen>&prompt.user; <userinput>dvips hínár-elemzés.dvi</userinput>
&prompt.user; <userinput>lpr hínár-elemzés.ps</userinput></screen>

	  <para>Ha telepítünk egy konverziós
	    szûrõt a DVI állományokhoz, meg
	    tudjuk spórolni ezt a manuális
	    átalakítási lépést azzal,
	    hogy átadjuk ezt a feladatot az
	    <application>LPD</application>-nek.  Így
	    ezután mindig, amikor egy DVI állományt
	    akarunk kinyomtatni, csupán egyetlen
	    lépésre lesz
	    szükségünk:</para>

	  <screen>&prompt.user; <userinput>lpr -d hínár-elemzés.dvi</userinput></screen>

	  <para>Az <application>LPD</application>-nek a
	    <option>-d</option> paraméterrel adjuk meg, hogy a
	    nyomtatás elõtt hajtsa végre a DVI
	    átalakítását.  A <link linkend="printing-lpr-options-format">Formázási
	      és konverziós
	      beállítások</link> címû
	    szakaszban találjuk meg a többi
	    konverziós opciót.</para>

	  <para>Minden olyan konverziós
	    beállításhoz, amit használni
	    szeretnénk a nyomtatóval,
	    telepítenünk kell egy
	    <emphasis>konverziós szûrõt</emphasis>
	    (conversion filter) és meg kell adnunk a nevét
	    az <filename>/etc/printcap</filename>
	    állományban.  A konverziós
	    szûrõk az egyszerû
	    nyomtatóbeállításnál
	    szereplõ szövegszûrõkhöz
	    hasonlítanak (lásd <link linkend="printing-textfilter">A szövegszûrõ
	      telepítése</link> szakasz) azzal a
	    kivétellel, hogy a nyers szövegek
	    kinyomtatása helyett ezek a szûrõk a
	    nyomtató számára értelmes
	    formátumra alakítják az
	    állományokat.</para>

	</sect4>

	<sect4>
	  <title>Milyen konverziós szûrõket
	    érdemes telepíteni?</title>

	  <para>Olyan konverziós szûrõket
	    telepítsünk, amelyekre gyakran
	    szükségünk lehet.  Ha például
	    sok DVI adatot szeretnénk nyomtatni a
	    jövõben, akkor használjunk DVI
	    konverziós szûrõt, vagy ha sok troff
	    formátumú adatot nyomtatunk, akkor minden
	    bizonnyal jól fog jönni egy troff
	    szûrõ.</para>

	  <para>A következõ táblázat foglalja
	    össze azokat a szûrõket, amelyekkel az
	    <application>LPD</application> képes
	    együttmûködni.  Megtudhatjuk, hogy az
	    <filename>/etc/printcap</filename> állományban
	    melyik tulajdonság tartozik hozzájuk és
	    hogyan hívjuk meg ezeket az <command>lpr</command>
	    paranccsal:</para>

	  <informaltable frame="none" pgwide="1">
	    <tgroup cols="3">
	      <thead>
		<row>
		  <entry>Állománytípus</entry>
		  <entry>Tulajdonság az
		    <filename>/etc/printcap</filename>
		    állományban</entry>
		  <entry>Az <command>lpr</command>
		    kapcsolója</entry>
		</row>
	      </thead>
	      <tbody>
		<row>
		  <entry>cifplot</entry>
		  <entry><literal>cf</literal></entry>
		  <entry><option>-c</option></entry>
		</row>
		<row>
		  <entry>DVI</entry>
		  <entry><literal>df</literal></entry>
		  <entry><option>-d</option></entry>
		</row>
		<row>
		  <entry>plot</entry>
		  <entry><literal>gf</literal></entry>
		  <entry><option>-g</option></entry>
		</row>
		<row>
		  <entry>ditroff</entry>
		  <entry><literal>nf</literal></entry>
		  <entry><option>-n</option></entry>
		</row>
		<row>
		  <entry>FORTRAN forrás</entry>
		  <entry><literal>rf</literal></entry>
		  <entry><option>-f</option></entry>
		</row>
		<row>
		  <entry>troff</entry>
		  <entry><literal>tf</literal></entry>
		  <entry><option>-f</option></entry>
		</row>
		<row>
		  <entry>raster</entry>
		  <entry><literal>vf</literal></entry>
		  <entry><option>-v</option></entry>
		</row>
		<row>
		  <entry>nyers szöveg</entry>
		  <entry><literal>if</literal></entry>
		  <entry>nincs, <option>-p</option>, vagy
		    <option>-l</option></entry>
		</row>
	      </tbody>
	    </tgroup>
	  </informaltable>

	  <para>A példánkban tehát a
	    <command>lpr -d</command> parancs
	    használata arra utal, hogy a nyomtatónak az
	    <filename>/etc/printcap</filename>
	    állományból a <literal>df</literal>
	    tulajdonságára van
	    szüksége.</para>

	  <indexterm><primary>FORTRAN</primary></indexterm>

	  <para>Minden hadakozás ellenére
	    állíthatjuk, hogy a FORTRAN források
	    és a plot által használt szövegek
	    formátuma napjainkra már elavultnak
	    tekinthetõ.  Ezért ezekhez az opciókhoz a
	    saját szûrõinkkel tetszõleges
	    formázási lehetõségeket
	    rendelhetünk.  Például, ha Printerleaf
	    (az Interleaf asztali kiadványszerkesztõ
	    formátuma) állományokat
	    szeretnénk közvetlenül nyomtatni, akkor
	    valószínûleg nem lesz
	    szükségünk plot állományokra.
	    Ezért a <literal>gf</literal> tulajdonságnak
	    megadhatunk egy Printerleaf konverziós
	    szûrõt, amelyen keresztül aztán a
	    felhasználók az
	    <command>lpr -g</command> paranccsal
	    Printerleaf állományokat tudnak
	    nyomtatni.</para>

	</sect4>

	<sect4>
	  <title>Konverziós szûrõk
	    telepítése</title>

	  <para>Mivel a konverziós szûrõk az alap &os;
	    rendszeren kívülre kerülnek, ezért
	    ezeket minden valószínûség szerint
	    valahol a <filename>/usr/local</filename>
	    könyvtárban találjuk meg.  Ezen
	    belül is általában a
	    <filename>/usr/local/libexec</filename>
	    könyvtárban fordulnak elõ, mivel ezeket
	    csak az <application>LPD</application> futtatja, senki
	    másnak nincs rájuk
	    szüksége.</para>

	  <para>A konverziós szûrõk
	    aktiválásához az
	    <filename>/etc/printcap</filename> állományban
	    egyszerûen adjuk meg az alkalmas
	    tulajdonságoknak megfelelõ szûrõk
	    elérési útvonalait.</para>

	  <para>A példánkban most felveszünk egy DVI
	    konverziós szûrõt a
	    <literal>bamboo</literal> nevû nyomtatóhoz.  Itt
	    ismét láthatjuk a korábban
	    használt <filename>/etc/printcap</filename>
	    állományt, ahol most azonban a
	    <literal>bamboo</literal> nevû
	    nyomtatónál hozzáadtunk egy
	    <literal>df</literal> tulajdonságot:</para>

	  <programlisting>#
#  /etc/printcap (rose) -  egy df szûrõ hozzáadása a bamboo
#  nevû nyomtatóhoz
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<filename>/usr/local/libexec/psif</filename>:\
        :df=<filename>/usr/local/libexec/psdf</filename>:</programlisting>

	  <para>A DVI szûrõ ebben az esetben a
	    <filename>/usr/local/libexec/psdf</filename> néven
	    elérhetõ aprócska szkript.  Ezt
	    találhatjuk benne:</para>

	  <programlisting>#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
# Az lpr -d parancs hatására hívódik meg
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps "$@"</programlisting>

	  <para>A szkript a <command>dvips</command> parancsot
	    szûrõként futtatja (az <option>-f</option>
	    paraméterrel) a szabványos bemenetrõl,
	    ahova a nyomtatási feladatot is kapja.  Ezután
	    elindítja az <command>lprps</command> &postscript;
	    szûrõt (lásd a <link linkend="printing-advanced-if-conversion">Szöveges
	      nyomtatási feladatok &postscript;
	      nyomtatókon</link> címû szakaszt) az
	    <application>LPD</application> által átadott
	    paraméterekkel.  Az <command>lprps</command> parancs
	    ezekkel a paraméterekkel tartja nyilván az
	    így kinyomtatott lapokat.</para>

	</sect4>

	<sect4>
	  <title>További példák konverziós
	    szûrõkre</title>

	  <para>A konverziós szûrõk
	    telepítésének nincs bevált
	    receptje, ezért ebben a szakaszban bemutatunk
	    rájuk néhány mûködõ
	    illusztrációt.  Ezeket tudjuk
	    felhasználni saját szûrõk
	    elkészítésére.  Vagy ha
	    megtehetjük, használjuk közvetlenül
	    ezeket.</para>

	  <para>Ebben a példa szkriptben Hewlett Packard LaserJet
	    III-Si nyomtatókhoz hozunk létre raszteres
	    (pontosabban GIF formátumú) konverziós
	    szûrõt:</para>

	  <programlisting>#!/bin/sh
#
#  hpvf - GIF állományokat konvertál át HP/PCL-be, majd kinyomtatja
#  Helye: /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
    &amp;&amp; exit 0 \
    || exit 2</programlisting>

	  <para>Úgy mûködik, hogy a GIF
	    állományt elõször PNM (portable
	    anymap), utána PGM (portable graymap), majd PBM
	    (portable bitmap) formátumúra alakítja,
	    amibõl végül LaserJet/PCL-kompatibilis adat
	    lesz.</para>

	  <para>Ez lesz a hozzá tartozó
	    <filename>/etc/printcap</filename>
	    állomány:</para>

	  <programlisting>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<filename>/dev/lpt0</filename>:sh:sd=<filename>/var/spool/lpd/teak</filename>:mx#0:\
        :if=<filename>/usr/local/libexec/hpif</filename>:\
        :vf=<filename>/usr/local/libexec/hpvf</filename>:</programlisting>

	  <para>A most következõ szkript a groff
	    betûszedû rendszerbõl érkezõ
	    troff adatokat alakítja át a
	    <literal>bamboo</literal> nevû &postscript;
	    nyomtató számára:</para>

	  <programlisting>#!/bin/sh
#
#  pstf - a groff troff adait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps "$@"</programlisting>

	  <para>A szkript az <command>lprps</command> parancs
	    segítségével kommunikál a
	    nyomtatóval.  Ha a nyomtatónk
	    párhuzamos porton csatlakozik, akkor helyette ezt a
	    szkriptet használjuk:</para>

	  <programlisting>#!/bin/sh
#
#  pstf - a groff troff adatait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops</programlisting>

	  <para>Kész is!  A szûrõ
	    életrekeltéséhez mindössze ennyit
	    kell beillesztenünk az
	    <filename>/etc/printcap</filename>
	    állományba:</para>

	  <programlisting>:tf=<filename>/usr/local/libexec/pstf</filename>:</programlisting>

	  <para>Most pedig jöjjön a FORTRAN szerelmeseinek
	    szívét megmelengetõ szkript.  Ez egy
	    olyan szövegszûrõ, amely bármelyik
	    nyers szöveget közvetlenül kezelni
	    tudó nyomtató esetén mûködik.
	    A <literal>teak</literal> nevû nyomtatóhoz
	    helyezzük be:</para>

	  <programlisting>#!/bin/sh
#
# hprf - FORTRAN szövegszûrõ LaserJet 3si-hez
# Helye: /usr/local/libexec/hprf
#

printf "\033&amp;k2G" &amp;&amp; fpr &amp;&amp; printf "\033&amp;l0H" &amp;&amp;
 exit 0
exit 2</programlisting>

	  <para>Az <filename>/etc/printcap</filename>
	    állományban a <literal>teak</literal>
	    nyomtatóhoz a következõ sor
	    beírásával tudjuk engedélyezni
	    ezt a szûrõt:</para>

	  <programlisting>:rf=<filename>/usr/local/libexec/hprf</filename>:</programlisting>

	  <para>Most pedig következzen egy utolsó, de az
	    eddigieknél valamivel összetettebb példa.
	    Ebben a korábban bemutatott <literal>teak</literal>
	    nevû LaserJet nyomtatóhoz fogunk
	    hozzáadni egy DVI szûrõt.
	    Elõször is következzen a mûvelet
	    egyszerûbb része: bõvítsük ki
	    az <filename>/etc/printcap</filename>
	    állományt a DVI szûrõ
	    helyének megadásával:</para>

	  <programlisting>:df=<filename>/usr/local/libexec/hpdf</filename>:</programlisting>

	  <para>Ezután következzék a nehezebb
	    rész: a szûrõ
	    elkészítése.  Ehhez
	    szükségünk lesz egy DVI-rõl
	    LaserJet/PCL-re alakító programra.  A &os;
	    Portgyûjteményében (lásd <link linkend="ports">A Portgyûjtemény</link>)
	    találunk is egyet: a csomag neve <package>print/dvi2xx</package>.  A csomag
	    telepítésével megkapjunk a nekünk
	    kellõ <command>dvilj2p</command> programot, ami
	    képes DVI-t LaserJet IIp, LaserJet III és a
	    LaserJet 2000 típusok által ismert
	    kódokra fordítani.</para>

	  <para>A <command>dvilj2p</command>
	    felhasználásától
	    függetlenül a <command>hpdf</command> néven
	    létrehozni kívánt szûrõnk
	    még így is bonyolult lesz, hiszen a
	    <command>dvilj2p</command> nem tud olvasni a
	    szabványos bemenetrõl, hanem mindenáron
	    egy állománnyal akar dolgozni.  Sõt,
	    olyan állománnyal, amelynek
	    <filename>.dvi</filename> kiterjesztése van,
	    ezért még a <filename>/dev/fd/0</filename> (vagyis a
	    szabványos bemenethez tartozó
	    eszközleíró) használata is
	    akadályokba ütközik.</para>

	  <para>Üröm még az örömünkben,
	    hogy a <filename>/tmp</filename>
	    könyvtárat sem tudjuk felhasználni
	    ideiglenes link létrehozására: a
	    szimbolikus linkeket a <systemitem class="username">bin</systemitem>
	    felhasználó és csoport birtokolja, a
	    szûrõt pedig a <systemitem class="username">daemon</systemitem>
	    felhasználó futtatja.  A <filename>/tmp</filename> könyvtárban
	    rááadásul csak a tulajdonosaik
	    képesek állományokat átnevezni
	    vagy törölni (sticky bit).  Ezért a
	    szûrõ ugyan létre tudna hozni egy linket,
	    azonban ezt a feladata végeztével nem lesz
	    majd képes törölni, mivel a link egy
	    másik felhasználóhoz tartozik.</para>

	  <para>Ezért a szûrõ az aktuális
	    könyvtárban fogja létrehozni ezt a
	    szimbolikus linket, ami jelen esetünkben a
	    nyomtatási rendszer által használt
	    könyvtár lesz (ezt az
	    <filename>/etc/printcap</filename> állomány
	    <literal>sd</literal> tulajdonságával adjuk
	    meg).  Itt remekül el tudják végezni a
	    feladataikat a szûrõk, különösen
	    mivel (néha) több hely van itt, mint a <filename>/tmp</filename>
	    könyvtárban.</para>

	  <para>Végül lássuk magát a
	    szûrõt:</para>

	  <programlisting>#!/bin/sh
#
#  hpdf - DVI adat nyomtatása HP/PCL nyomtatón
#  Helye: /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Létrehozunk egy függvényt az átmeneti állományok törlésére. Ezek
#  az aktuális könyvtárban jönnek létre, ami pedig a nyomtatási
#  rendszer adott nyomtatóhoz tartozó könyvtára lesz.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Létrehozunk egy függvényt a súlyos hibák kezelésére: írassunk ki
#  egy adott üzenetet és lépjünk ki a 2-es hibakóddal.  Ezzel üzenünk
#  az LPD-nek, hogy ne hajtsa végre újra a nyomtatási feladatot.
#
fatal() {
    echo "$@" 1&gt;&amp;2
    cleanup
    exit 2
}

#
#  Ha a felhasználó eltávolítja a nyomtatási feladatot a sorból, akkor az
#  LPD egy SIGINT jelzést fog küldeni, ezért próbáljuk meg azt elkapni
#  (néhány más egyéb jelzéssel együtt), így még tudjuk törölni az
#  ideiglenesen # létrehozott állományokat.
#
trap cleanup 1 2 15

#
#  Gondoskodjunk róla, hogy a feladat megkezdésekor még egyetlen
#  használt állomány sem létezik.
#
cleanup

#
#  Kössük össze a szabványos bemenetet egy DVI állománnyal (amit
#  majd nyomtatni akarunk).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal "Cannot symlink /dev/fd/0"

#
#  LF = CR+LF
#
printf "\033&amp;k2G" || fatal "Cannot initialize printer"

#
#  Alakítsuk át az adatot és nyomtassunk. A dvilj2p által visszaadott érték
#  nem túlságosan megbízható, ezért ne is foglalkozzunk vele.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Takarítsunk el magunk után és lépjünk ki szabályosan
#
cleanup
exit 0</programlisting>

	</sect4>

	<sect4 xml:id="printing-advanced-autoconv">
	  <title>Automatikus konverziók: a konverziós
	    szûrõk helyett</title>

	  <para>A konverziós szûrõk sokat
	    segítenek egy kényelmes nyomtatási
	    környezet kialakításában, azonban
	    a használatukhoz a felhasználóknak (az
	    &man.lpr.1; parancson keresztül) egyenként
	    hivatkozniuk kell rájuk.  Ha a rendszerünk
	    felhasználói nem eléggé
	    mûveltek számítástechnikai
	    téren, akkor még egy szûrõ
	    megadása is zavaró lehet számukra.  Ami
	    még ennél is rosszabb, hogy egy rosszul
	    megadott szûrõ hatására a
	    nyomtató sem fogja jól kezelni az adott
	    állomány formátumát és
	    erre válaszul akár többszáz lapot
	    is pillanatok alatt kiköphet
	    magából.</para>

	  <para>A konverziós szûrõk
	    telepítése helyett gyakran csak egy
	    (alapértelmezett) szövegszûrõre van
	    szükségünk, amely kideríti a
	    nyomtatandó állomány pontos
	    formátumát és magától
	    elindítja a neki megfelelõ konverziós
	    szûrõt.  Ilyen esetekben például a
	    <command>file</command> parancs pont a hasznunkra
	    válhat.  Persze <emphasis>bizonyos</emphasis>
	    állománytípusok közt nagyon
	    nehéz különbséget tenni &mdash; de
	    ezekre továbbra is adhatunk még
	    külön konverziós szûrõket.</para>

	  <indexterm><primary>apsfilter</primary></indexterm>
	  <indexterm>
	    <primary>nyomtatás</primary>
	    <secondary>szûrõk</secondary>
	    <tertiary>apsfilter</tertiary>
	  </indexterm>

	  <para>A &os; Portgyûjteményében
	    találhatunk egy <command>apsfilter</command>
	    elnevezésû szövegszûrõt
	    (<package>print/apsfilter</package>), ami
	    képes ilyen automatikus konverzióra.
	    Képes felismerni a nyers szöveget, &postscript;
	    programokat, DVI és szinte bármilyen
	    formátumú állományokat,
	    lefuttatni rájuk a megfelelõ
	    átalakításokat, majd kinyomtatni
	    ezeket.</para>

	</sect4>
      </sect3>

      <sect3 xml:id="printing-advanced-of">
	<title>Kimeneti szûrõk</title>

	<para>Az <application>LPD</application> nyomtatási
	  rendszer kezel egy eddig még nem tárgyalt
	  szûrõtípust is: ez a kimeneti
	  szûrõ.  A kimeneti szûrõ a
	  szövegszûrõhöz hasonlóan csak nyers
	  szöveg nyomtatására használatos, de
	  tartalmaz néhány
	  egyszerûsítést.  Ha kizárólag
	  csak kimeneti szûrõket alkalmazunk, akkor:</para>

	<itemizedlist>
	  <listitem>
	    <para>Az <application>LPD</application> az egész
	      nyomtatási feladathoz egyetlen kimeneti
	      szûrõt fog használni, nem pedig minden
	      állományhoz külön.</para>
	  </listitem>
	  <listitem>
	    <para>Az <application>LPD</application> a kimeneti
	      szûrõ számára nem nyújt
	      semmilyen segítséget a nyomtatási feladaton
	      belül szereplõ állományok
	      kezdetének vagy végének
	      megállapításában.</para>
	  </listitem>
	  <listitem>
	    <para>Az <application>LPD</application> a szûrõnek
	      nem adja át sem a felhasználó
	      hozzáférését, sem pedig
	      gépnevét, ezért
	      nyilvántartásra nem alkalmas.  Mindent
	      összegezve lényegében csak két
	      paramétert kap meg:</para>

	    <cmdsynopsis>
	      <command>szûrõnév</command>
		<arg choice="plain">-w<replaceable>szélesség</replaceable></arg>
		<arg choice="plain">-l<replaceable>hossz</replaceable></arg>
	    </cmdsynopsis>

	    <para>ahol a
	      <replaceable>szélesség</replaceable> a
	      kérdéses nyomtató
	      <literal>pw</literal>
	      tulajdonságából, a
	      <replaceable>hossz</replaceable> pedig a
	      <literal>pl</literal> tulajdonságából
	      származik.</para>
	  </listitem>
	</itemizedlist>

	<para>Ne bûvöljön el minket a szûrõ
	  egyszerûsége!  Ha például a
	  nyomtatási feladatban minden állományt
	  újabb lapon szeretnénk kezdeni, akkor azt
	  kimeneti szûrõvel <emphasis>nem tudjuk
	  megoldani</emphasis>.  Erre a célra használjunk
	  szövegszûrõt (másik nevén
	  bemeneti szûrõt), lásd <link linkend="printing-textfilter">A szövegszûrõ
	    telepítése</link> szakaszt.
	  Továbbá, a kimeneti szûrõ
	  valójában <emphasis>sokkal
	  bonyolultabb</emphasis> abban a tekintetben, hogy a
	  beérkezõ adatok közül neki kell
	  kikeresnie a speciális jelentéssel
	  bíró karaktereket ugyanúgy, ahogy az
	  <application>LPD</application> helyett saját
	  magának kell küldenie a jelzéseket.</para>

	<para>Azonban a kimeneti szûrõk használata
	  <emphasis>elkerülhetetlen</emphasis>, ha
	  például fejléclapokat akarunk nyomtatni,
	  és esetleg még különbözõ
	  inicializálásra használatos
	  speciális kódokat vagy karakterláncokat
	  akarunk ez elõtt kiküldeni.  (Ellenben
	  <emphasis>badarság</emphasis> a
	  fejléclapoktól követelni a
	  felhasználó adatait, hiszen az
	  <application>LPD</application> a kimeneti szûrõnek
	  nem ad semmilyen erre vonatkozó
	  információt.)</para>

	<para>Egyetlen nyomtató esetén az
	  <application>LPD</application> egyaránt
	  lehetõvé teszi kimeneti, szöveg- és
	  más egyéb szûrõk
	  használatát.  Ilyenkor az
	  <application>LPD</application> a kimeneti szûrõn
	  keresztül csak a fejlécet tartalmazó oldal
	  (lásd a <link linkend="printing-advanced-header-pages">Fejléclapok</link>
	    szakaszt) nyomtatását indítja el.  Ezt
	  követõen az <application>LPD</application> arra
	  számít, hogy a kimeneti szûrõ
	  két karakter, az ASCII 031 és az ezt
	  követõ ASCII 001, hatására
	  <emphasis>leállítja magát</emphasis>.
	  Amikor tehát a kimeneti szûrõ
	  érzékeli ezt a két karaktert (031, 001),
	  akkor a <literal>SIGSTOP</literal> jelzéssel le kell
	  állnia.  Miután az
	  <application>LPD</application> lefuttatta a többi
	  szûrõt, a <literal>SIGCONT</literal>
	  jelzéssel újraindítja a kimeneti
	  szûrõt.</para>

	<para>Ha van kimeneti szûrõnk, de
	  <emphasis>nincs</emphasis> szövegszûrõnk, akkor
	  az <application>LPD</application> minden további
	  feldolgozás nélkül továbbadja a
	  nyomtatási feladatot a kimeneti szûrõnek.
	  Ahogy már korábban is említettük, a
	  kimeneti szûrõ a nyomtatási feladatban
	  levõ összes állományt egymás
	  után nyomtatja ki, lapdobások vagy
	  bármilyen más papírmozgatás
	  nélkül, ezért
	  valószínûleg <emphasis>nem</emphasis> ez
	  kell nekünk.  Az esetek túlnyomó
	  részében ehhez elég egy
	  szövegszûrõ.</para>

	<para>A korábban szövegszûrõként
	  beharangozott <command>lpf</command> program kimeneti
	  szûrõként is képes
	  funkcionálni.  Ha szükségünk lenne egy
	  gyorsan összecsapható kimeneti szûrõre,
	  és nem akarunk a speciális karakterek, valamint a
	  jelzések küldésével elidõzni,
	  akkor próbálkozzunk az <command>lpf</command>
	  használatával.  Az <command>lpf</command>
	  parancsot mellesleg becsomagolhatjuk egy olyan szkriptbe is,
	  amely elvégzi a nyomtató számára
	  szükséges inicializálást.</para>
      </sect3>

      <sect3 xml:id="printing-advanced-lpf">
	<title>Az <command>lpf</command>
	  szövegszûrõ</title>

	<para>A &os; bináris terjesztéséhez
	  mellékelt <filename>/usr/libexec/lpr/lpf</filename>
	  program egy szövegszûrõ (bemeneti
	  szûrõ), amely képes (az <command>lpr
	  -i</command> paranccsal hozzáadott
	  nyomtatási feladatokat) tabulálni, (az
	  <command>lpr -l</command> paranccsal felvett
	  nyomtatási feladatokban) a
	  vezérlõkaraktereket figyelemen kívül
	  hagyni, a nyomtatási feladatban elõforduló
	  törlések és behúzások
	  nyomtatási pozícióját
	  igazítani és nyilvántartani a
	  kinyomtatott lapokat.  Kimeneti szûrõként is
	  tud viselkedni.</para>

	<para>Az <command>lpf</command> szûrõ rengeteg
	  nyomtatási környezetben
	  felhasználható.  Habár nem képes a
	  nyomtatónak inicializáló jelsorozatokat
	  küldeni, mégis könnyû olyan szkriptet
	  írni, amely elvégzi ezeket a
	  hiányzó kezdeti
	  beállításokat, majd lefuttatja az
	  <command>lpf</command> szûrõt.</para>

	<indexterm><primary>oldalak
	  nyilvántartása</primary></indexterm>
	<indexterm>
	  <primary>nyilvántartás</primary>
	  <secondary>nyomtató</secondary>
	</indexterm>

	<para>Az <command>lpf</command> akkor lesz képes helyesen
	  számolni a kinyomtatott lapokat, ha ehhez az
	  <filename>/etc/printcap</filename> állományban
	  jól töltjük ki a <literal>pw</literal>
	  és <literal>pl</literal> tulajdonságokat.  Ezen
	  értékek segítségével
	  határozható meg ugyanis, hogy mennyi szöveg
	  fért rá egy lapra és így mennyi
	  lapot emésztett fel az adott felhasználó
	  által küldött nyomtatási feladat.  A
	  nyomtatás nyilvántartásával
	  kapcsolatban <link linkend="printing-advanced-acct">A nyomtató használatának
	    nyilvántartása</link> címû
	  szakaszt érdemes elolvasni.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="printing-advanced-header-pages">
      <title>Fejléclapok</title>

      <para>Ha <emphasis>nagyon sok</emphasis>
	felhasználónk van, és sok
	különbözõ nyomtatót is
	használnak, akkor elõbb vagy utóbb minden
	bizonnyal elkerülhetetlenné fog válni a
	<emphasis>fejléclapok</emphasis>
	használata.</para>

      <indexterm>
	<primary>munkalapok</primary>
	<see>fejléclapok</see>
      </indexterm>
      <indexterm><primary>fejléclapok</primary></indexterm>

      <para>A fejléc-, vagy más néven
	<emphasis>munka-</emphasis> vagy
	<emphasis>elválasztó lapok</emphasis>
	segítik elõ az elvégzett nyomtatási
	feladatok azonosítását.  A többi
	dokumentumtól eltérõ módon,
	általában dekoratív keretben, nagy, vastag
	betûkkel nyomtatódnak ki, hogy a halomnyi
	papír között a felhasználók
	könnyedén megtalálhassák az
	elküldött nyomtatási feladataik
	eredményét.  Természetesen a
	fejléclapok nyilvánvaló
	hátulütõje, hogy így minden
	nyomtatási feladathoz még egy lappal többet
	kell elhasználni és mivel gyakorlatilag
	néhány percnél tovább nincs is
	rájuk szükség, meglehetõsen hamar a
	kukába kerülnek.  (A fejléclapok
	nyomtatási feladatonként jönnek létre,
	nem pedig a nyomtatási feladatokban levõ
	állományokhoz egyenként, ezért nem
	is akkora pazarlás ez.)</para>

      <para>Az <application>LPD</application> rendszer képes
	magától fejléclapokat
	készíteni a nyomtatásokhoz,
	<emphasis>amennyiben</emphasis> a nyomtatónk képes
	közvetlenül nyers szöveget nyomtatni.  Ha
	&postscript; nyomtatónk van, akkor ennek
	legyártásához egy külsõ programra
	van szükségünk, lásd a <link linkend="printing-advanced-header-pages-ps">Fejléclapok
	  &postscript; nyomtatókon</link> szakaszt.</para>

      <sect3 xml:id="printing-advanced-header-pages-enabling">
	<title>A fejléclapok engedélyezése</title>

	<para>Az <link linkend="printing-simple">Alacsonyszintû
	    nyomtatóbeállítás</link>
	  címû szakaszban az
	  <filename>/etc/printcap</filename> állományban a
	  <literal>sh</literal> (úgy mint <quote>suppress
	  header</quote>) tulajdonsággal kikapcsoltuk a
	  fejléclapokat.  A fejléclapok
	  engedélyezéséhez mindössze el kell
	  távolítanunk ezt az <literal>sh</literal>
	  tulajdonságot.</para>

	<para>Ez túl egyszerû, nemde?</para>

	<para>Igen, ez így van.
	  <emphasis>Elõfordulhat</emphasis>, hogy
	  szükségünk van még egy olyan kimeneti
	  szûrõre is, amely inicializáló
	  karaktereket küld a nyomtatónak.  Íme egy
	  példa ehhez a Hewlett Packard PCL-kompatibilis
	  nyomtatói esetére:</para>

	<programlisting>#!/bin/sh
#
#  hpof - Kimeneti szûrõ Hewlett Packard PCL-kompatibilis nyomtatókhoz
#  Helye: /usr/local/libexec/hpof

printf "\033&amp;k2G" || exit 2
exec /usr/libexec/lpr/lpf</programlisting>

	<para>Az <literal>of</literal> tulajdonsággal adjuk meg a
	  kimeneti szûrõt.  A <link linkend="printing-advanced-of">Kimeneti
	    szûrõk</link> szakaszban errõl
	  részletesebben is olvashatunk.</para>

	<para>A korábban ismertetett <literal>teak</literal>
	  nevû nyomtatóhoz most az alábbi minta
	  <filename>/etc/printcap</filename> állományt
	  mellékeljük.  Itt engedélyeztük a
	  fejléclapokat és hozzátettük az
	  iménti kimeneti szûrõt:</para>

	<programlisting>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<filename>/dev/lpt0</filename>:sd=<filename>/var/spool/lpd/teak</filename>:mx#0:\
        :if=<filename>/usr/local/libexec/hpif</filename>:\
        :vf=<filename>/usr/local/libexec/hpvf</filename>:\
        :of=<filename>/usr/local/libexec/hpof</filename>:</programlisting>

	<para>Mostantól kezdve, amikor a
	  felhasználók a <literal>teak</literal>
	  nyomtatón akarnak nyomtatni, minden nyomtatási
	  feladathoz kapni fognak egy fejléclapot.  Amennyiben a
	  kedves felhasználók mégis keresgetni
	  akarják a nyomtatásaikat, az <command>lpr
	  -h</command> paranccsal tetszõleges
	  módon letilthatják azokat.  Az &man.lpr.1;
	  többi hasonló opcióját <link linkend="printing-lpr-options-misc">A fejléclapokhoz
	    tartozó beállítások</link>
	  szakaszban találjuk.</para>

	<note>
	  <para>Az <application>LPD</application> minden
	    fejléclap után egy lapdobást küld.
	    Ha erre a célra a nyomtatónk egy
	    eltérõ karaktert vagy karaktersorozatot
	    használ, akkor azt az
	    <filename>/etc/printcap</filename> állomány
	    <literal>ff</literal> tulajdonságával
	    határozhatjuk meg.</para>
	</note>

      </sect3>

      <sect3 xml:id="printing-advanced-header-pages-controlling">
	<title>A fejléclapok vezérlése</title>

	<para>A fejléclapok engedélyezésével
	  az <application>LPD</application> egy ún.
	  <emphasis>hosszú fejlécet</emphasis> fog
	  készíteni, vagyis a felhasználót,
	  a gépet és a nyomtatási feladatot
	  jól azonosító, egész lapot
	  kitöltõ óriási betûket.  Erre egy
	  példa (amiben a <systemitem>rose</systemitem> nevû
	  géprõl <systemitem class="username">kelly</systemitem> küldte az
	  <quote>outline</quote> elnevezésû
	  nyomtatási feladatot):</para>

	<screen>      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy


                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee









      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee







                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</screen>

	<para>Ezt követõen az <application>LPD</application>
	  elküld még egy lapdobást is, ezért
	  maga a nyomtatási feladat eredménye egy
	  új oldalon fog kezdõdni (kivéve, ha az
	  <filename>/etc/printcap</filename> állományban
	  az adott nyomtatóhoz tartozó bejegyzésben
	  megadtuk az <literal>sf</literal> (úgy mint
	  <quote>suppress form feeds</quote>, vagyis a lapdobások
	  letiltása) tulajdonságot.</para>

	<para>Ha úgy jobban tetszik, akkor az
	  <filename>/etc/printcap</filename> állományban a
	  <literal>sb</literal> tulajdonsággal az
	  <application>LPD</application> utasítható
	  <emphasis>rövid fejlécek</emphasis>
	  készítésére is.  Ilyenkor a
	  fejléclap tartalma mindössze ennyi lesz:</para>

	<screen>rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</screen>

	<para>Alapértelmezés szerint az
	  <application>LPD</application> elõször a
	  fejléclapot, majd a nyomtatási feladatot
	  végzi el.  Ezt a sorrendet az
	  <filename>/etc/printcap</filename> állományban a
	  <literal>hl</literal> (header last) tulajdonsággal meg
	  tudjuk fordítani.</para>

      </sect3>

      <sect3 xml:id="printing-advanced-header-pages-accounting">
	<title>A nyomtató használatának
	  nyilvántartása</title>

	<para>Az <application>LPD</application> által
	  felkínált fejléclapok használata
	  során egyetlen irányelv
	  érvényesül a
	  nyilvántartásukban: a fejléclapok
	  <emphasis>költségmentesek</emphasis>.</para>

	<para>De miért?</para>

	<para>Azért, mert kizárólag csak a kimeneti
	  szûrõ képes a fejléclapok
	  viselkedését irányítani, ami
	  viszont nem képes semmiféle
	  nyilvántartásra, hiszen nem kapja meg az ehhez
	  szükséges <emphasis>felhasználói-
	  vagy gépnév</emphasis>
	  információkat, illetve
	  nyilvántartásokat.  Emiatt fogalma sincs
	  róla, hogy kit terhel az adott nyomtató
	  használata.  Úgy sem tudjuk megoldani a
	  problémát, ha a szöveg- vagy
	  konverziós szûrõkben (ahol már
	  rendelkezésünkre állnak a
	  felhasználó és a gépének
	  adatai) <quote>növeljük a lapok számát
	  eggyel</quote> a nyomtatási feladatban, mivel a
	  felhasználók az <command>lpr
	  -h</command> parancs
	  használatával kedvük szerint
	  letilthatják a fejléclapokat.  Ezt ugyan
	  alapvetõen a természetet óvni
	  kívánó felhasználók
	  részesítik elõnyben, de ettõl
	  függetlenül sem erõszakolhatjuk rá
	  mindenkire.</para>

	<para><emphasis>Az sem elég</emphasis>, ha minden
	  szûrõ létrehozza a saját
	  fejlécét (amiért aztán
	  pénzt kérhetnénk).  Mivel ha a
	  felhasználók az
	  <command>lpr -h</command>
	  paranccsal le akarják tiltani a fejlécek
	  használatát, attól a
	  szûrõkhöz még mindig
	  létrejönnek, hiszen az
	  <application>LPD</application> a <option>-h</option>
	  opcióról semmilyen
	  értesítést nem küld át a
	  szûrõknek.</para>

	<para>Nos, ilyenkor mitévõk legyünk?</para>

	<para>A lehetõségeink:</para>

	<itemizedlist>
	  <listitem>
	    <para>Elfogadjuk az <application>LPD</application>
	      elvét, és nem számítunk fel
	      költséget a fejléclapokra.</para>
	  </listitem>

	  <listitem>
	    <para>Az <application>LPD</application> helyett egy
	      másik nyomtatási rendszert
	      használunk, például az
	      <application>LPRng</application> rendszert.  A <link linkend="printing-lpd-alternatives">Más
		nyomtatási rendszerek</link> címû
	      szakaszban kiderül, milyen alternatívák
	      érhetõek el az <application>LPD</application>
	      kiváltására.</para>
	  </listitem>

	  <listitem>
	    <para>Írjunk mi magunk egy
	      <emphasis>intelligens</emphasis> kimeneti
	      szûrõt.  Normális esetben a kimeneti
	      szûrõk nem valók másra,
	      csupán a nyomtató alaphelyzetbe
	      hozására vagy egyszerûbb
	      karakterkonverziók
	      elvégzésére.  Fejléclapokhoz
	      és nyers szöveget tartalmazó
	      nyomtatási feladathoz remekül
	      használható (ahol nincs szöveg- (avagy
	      bemeneti) szûrõ).  Azonban ha a nyers
	      szövegekhez van szövegszûrõnk, akkor
	      az <application>LPD</application> a kimeneti
	      szûrõt csak a fejléclapokhoz
	      indítja el.  Emellett a kimeneti szûrõ az
	      <application>LPD</application> által
	      generált fejléc szövegébõl
	      képes megmondani, melyik
	      felhasználóhoz és géphez
	      tartozik a szóbanforgó fejléc.  A
	      módszer egyetlen bökkenõje, hogy a
	      nyilvántartásokat tároló
	      állományról viszont még
	      így se tudunk semmilyen információt
	      szerezni (mivel nem kapjuk meg az <literal>af</literal>
	      tulajdonsággal beállított
	      állomány nevét).  Ha azonban egy
	      rendszerszinten elérhetõ
	      állományba mentjük ezeket az adatokat,
	      akkor akár bele is drótozhatjuk ezt a
	      kimeneti szûrõbe.  A kimeneti szûrõnek
	      az adatok megtalálásában ilyenkor
	      úgy tudunk segíteni, ha az
	      <filename>/etc/printcap</filename>
	      állományban az <literal>sh</literal>
	      (rövid fejléc) tulajdonságot
	      állítjuk be.  De ez igazából
	      sok hûhó semmiért, és a
	      felhasználók is jobban megbecsülik az
	      olyan nagylelkû rendszergazdát, aki nem
	      számítja fel nekik a
	      fejléclapokat.</para>
	  </listitem>
	</itemizedlist>

      </sect3>

      <sect3 xml:id="printing-advanced-header-pages-ps">
	<title>Fejléclapok &postscript;
	  nyomtatókon</title>

	<para>Ahogy arról már korábban is
	  szó esett, az <application>LPD</application>
	  képes többféle nyomtató
	  számára is megfelelõ, nyers
	  szövegû fejléclapokat
	  készíteni.  Persze a &postscript;
	  közvetlenül nem képes nyers szövegek
	  nyomtatására, ezért az
	  <application>LPD</application> ezen lehetõsége
	  lényegében használhatatlan &mdash;
	  többnyire.</para>

	<para>Ilyen helyzetben a fejléclapok
	  használatának nyilvánvaló
	  módja, hogy minden szövegszûrõt
	  fejlécek gyártására
	  utasítunk.  Ezek a szûrõk a
	  felhasználóról és a
	  gépérõl kapott
	  információkból össze tudják
	  állítani a megfelelõ fejléclapot.  A
	  megoldás hátránya, hogy ez még
	  olyankor is megtörténik, amikor a
	  felhasználók az
	  <command>lpr -h</command> paranccsal
	  küldik a nyomtatási feladataikat.</para>

	<para>Kísérletezzünk egy kicsit ezzel a
	  módszerrel!  A most következõ szkript
	  három paramétert fogad el (a
	  felhasználó hozzáférést, a
	  gép és a nyomtatási feladat
	  nevét), majd ezekbõl létrehoz egy
	  egyszerû &postscript; formátumú
	  fejlécet:</para>

	<programlisting>#!/bin/sh
#
#  make-ps-header - PostScript fejléc létrehozása a szabvány kimenetre
#  Helye: /usr/local/libexec/make-ps-header
#

#
#  Ezek itt a PostScript által használt egységekben vannak megadva
#  (72/col vagy 28/cm).  Írjuk át az általunk használt papírméretre,
#  A4-re vagy amit éppen használunk:
#
page_width=612
page_height=792
border=72

#
#  A paraméterek ellenõrzése.
#
if [ $# -ne 3 ]; then
    echo "Usage: `basename $0` &lt;user&gt; &lt;host&gt; &lt;job&gt;" 1&gt;&amp;2
    exit 1
fi

#
#  Mentsük el ezeket, leginkább az olvashatóság miatt.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Küldjük el a PostScript-kódot a szabványos kimenetre.
#
exec cat &lt;&lt;EOF
%!PS

%
%  Gondoskodjunk róla, hogy ne zavarjuk az utánunk következõ
%  felhasználó nyomtatási feladatának végrehajtását.
%
save

%
%  Csináljunk egy csúf vastag szegélyt, körbe a papíron.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Jelenítsük meg a felhasználó azonosítóját szép, feltûnõ
%  betûkkel.
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Most pedig mutassuk az unalmas részleteket.
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% Ennyi lett volna.
%
restore
showpage
EOF</programlisting>

	<para>Ezzel a szkripttel pedig mindegyik konverziós
	  és szövegszûrõ elõször
	  létrehoz egy fejléclapot, majd elvégzi a
	  felhasználó nyomtatási feladatát.
	  Íme egy korábban már bemutatott DVI
	  szûrõ, amit most kiegészítünk a
	  fejléclapok használatával:</para>

	<programlisting>#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
#  Az lpr -d parancs hatására hívódik meg.
#

orig_args="$@"

fail() {
    echo "$@" 1&gt;&amp;2
    exit 2
}

while getopts "x:y:n:h:" option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo "LPD started `basename $0` wrong." 1&gt;&amp;2
              exit 2
              ;;
    esac
done

[ "$login" ] || fail "No login name"
[ "$host" ] || fail "No host name"

( /usr/local/libexec/make-ps-header $login $host "DVI File"
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</programlisting>

	<para>Láthatjuk, hogy a szûrõnek a
	  felhasználói- és a gépnév
	  megállapításához végig kell
	  néznie a paraméterek listáját.  Ez
	  lényegében minden más konverziós
	  szûrõnél ugyanígy néz ki.  Ez a
	  lista azonban a szövegszûrõk esetén
	  némileg eltér (lásd a <link linkend="printing-advanced-filters">Hogyan mûködnek
	    a szûrõk?</link> szakaszt).</para>

	<para>Már az elõbbiekben is tárgyaltuk, hogy
	  ez a megoldás, habár eléggé
	  egyszerû, az <command>lpr</command> számára
	  nem teszi lehetõvé a fejléclapok
	  letiltását (a <option>-h</option> opció).
	  Ha a felhasználóink kímélni
	  akarják a fákat (vagy meg akarják
	  úszni a fejléclapok égbeszökõ
	  költségeit), akkor ezt nem tudják megtenni,
	  hiszen a szûrõk minden nyomtatási feladathoz
	  készíteni fognak fejléceket.</para>

	<para>Ezt a korlátozást csak úgy tudjuk
	  elsöpörni, ha bevetjük a <link linkend="printing-advanced-header-pages-accounting">A
	    nyomtató használatának
	    nyilvántartása</link> szakaszban leírt
	  cselt, tehát készítünk egy olyan
	  kimeneti szûrõt, amely megkeresi az LPD-vel
	  generált fejléceket és létrehozza
	  azok &postscript; változatát.  Ha valaki az
	  <command>lpr -h</command> paranccsal
	  küld nyomtatnivalót, akkor
	  <application>LPD</application> nem készít
	  hozzá fejléclapot, ahogy a kimeneti
	  szûrõnk sem.  A kimeneti szûrõ minden
	  más esetben beolvassa az <application>LPD</application>
	  által küldött szöveget és
	  átküldi a neki megfelelõ &postscript;
	  kódot a nyomtatóra.</para>

	<para>Ha soros &postscript; nyomtatónk van, akkor
	  használhatjuk a <command>psof</command> kimeneti
	  szûrõhöz tartozó
	  <command>lprps</command> parancsot is, ami pontosan az
	  elõbbit végzi el.  Hozzátennénk
	  azonban, hogy a <command>psof</command> nem számolja a
	  fejléclapokat.</para>

      </sect3>
    </sect2>

    <sect2 xml:id="printing-advanced-network-printers">
      <title>Hálózati nyomtatás</title>

      <indexterm>
	<primary>nyomtató</primary>
	<secondary>hálózati</secondary>
      </indexterm>
      <indexterm><primary>hálózati
	nyomtatás</primary></indexterm>

      <para>A &os; tud hálozaton is nyomtatni, vagyis tud
	távoli számítógépeknek is
	nyomtatási feladatot küldeni.  A
	hálózati nyomtatás kifejezés
	általánosságban véve két
	különbözõ dologra utalhat:</para>

      <itemizedlist>
	<listitem>
	  <para>Egy távoli
	    számítógéphez kapcsolt
	    nyomtató hozzáférését.  A
	    géphez a nyomtató a hagyományos soros
	    vagy párhuzamos csatolófelületen
	    keresztül kapcsolódik, amit aztán az
	    <application>LPD</application> alkalmas
	    beállításával a
	    hálózaton mindenki számára
	    elérhetõvé teszünk.  A <link linkend="printing-advanced-network-rm">Távoli
	      számítógépekre csatlakoztatott
	      nyomtatók</link> címû szakasz
	    errõl szól.</para>
	</listitem>

	<listitem>
	  <para>Egy közvetlenül a hálózatra
	    kapcsolt nyomtató
	    hozzáférését.  A nyomtató
	    tehát rendelkezik még egy
	    hálózati csatlakozással is a
	    hagyományos soros vagy párhuzamos felület
	    mellett (vagy éppen helyett).  Egy ilyen
	    nyomtató a következõképpen
	    mûködhet:</para>

	  <itemizedlist>
	    <listitem>
	      <para>Elfogadja az <application>LPD</application>
		kéréseit, és még
		képes nyomtatási feladatokat is
		tárolni.  Ebben az esetben teljesen
		egyenértékû egy
		<application>LPD</application> alkalmazást
		futtató
		számítógéppel.  Ekkor nincs
		más teendõnk, csak követnünk kell
		a <link linkend="printing-advanced-network-rm">Távoli
		  számítógépeken
		  telepített nyomtatók</link>
		címû szakasz
		utasításait.</para>
	    </listitem>

	    <listitem>
	      <para>Hálózati adatfolyamokkal dolgozik.
		Ebben az esetben a nyomtatót <quote>hozzá
		kell kapcsolnunk</quote> a hálózaton
		található egyik
		számítógéphez, ami majd a
		nyomtatási feladatok
		tárolásáért és
		folyamatos küldéséért lesz
		felelõs.  A <link linkend="printing-advanced-network-net-if">Nyomtatók
		  hálózati adatcsatlakozással</link>
		szakasz az ilyen fajtájú nyomtatók
		telepítésére tesz
		néhány javaslatot.</para>
	    </listitem>
	  </itemizedlist>
	</listitem>
      </itemizedlist>

      <sect3 xml:id="printing-advanced-network-rm">
	<title>Távoli számítógépekre
	  csatlakoztatott nyomtatók</title>

	<para>Az <application>LPD</application> nyomtatási
	  rendszer alapból képes más,
	  szintén <application>LPD</application>-t (vagy vele
	  kompatibilis rendszert) futtató
	  számítógépekre nyomtatási
	  feladatokat küldeni.  Ezzel lényegében az
	  egyik géphez hozzá tudunk kapcsolni egy
	  nyomtatót, amit aztán a többiek
	  számára elérhetõvé
	  teszünk.  Ez olyan nyomtatók esetében is
	  mûködik, amelyek ismerik az
	  <application>LPD</application> által alkalmazott
	  protokollt.</para>

	<para>A távoli nyomtatáshoz elõször
	  telepítsük a nyomtatót valamelyik
	  számítógépre az <link linkend="printing-simple">Alacsonyszintû
	    nyomtatóbeállítás</link>
	  szakaszban leírtak szerint, és ezzel az lesz a
	  <emphasis>nyomtatószerverünk</emphasis>.
	  Ezután, amennyiben szükségesnek
	  találjuk, végezzünk <link linkend="printing-advanced">magasabb szintû
	    nyomtatóbeállítások</link>at is.
	  Ne felejtsük el kipróbálni a
	  nyomtatón, hogy rendesen mûködik az
	  <application>LPD</application> mindegyik olyan
	  beállításával, amit
	  engedélyeztünk.  Emellett gondoskodjunk minden
	  olyan jogosultságról is, amivel a
	  <emphasis>helyi
	  számítógéprõl</emphasis> el
	  tudjuk érni a <emphasis>távoli
	  számítógép</emphasis> által
	  felkínált <application>LPD</application>
	  szolgáltatást (lásd <link linkend="printing-advanced-restricting-remote">Távoli
	    számítógépekrõl
	    érkezõ kérések
	    szabályozása</link>).</para>

	<indexterm>
	  <primary>nyomtató</primary>
	  <secondary>hálózati</secondary>
	</indexterm>
	<indexterm><primary>hálózati
	  nyomtatás</primary></indexterm>

	<para>Ha olyan nyomtatót használunk, aminek a
	  hálózati felülete kompatibilis az
	  <application>LPD</application> rendszerrel, akkor az
	  elõbb említett
	  <emphasis>nyomtatószerver</emphasis>
	  lényegében maga lesz a nyomtató, valamint
	  a <emphasis>nyomtató neve</emphasis> a rajta
	  beállított név.  Ezzel kapcsolatban
	  olvassuk el a nyomtatóhoz és/vagy a
	  hálózati csatolójához
	  mellékelt dokumentációt.</para>

	<tip>
	  <para>Amikor a Hewlett Packard Laserjet típusú
	    nyomtatóit használjuk, a
	    <literal>text</literal> nevû nyomtatónév
	    magától elvégzi a LF és CRLF
	    formátumú sortörések közti
	    átalakítást, ezért ilyenkor
	    nincs szükségünk a
	    <filename>hpif</filename> szkriptre.</para>
	</tip>

	<para>Ezután ha szeretnénk más gépek
	  részére is elérhetõvé tenni a
	  frissen telepített nyomtatónkat, adjuk meg
	  mindegyikük <filename>/etc/printcap</filename>
	  állományában a
	  következõket:</para>

	<orderedlist>
	  <listitem>
	    <para>Tetszõlegesen választott nevet,
	      álneveket.  Az egyszerûség
	      kedvéért azonban itt érdemes
	      ugyanazokat a neveket választani, mint amit a
	      nyomtatószerveren is használunk.</para>
	  </listitem>

	  <listitem>
	    <para>Szándékosan hagyjuk az
	      <literal>lp</literal> tulajdonságot üresen
	      (<literal>:lp=:</literal>).</para>
	  </listitem>

	  <listitem>
	    <para>Hozzunk létre egy nyomtatási
	      könyvtárat, és jelöljük meg a
	      helyét az <literal>sd</literal>
	      tulajdonsággal.  Az <application>LPD</application>
	      itt fogja összegyûjteni a nyomtatási
	      feladatokat, mielõtt elküldené azokat a
	      nyomtatószervernek.</para>
	  </listitem>

	  <listitem>
	    <para>Adjuk meg a nyomtatószerver nevét az
	      <literal>rm</literal> tulajdonság
	      segítségével.</para>
	  </listitem>

	  <listitem>
	    <para>Az <literal>rp</literal> tulajdonsággal adjuk
	      meg a <emphasis>nyomtatószerverre</emphasis>
	      csatlakoztatott nyomtató nevét.</para>
	  </listitem>
	</orderedlist>

	<para>Kész!  Az <filename>/etc/printcap</filename>
	  állományban már nem kell megadni
	  konverziós szûrõket,
	  oldalbeállításokat és semmi
	  más egyebet.</para>

	<para>Lássunk mindezekre egy példát.  A
	  <systemitem>rose</systemitem> nevû
	  számítógéphez két
	  nyomtató csatlakozik, a <literal>bamboo</literal>
	  és a <literal>rattan</literal>.  Most pedig
	  beállítjuk, hogy az <systemitem>orchid</systemitem>
	  nevû gép felhasználói képesek
	  legyenek ezekkel a nyomtatókkal dolgozni.  Ekkor a most
	  következõk szerint fog kinézni az
	  <systemitem>orchid</systemitem> (a <link linkend="printing-advanced-header-pages-enabling">
	    Fejléclapok engedélyezése</link>
	  szakaszban bemutatott) <filename>/etc/printcap</filename>
	  állománya.  Tartalmazza a
	  <literal>teak</literal> nevû nyomtató
	  beállításait is, és ehhez fogjuk
	  hozzáadni a <systemitem>rose</systemitem> másik
	  két nyomtatóját:</para>

	<programlisting>#
#  /etc/printcap (orchid) - a rose két (távoli) nyomtatójának
#  hozzáadása
#

#
#  A "teak" egy helyi nyomtató, közvetlenül az orchidhoz
#  csatlakozik:
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<filename>/dev/lpt0</filename>:sd=<filename>/var/spool/lpd/teak</filename>:mx#0:\
        :if=<filename>/usr/local/libexec/ifhp</filename>:\
        :vf=<filename>/usr/local/libexec/vfhp</filename>:\
        :of=<filename>/usr/local/libexec/ofhp</filename>:

#
#  A "rattan" rose-hoz csatlakozik, így küldhetünk neki nyomtatási
#  feladatot:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=<filename>/var/spool/lpd/rattan</filename>:

#
#  A "bamboo" is a rose-hoz tartozik:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=<filename>/var/spool/lpd/bamboo</filename>:</programlisting>

	<para>Ezután már csak létre kell hoznunk a
	  megfelelõ nyomtatási könyvtárakat az
	  <systemitem>orchid</systemitem> nevû gépen:</para>

	<screen>&prompt.root; <userinput>mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</userinput>
&prompt.root; <userinput>chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</userinput>
&prompt.root; <userinput>chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</userinput></screen>

	<para>Mostantól kezdve az <systemitem>orchid</systemitem>
	  felhasználói képesek lesznek nyomtatni a
	  <literal>rattan</literal> és <literal>bamboo</literal>
	  nevû nyomtatókon is.  Ezért, ha az
	  <systemitem>orchid</systemitem> egyik felhasználója
	  beírja, hogy:</para>

	<screen>&prompt.user; <userinput>lpr -P bamboo -d sushi-leírás.dvi</userinput></screen>

	<para>Az <systemitem>orchid</systemitem> gépen
	  mûködõ <application>LPD</application> rendszer
	  ezt a nyomtatási feladatot a bemásolja a
	  <filename>/var/spool/lpd/bamboo</filename>
	  nevû nyomtatási könyvtárba és
	  feljegyzi róla, hogy a nyomtatásához DVI
	  szûrõre lesz szükség.  Ahogy
	  <systemitem>rose</systemitem> gépen található
	  <literal>bamboo</literal> nyomtatási
	  könyvtárában elegendõ hely keletkezik,
	  a két <application>LPD</application>
	  átküldi egymás közt a
	  <systemitem>rose</systemitem> nevû gépre az
	  állományt.  Ezután az
	  állomány egészen addig várakozik a
	  <systemitem>rose</systemitem> nyomtatási sorában,
	  amíg végezetül kinyomtatásra nem
	  kerül.  A <systemitem>rose</systemitem> fogja
	  átalakítani DVI-rõl &postscript;
	  formátumra átalakítani (mivel a
	  <literal>bamboo</literal> egy &postscript;
	  nyomtató).</para>
      </sect3>

      <sect3 xml:id="printing-advanced-network-net-if">
	<title>Nyomtatók hálózati
	  adatcsatlakozással</title>

	<para>Amikor hálózati kártyát
	  vásárolunk a nyomtatónkhoz,
	  általában két változatukkal
	  találkozhatunk: az egyikük nyomtatási
	  rendszerként mûködik (ez a
	  drágább), a másikuk pedig egyszerûen
	  csak soros vagy párhuzamos csatlakozón
	  továbbítandó adatként
	  közvetíti az adatokat a nyomtató
	  felé (az olcsóbb).  A drágábbik
	  változatot az elõzõ, <link linkend="printing-advanced-network-rm">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</link> címû szakaszban
	  leírtak szerint tudjuk használni.</para>

	<para>Az <filename>/etc/printcap</filename>
	  állományban ugyan meg tudjuk adni, hogy a
	  nyomtató soros vagy párhuzamos portra
	  csatlakozik, és azon keresztül milyen
	  adatátviteli sebességgel (amennyiben soros),
	  forgalomirányítással,
	  tabulálással, sortörési
	  konvenció szerint stb.  kommunikáljunk vele.
	  Azonban TCP/IP vagy más hálózati porton
	  ülõ nyomtatók adatait itt nem tudjuk
	  kifejteni.</para>

	<para>A hálózatra kötött
	  nyomtatók használatához
	  lényegében egy olyan külön
	  kifejlesztett kommunikációs programra van
	  szükségünk, amely a szöveg- vagy
	  konverziós szûrõkhöz hasonló
	  módon hívható meg.  Erre rögtön
	  adunk is egy példát: a
	  <command>netprint</command> szkript a szabványos
	  bemenetrõl beolvassa az összes kinyomtatandó
	  adatot és átküldi azokat a
	  hálózatra csatlakoztatott nyomtatónak.  A
	  szkript elsõ paramétereként a
	  nyomtató hálózati nevét adjuk meg,
	  másodiknak pedig portot.  Azonban megjegyezzünk,
	  hogy ez csak egyirányú
	  kommunikációt tesz lehetõvé (a
	  &os;-tõl a nyomtatóig).  Sok
	  hálózati nyomtató viszont két
	  irányban is képes kommunikálni,
	  ezért érdemes lehet ezt kihasználni (a
	  nyomtató állapotának
	  lekérdezésére,
	  nyilvántartások
	  készítésére stb).</para>

	<programlisting>#!/usr/bin/perl
#
#  netprint - A hálózatra csatlakoztatott nyomtató szövegszûrõje
#  Helye: /usr/local/libexec/netprint
#
$#ARGV eq 1 || die "Usage: $0 &lt;printer-hostname&gt; &lt;port-number&gt;";

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require 'sys/socket.ph';

($ignore, $ignore, $protocol) = getprotobyname('tcp');
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack('S n a4 x8', &amp;AF_INET, $printer_port, $address);

socket(PRINTER, &amp;PF_INET, &amp;SOCK_STREAM, $protocol)
    || die "Can't create TCP/IP stream socket: $!";
connect(PRINTER, $sockaddr) || die "Can't contact $printer_host: $!";
while (&lt;STDIN&gt;) { print PRINTER; }
exit 0;</programlisting>

	<para>Rengeteg szûrõben fel tudjuk használni
	  ezt a szkriptet.  Például tegyük fel, hogy
	  egy Diablo 750-N típusú sornyomtatót
	  csatlakoztattunk a hálózatra, amely az 5100-as
	  porton várja a nyomtatandó adatokat.  A
	  hálózati neve most <systemitem>scrivener</systemitem>
	  lesz.  Íme a hozzá tartozó
	  szövegszûrõ:</para>

	<programlisting>#!/bin/sh
#
#  diablo-if-net - Az 5100-as porton figyelõ `scrivener' nevû Diablo
#  nyomtató szövegszûrõje. Helye: /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf "$@" | /usr/local/libexec/netprint scrivener 5100</programlisting>
      </sect3>
    </sect2>

    <sect2 xml:id="printing-advanced-restricting">
      <title>A nyomtató használatának
	szabályozása</title>

      <indexterm>
	<primary>nyomtató</primary>
	<secondary>a hozzáférés
	  korlátozása</secondary>
      </indexterm>

      <para>Ebben a szakaszban a nyomtató
	használatának
	korlázásáról írunk.  Az
	<application>LPD</application> rendszeren keresztül
	meghatározhatjuk, hogy ki képes helyben vagy
	távolról hozzáférni a
	nyomtatóhoz, mennyi másolatot nyomtathat, mennyi
	és egyenként mekkora nyomtatási feladatokat
	küldhet.</para>

      <sect3 xml:id="printing-advanced-restricting-copies">
	<title>A másolatok számának
	  szabályozása</title>

	<para>Az <application>LPD</application>
	  segítségével a felhasználók
	  egy állományt könnyen ki tudnak nyomtatni
	  akár többször is.  Ha (például)
	  a felhasználó egy nyomtatási feladat
	  kiküldéséhez az <command>lpr
	  -#5</command> parancsot használja,
	  akkor a nyomtatási feladatban levõ összes
	  állományból öt
	  példányt kap.  Ennek
	  létjogosultságát azonban nekünk kell
	  megítélni.</para>

	<para>Amennyiben úgy érezzük, hogy a
	  további példányok
	  készítése csupán felesleges
	  papír- és tintapazarlás, akkor az
	  <literal>sc</literal> tulajdonság
	  megadásával az
	  <filename>/etc/printcap</filename> állományban
	  kikapcsolhatjuk az &man.lpr.1; <option>-#</option>
	  lehetõség használatát.  Így
	  amikor a felhasználók a <option>-#</option>
	  kapcsolóval küldenek el feladatokat a
	  nyomtatóra, a következõt fogják
	  tapasztalni:</para>

	<screen>lpr: multiple copies are not allowed</screen>

	<para>Fordítása:</para>

	<screen>lpr: másolatok nyomtatása nem engedélyezett</screen>

	<para>Vigyázzunk arra, hogy ha távoli
	  számítógépen zajlik a
	  nyomtatás (lásd <link linkend="printing-advanced-network-rm">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</link>), akkor az <literal>sc</literal>
	  tulajdonságot a távoli
	  számítógép
	  <filename>/etc/printcap</filename>
	  állományában is be kell
	  állítani, máskülönben a
	  felhasználók egy másik
	  számítógéprõl mindig
	  képesek lesznek több példány
	  nyomtatására.</para>

	<para>Nézzünk erre egy példát.  Itt
	  most a <systemitem>rose</systemitem> nevû
	  számítógép
	  <filename>/etc/printcap</filename>
	  állományát vesszük szemügyre.
	  Ebben a <literal>rattan</literal> egy nagyon
	  szívélyes nyomtató lesz, ezért
	  engedélyezi a másolatok
	  nyomtatását, azonban a <literal>bamboo</literal>
	  nevû lézernyomtató nála már
	  sokkal válogatósabb lesz, ezért a
	  beállításai közt az
	  <literal>sc</literal> tulajdonsággal kikapcsoljuk a
	  másodpéldányok
	  nyomtatását:</para>

	<programlisting>#
#  /etc/printcap (rose) - A másolatok korlátozása a "bamboo"
#  nevû nyomtatón
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:sc:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<filename>/usr/local/libexec/psif</filename>:\
        :df=<filename>/usr/local/libexec/psdf</filename>:</programlisting>

	<para>Az <literal>sc</literal> tulajdonságot az
	  <systemitem>orchid</systemitem> <filename>/etc/printcap</filename>
	  állományában is meg kell adni (és
	  ha már itt vagyunk, akkor tegyük meg ugyanezt a
	  <literal>teak</literal> esetében is):</para>

	<programlisting>#
#  /etc/printcap (orchid) - Nincsenek másodpéldányok sem a helyi
#  "teak" nyomtatón, sem pedig a távoli "bamboo" nyomtatón
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<filename>/dev/lpt0</filename>:sd=<filename>/var/spool/lpd/teak</filename>:mx#0:sc:\
        :if=<filename>/usr/local/libexec/ifhp</filename>:\
        :vf=<filename>/usr/local/libexec/vfhp</filename>:\
        :of=<filename>/usr/local/libexec/ofhp</filename>:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=<filename>/var/spool/lpd/rattan</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=<filename>/var/spool/lpd/bamboo</filename>:sc:</programlisting>

	<para>Az <literal>sc</literal> tulajdonság
	  használatával ugyan megakadályozzuk az
	  <command>lpr -#</command> parancs
	  teljesítését, azonban ez még
	  mindig nem óv meg minket attól, hogy a
	  felhasználók képesek legyenek
	  többször egymás után lefuttatni az
	  &man.lpr.1; parancsot, vagy éppen egyetlen
	  nyomtatási feladatban több állományt
	  is elküldeni:</para>

	<screen>&prompt.user; <userinput>lpr forsale.sign forsale.sign forsale.sign forsale.sign forsale.sign</userinput></screen>

	<para>Számos módszer kínálkozik az
	  effajta visszaélések
	  kivédésére (beleértve a figyelmen
	  kívül hagyást is), lehet velük
	  kísérletezgetni!</para>
      </sect3>

      <sect3 xml:id="printing-advanced-restricting-access">
	<title>A nyomtatók
	  hozzáférésének
	  szabályozása</title>

	<para>A &unix; csoportkezelésével és az
	  <filename>/etc/printcap</filename> állományban
	  található <literal>rg</literal>
	  tulajdonság felhasználásával
	  korlátozni tudjuk, ki milyen nyomtatón
	  dolgozhat.  Ehhez mindössze annyit kell tennünk,
	  hogy besoroljuk egy csoportba azokat a
	  felhasználókat, amelyek
	  hozzáférhetnek a nyomtatóhoz, és
	  az <literal>rg</literal> tulajdonsággal
	  megnevezzük azt.</para>

	<para>A csoporton kívüli
	  felhasználókat (köztük magát a
	  <systemitem class="username">root</systemitem> felhasználót is) pedig
	  ezután így üdvözli a rendszer, ha
	  megpróbálnak valamit kinyomtatni egy
	  korlátozott felhasználású
	  nyomtatón:</para>

	<screen>lpr: Not a member of the restricted group</screen>

	<para>Az üzenet fordítása:</para>

	<screen>lpr: Nem jogosult felhasználó</screen>

	<para>Ha erre a távoli
	  számítógépek esetén
	  szükségünk lenne (lásd <link linkend="printing-advanced-network-rm">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</link>), akkor tegyük ugyanazt, mint
	  amit az <literal>sc</literal> (a
	  másodpéldányok letiltása,
	  <quote>suppress multiple copies</quote>) tulajdonság
	  esetén is, vagyis az <literal>rg</literal>
	  tulajdonságot adjuk meg azokon a távoli
	  számítógépeken is, amelyek
	  hozzá tudnak férni a megosztott
	  nyomtatóhoz.</para>

	<para>Például megengedjük, hogy a
	  <literal>rattan</literal> nevû nyomtatót
	  bárki használhassa, azonban a
	  <literal>bamboo</literal> nyomtatót csak az
	  <systemitem class="groupname">artists</systemitem> nevû csoport
	  használhatja.  Következzen hát akkor a
	  <systemitem>rose</systemitem> korábbról már
	  ismert <filename>/etc/printcap</filename>
	  állománya:</para>

	<programlisting>#
#  /etc/printcap (rose) - A bamboo hozzáférésének korlátozása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:sc:rg=artists:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<filename>/usr/local/libexec/psif</filename>:\
        :df=<filename>/usr/local/libexec/psdf</filename>:</programlisting>

	<para>Most ne bántsuk a másik (az
	  <systemitem>orchid</systemitem> nevû gépen levõ)
	  <filename>/etc/printcap</filename> állományt.
	  Így persze az <systemitem>orchid</systemitem> bármelyik
	  felhasználója nyomtathat a
	  <literal>bamboo</literal> nyomtatón.  De ez most egy
	  olyan eset, ahol egyébként lekorlátozzuk
	  a <systemitem>orchid</systemitem> elérését is,
	  ezért az ott beengedett felhasználók
	  már akár használhatják is a
	  nyomtatót.  Vagy sem.</para>

	<note>
	  <para>Minden nyomtatóhoz csak egy ilyen csoportot
	    adhatunk meg.</para>
	</note>

      </sect3>

      <sect3 xml:id="printing-advanced-restricting-sizes">
	<title>A beküldött nyomtatási feladatok
	  méretének szabályozása</title>

	<indexterm><primary>nyomtatási
	  feladatok</primary></indexterm>

	<para>Ha sok felhasználó szeretne a
	  nyomtatóinkhoz hozzáférni, akkor minden
	  bizonnyal meg akarunk adni egy felsõ határt a
	  felhasználók által beküldhetõ
	  nyomtatások méretére vonatkozóan.
	  Mivel a nyomtatási könyvtáraknak otthont
	  adó állományrendszer is egyszer betelhet,
	  ezért mindenképpen érdemes gondoskodni
	  arról, hogy mindenki nyomtatási feladatát
	  el tudjuk rendesen tárolni.</para>

	<indexterm>
	  <primary>nyomtatási feladatok</primary>
	  <secondary>szabályozása</secondary>
	</indexterm>

	<para>Az <application>LPD</application> az <literal>mx</literal>
	  tulajdonsággal lehetõséget ad arra, hogy
	  lekorlátozzuk a nyomtatási feladatokban
	  található egyes állományok
	  méretét.  Ennek
	  mértékegysége egy
	  <literal>BUFSIZ</literal> blokk, ami pedig 1024 byte.  Ha
	  értékül nullát adunk meg, akkor
	  nincs korlátozás, viszont ha semmit sem
	  rögzítünk, akkor az <literal>mx</literal>
	  tulajdonság alapértéke, vagyis 1000 blokk
	  lesz a határ.</para>

	<note>
	  <para>Ez az érték a nyomtatási
	    feladatokban levõ <emphasis>egyes
	    állományok</emphasis> méretére
	    vonatkozik, <emphasis>nem</emphasis> pedig a
	    nyomtatási feladatok teljes
	    méretére.</para>
	</note>

	<para>Fontos tudni, hogy az <application>LPD</application> nem
	  dobja vissza a méreten felüli
	  állományokat.  Ehelyett a méret alatti
	  részt szépen berakja a sorba és
	  kinyomtatja, a többi pedig elhagyja.  Lehetne rajta
	  vitázni, hogy ez mennyire helyes cselekedet.</para>

	<para>Példaképpen definiáljunk a
	  korábban használt <literal>rattan</literal>
	  és <literal>bamboo</literal> nyomtatóinkhoz
	  ilyen korlátokat.  Mivel az
	  <systemitem class="groupname">artists</systemitem> csoport tagjai hajlamosak nagy
	  &postscript; állományokat küldeni,
	  ezért most lekorlátozzuk ezt öt
	  megabyte-ra.  A szöveges nyomtatónk esetén
	  azonban nem lesz semmilyen határ:</para>

	<programlisting>#
#  /etc/printcap (rose)
#

#
#  Itt nincs korlát a nyomtatási feladatokra:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:

#
#  Öt megabyte a PostScript:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:sc:rg=artists:mx#5000:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:rw:\
        :if=<filename>/usr/local/libexec/psif</filename>:\
        :df=<filename>/usr/local/libexec/psdf</filename>:</programlisting>

	<para>Ismét hozzátesszük, hogy ezek a
	  korlátok csak a helyi felhasználókra
	  vonatkoznak.  Amennyiben távolról is el lehet
	  érni ezt a nyomtatót, a távoli
	  felhasználókat nem fog semmilyen
	  korlátozás érinteni.  Azokon a
	  számítógépeken is meg kell adnunk
	  az <filename>/etc/printcap</filename>
	  állományban az <literal>mx</literal>
	  tulajdonságot.  Ehhez a <link linkend="printing-advanced-network-rm">Távoli
	    számítógépekre csatlakoztatott
	    nyomtatók</link> címû szakaszban
	  találunk segítséget.</para>

	<para>Van még egy speciális módszer, amivel
	  képesek vagyunk szabályozni a
	  távolról érkezõ
	  kérések méretét.  Errõl a
	  <link linkend="printing-advanced-restricting-remote">Távoli
	    számítógépekrõl
	    érkezõ kérések
	    szabályozása</link> szakaszban
	  olvashatunk.</para>

      </sect3>

      <sect3 xml:id="printing-advanced-restricting-remote">
	<title>Távoli
	  számítógépekrõl
	  érkezõ kérések
	  szabályozása</title>

	<para>Az <application>LPD</application> nyomtatási
	  rendszer több módot is szolgáltat a
	  távolról érkezõ nyomtatási
	  feladatok szabályozására:</para>

	<variablelist>
	  <varlistentry>
	    <term>Az elérés
	      szabályozása</term>

	    <listitem>
	      <para>Az <filename>/etc/hosts.equiv</filename> és
		<filename>/etc/hosts.lpd</filename>
		állományok
		segítségével
		beállíthatjuk, hogy mely távoli
		számítógépektõl
		fogadjon el kéréseket az
		<application>LPD</application>.  Az
		<application>LPD</application> minden
		kérés elfogadásakor ellenõrzi,
		hogy a küldõ
		számítógép címe
		szerepel-e az említett állományok
		valamelyikében.  Ha nem, akkor az
		<application>LPD</application> visszautasítja a
		kérést.</para>

	      <para>A két állomány
		felépítése egyszerû, mert
		bennük minden sorban egy-egy hálózati
		nevet adunk meg.  Hozzátennénk azonban,
		hogy legyünk óvatosak, mivel az
		<filename>/etc/hosts.equiv</filename>
		állományt az &man.ruserok.3; protokoll is
		használja, ezért ennek
		módosítása hatással van az
		&man.rsh.1; és &man.rcp.1; programok
		mûködésére.</para>

	      <para>Például most nézzük meg a
		<systemitem>rose</systemitem>
		<filename>/etc/hosts.lpd</filename>
		állományát:</para>

	      <programlisting>orchid
violet
madrigal.fishbaum.de</programlisting>

	      <para>Ennek megfelelõen tehát a
		<systemitem>rose</systemitem> elfogadja az
		<systemitem>orchid</systemitem>, <systemitem>violet</systemitem>
		és <systemitem class="fqdomainname">madrigal.fishbaum.de</systemitem> nevû
		távoli számítógépek
		kéréseit.  Ha bármilyen más
		gép próbál hozzáférni
		a <systemitem>rose</systemitem> által
		felkínált <application>LPD</application>
		szolgáltatáshoz,
		visszautasítja.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>A méret szabályozása</term>

	    <listitem>
	      <para>Szabályozhatjuk többek közt azt is,
		hogy mennyi szabad területnek kell fennmaradnia a
		nyomtatási könyvtárnak otthont
		adó állományrendszeren.  A helyi
		nyomtató könyvtárában ehhez
		hozzunk létre egy <filename>minfree</filename>
		nevû állományt.  Ide írjuk be,
		mennyi szabad lemezblokk (512 byte-os egység a
		lemezen) szükségeltetik egy
		távolról beérkezõ nyomtatási
		feladat fogadásához.</para>

	      <para>Így gondoskodhatunk róla, hogy a
		távoli felhasználók nem
		fogják eltömíteni az
		állományrendszerünket, illetve ezzel
		egyúttal adhatunk némi elõnyt a helyi
		felhasználóknak is: õk ugyanis
		még azután is képesek lesznek
		nyomtatási feladatokat küldeni a
		nyomtatónak, miután az
		állományrendszeren található
		szabad terület mennyisége már
		rég a <filename>minfree</filename>
		állományban szereplõ
		érték alá csökkent.</para>

	      <para>Példaként most a
		<literal>bamboo</literal> nevû nyomtatónkhoz
		adjunk meg egy ilyen <filename>minfree</filename>
		állományt.  Ehhez az
		<filename>/etc/printcap</filename>
		állományból tudjuk
		kideríteni a hozzá tartozó
		nyomtatási könyvtárat.  Lássuk
		tehát belõle a <literal>bamboo</literal>
		bejegyzését:</para>

	      <programlisting>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=<filename>/var/spool/lpd/bamboo</filename>:sc:rg=artists:mx#5000:\
        :lp=<filename>/dev/ttyd5</filename>:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=<filename>/usr/local/libexec/psif</filename>:\
        :df=<filename>/usr/local/libexec/psdf</filename>:</programlisting>

	      <para>A nyomtatási könyvtárat az
		<literal>sd</literal> tulajdonság
		határozza meg.  Úgy állítjuk
		most be, hogy az <application>LPD</application>
		számára a távoli nyomtatási
		feladatok fogadásához ebben a
		könyvtárban legalább három
		megabyte (6144 blokk) szabad területnek mindig
		lennie kell:</para>

	      <screen>&prompt.root; <userinput>echo 6144 &gt; /var/spool/lpd/bamboo/minfree</userinput></screen>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>A felhasználók
	      szabályozása</term>

	    <listitem>
	      <para>Az <filename>/etc/printcap</filename>
		állományban megadható
		<literal>rs</literal> tulajdonság
		segítségével korlátozhatjuk
		a helyi nyomtatókhoz hozzáférni
		képes távoli felhasználókat.
		Amikor az <literal>rs</literal> tulajdonság
		szerepel egy helyben csatlakozó nyomtató
		leírásánál, akkor az
		<application>LPD</application> csak abban az esetben
		fogad el távoli
		felhasználóktól nyomtatási
		feladatot, <emphasis>ha</emphasis> az adott feladatot
		küldõ felhasználónak ugyanazon a
		néven van a helyi gépen is
		hozzáférése.
		Máskülönben az
		<application>LPD</application> vissza fogja
		utasítani a kérést.</para>

	      <para>Ez a tulajdonság különösen
		fontos olyan környezetben, ahol
		(például) több szervezeti
		egység használ egyetlen közös
		hálózatot és bizonyos
		felhasználók képesek
		átlépni szervezeti egységük
		határait, mivel ha a
		hozzáférést adunk nekik a
		rendszereinkhez, akkor képesek a saját
		helyükrõl használni ezeket.  Ha
		ehelyett <emphasis>csupán</emphasis> a
		nyomtatóinkat és a
		számítógépünk
		összes erõforrását akarjuk
		megosztani, akkor létrehozhatunk a
		számukra olyan <quote>token</quote>
		hozzáféréseket is, amikhez nem
		tartozik sem felhasználói
		könyvtár, sem pedig
		parancsértelmezõ (pontosabban a
		<filename>/usr/bin/false</filename>).</para>
	    </listitem>
	  </varlistentry>
	</variablelist>

      </sect3>
    </sect2>

    <sect2 xml:id="printing-advanced-acct">
      <title>A nyomtató használatának
	nyilvántartása</title>

      <indexterm>
	<primary>nyilvántartás</primary>
	<secondary>nyomtató</secondary>
      </indexterm>

      <para>Tehát szükségünk lenne a
	nyomtatások költségének
	elszámolására.  Miért is ne
	tennénk ilyet?  A papír és a tinta bizony
	pénzbe kerül, amihez még
	hozzájárulnak más egyéb
	karbantartási költségek is &mdash; a
	nyomtatók dugig vannak mindenféle mozgó
	alkatrésszel, amelyek elõbb-utóbbi el is
	romlanak.  Tegyük fel, hogy a nyomtatóink
	kapacitása, kihasználtsága és
	karbantartási költsége alapján
	már megállapítottunk egy
	elszámolási egységet (oldalanként,
	méterenként, akárminként).  De
	hogyan lássunk hozzá a nyomtatások
	költségének tényleges
	nyilvántartásához?</para>

      <para>Van egy rossz hírünk: az
	<application>LPD</application> nyomtatási rendszer
	önmaga nem tud segíteni ebben a feladatban.  A
	nyilvántartás nagyban függ a használt
	nyomtatóktól, a nyomtatott
	formátumoktól és nyomtató
	<emphasis>általunk</emphasis> kiszabott
	költségeitõl.</para>

      <para>A nyilvántartás
	létrehozásához át kell írnunk
	a nyomtatóhoz tartozó szûrõt (a nyers
	szövegek költségének
	felszámításához) és
	konverziós szûrõket (a
	különféle formátumok
	költségei miatt), amikkel aztán
	számolhatjuk vagy lekérdezhetjük a
	kinyomtatott lapokat.  Egyetlen kimeneti szûrõ
	használatával szinte semmire se megyünk,
	mivel az nem képes nyilvántartás
	vezetésére.  Errõl bõvebb
	útmutatást a <link linkend="printing-advanced-filter-intro">Szûrõk</link>
	szakaszban találhatunk.</para>

      <para>Általánosságban véve két
	módon vezethetünk
	nyilvántartást:</para>

      <itemizedlist>
	<listitem>
	  <para>Az <emphasis>idõszakos
	    elszámolás</emphasis> a gyakoribb, mivel ez az
	    egyszerûbb.  Amikor valaki végrehajt egy
	    nyomtatási feladatot, a szûrõ a
	    nyilvántartást tároló
	    állományba feljegyzi a
	    felhasználó azonosítóját,
	    a gépének nevét és a
	    kinyomtatott oldalakat.  Ezután minden
	    hónapban, félévben, évben vagy
	    akár tetszõleges
	    idõközönként
	    összegyûjtjük a nyomtatók
	    nyilvántartásait és külön
	    feljegyezzük az egyes felhasználók
	    nyomtatásait, majd benyújtjuk róla a
	    számlát.  Töröljük az
	    összes naplóállományt, és
	    tiszta lappal kezdjük a következõ
	    idõszakot.</para>
	</listitem>

	<listitem>
	  <para>Az <emphasis>azonnali
	    elszámolás</emphasis> már nem annyira
	    népszerû, mivel nehezebb
	    megvalósítani.  Ekkor a
	    felhasználók már közvetlenül
	    a nyomtatás után megkapják a
	    számlát, hasonlóan a
	    lemezkvótákhoz.  Meg tudjuk akadályozni
	    ezzel azt is, hogy a felhasználók
	    túlléphessék az elõre kiszabott
	    <quote>nyomtatási kvótájukat</quote>,
	    amit persze menet közben lehet ellenõrizni
	    és állítgatni.  A
	    felhasználók és kvótájuk
	    nyomonkövetéséhez viszont
	    szükségünk lesz egy kis
	    adatbáziskezelésre is.</para>
	</listitem>
      </itemizedlist>

      <para>Az <application>LPD</application> nyomtatási rendszer
	mind a két módszer kivitelezéséhez
	tud segítséget nyújtani, hiszen amikor
	szûrõket állítunk be (vagyis szinte
	mindig), lehetõségünk van a
	nyilvántartást végzõ
	programrészleteket is beilleszteni.  És ami
	feltétlenül elõnyös: óriási
	mértékû rugalmasságot ajánl fel
	a nyilvántartás
	megvalósításához.
	Például magunk választhatjuk ki, hogy
	idõszakos vagy azonnali elszámolást
	alkalmazunk.  Meg tudjuk adni, milyen
	információkat rögzítsünk:
	felhasználói neveket,
	számítógépek neveit, a
	nyomtatási feladatok típusát, vagy a
	kinyomtatott oldalakat, a felhasznált lapok
	területét, a nyomtatások idõbeli
	igényeit és így tovább.  Ehhez
	mindössze csak a szûrõket kell
	módosítani.</para>

      <sect3>
	<title>Nyilvántartás gyorsan és
	  egyszerûen</title>

	<para>A &os;-ben egybõl találunk is két
	  programot, amivel pillanatok alatt ki tudunk alakítani
	  egy egyszerû idõszakos elszámolási
	  rendszert.  Ezek <link linkend="printing-advanced-lpf">Az lpf
	    szövegszûrõ</link> címû szakaszban
	  ismertetett <command>lpf</command> és a
	  nyomtatók nyilvántartásait
	  tartalmazó állományok adatainak
	  összegyûjtését és
	  kiértékelését végzõ
	  &man.pac.8;.</para>

	<para>Ahogy korábban már leírtuk a
	  szûrõkrõl szóló szakaszban (<link linkend="printing-advanced-filters">Szûrõk</link>),
	  az <application>LPD</application> a szöveg- és
	  konverziós szûrõket parancssorból a
	  nyilvántartást tároló
	  állomány nevével indítja el.  Ezt
	  a paramétert a szûrõk aztán fel
	  tudják használni a nyilvántartások
	  feljegyzéséhez.  Az állomány
	  nevét az <filename>/etc/printcap</filename>
	  állományban szereplõ <literal>af</literal>
	  tulajdonsággal tudjuk megadni, vagy teljes
	  elérési úttal, vagy pedig a
	  nyomtatási könyvtárhoz
	  viszonyítva.</para>

	<para>Az <application>LPD</application> az
	  <command>lpf</command> szûrõt a lap
	  szélességének és hosszának
	  megadásával indítja el (ezeket az
	  értékeket a <literal>pw</literal> és
	  <literal>pl</literal> tulajdonságokból
	  származtatja).  Az <command>lpf</command> ezek
	  felhasználásával meg tudja mondani,
	  mennyi papírt használtunk el.  Miután
	  kiküldte az állományt a nyomtatóra,
	  nyilvántartásba is veszi.  Ezek a
	  típusú bejegyzések valahogy így
	  néznek ki:</para>

	<programlisting>2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</programlisting>

	<para>Minden nyomtatóhoz érdemes külön
	  nyilvántartást vezetni, mivel az
	  <command>lpf</command> nem tartalmaz semmilyen
	  beépített zárolási
	  megoldást, ezért két
	  <command>lpf</command> párhuzamos futtatása
	  könnyen összezagyválhatja a közösen
	  használt nyilvántartások
	  tartalmát.  Az <filename>/etc/printcap</filename>
	  állományban az <literal>af=acct</literal>
	  tulajdonság megadásával könnyen
	  létre tudunk hozni minden nyomtatóhoz
	  külön nyilvántartást.  Ilyenkor minden
	  nyomtató könyvtárában megjelenik egy
	  <filename>acct</filename> nevû
	  állomány.</para>

	<para>Amikor elérkezünk a nyomtatások
	  kiszámlázásához, futtassuk le a
	  &man.pac.8; programot.  Ehhez mindössze annyit kell
	  tennünk, hogy átlépünk az
	  elszámolni kívánt nyomtató
	  könyvtárába és
	  begépeljük a <command>pac</command> parancsot.
	  Ekkor kapunk egy ehhez hasonló, dollár
	  alapú kimutatást:</para>

	<screen>  Login               pages/feet   runs    price
orchid:kelly                5.00    1   $  0.10
orchid:mary                31.00    3   $  0.62
orchid:zhang                9.00    1   $  0.18
rose:andy                   2.00    1   $  0.04
rose:kelly                177.00  104   $  3.54
rose:mary                  87.00   32   $  1.74
rose:root                  26.00   12   $  0.52

total                     337.00  154   $  6.74</screen>

	<para>A &man.pac.8; a következõ paramétereket
	  várja:</para>

	<variablelist>
	  <varlistentry>
	    <term><option>-P<replaceable>nyomtató</replaceable></option></term>
	    <listitem>
	      <para>Az kiértékelendõ
		<replaceable>nyomtató</replaceable> neve.  Ez a
		paraméter csak akkor használható,
		ha az <filename>/etc/printcap</filename>
		állományban az <literal>af</literal>
		tulajdonságnak teljes elérési utat
		adtunk meg.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-c</option></term>
	    <listitem>
	      <para>A felhasználók nevei helyett a
		fizetendõ összeg szerint rendezze a
		listát.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-m</option></term>
	    <listitem>
	      <para>Hagyja figyelmen kívül a
		nyilvántartásban szereplõ
		gépek hálózati neveit.  Ennek
		hatására az <systemitem>alpha</systemitem>
		géprõl nyomtató
		<systemitem class="username">smith</systemitem> meg fog egyezni a
		<systemitem>gamma</systemitem> géprõl
		nyomtatóval.  A beállítás
		nélkül ez a két
		felhasználó el fog térni.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-p<replaceable>ár</replaceable></option></term>
	    <listitem>
	      <para>A paraméterként megadott
		<replaceable>ár</replaceable> dollár
		értékkel számol oldalanként
		vagy lábanként az
		<filename>/etc/printcap</filename>
		állományban megadott <literal>pc</literal>
		tulajdonság értéke helyett (ami
		alapból két cent).  Az
		<replaceable>ár</replaceable> lebegõpontos
		(valós) számként is
		megadható.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-r</option></term>
	    <listitem>
	      <para>A rendezési sorrend
		megfordítása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-s</option></term>
	    <listitem>
	      <para>Hozzon létre egy elszámolást,
		majd törölje a hozzá
		kapcsolódó nyilvántartási
		adatokat.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><replaceable>név</replaceable>
	      <replaceable>&hellip;</replaceable></term>
	    <listitem>
	      <para>Csak az adott <replaceable>nevû</replaceable>
		felhasználók adatait
		értékelje ki.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>

	<para>A &man.pac.8; által alapértelmezés
	  szerint generált kimutatásban láthatjuk
	  az egyes gépekrõl származó egyes
	  felhasználók kinyomtatott oldalait.  Ha
	  nekünk viszont nem számít, hogy honnan
	  küldték a kéréseket (mivel
	  bárhonnan lehet küldeni), akkor a
	  <command>pac -m</command> paranccsal az
	  alábbi táblázatot
	  készíttethetjük el:</para>

	<screen>  Login               pages/feet   runs    price
andy                        2.00    1   $  0.04
kelly                     182.00  105   $  3.64
mary                      118.00   35   $  2.36
root                       26.00   12   $  0.52
zhang                       9.00    1   $  0.18

total                     337.00  154   $  6.74</screen>

	<para>Itt megtaláljuk a ténylegesen
	  kifizetendõ összegeket is, amik
	  kiszámításához a &man.pac.8; az
	  <filename>/etc/printcap</filename> állomány
	  <literal>pc</literal> tulajdonságát
	  használja (ez alapból 200, avagy 2 cent
	  oldalanként).  Ezzel a tulajdonsággal
	  tehát egy cent századrészében
	  mérve tudjuk megadni az oldalakénti vagy
	  lábankénti árakat.  Ezt a
	  beállítást természetesen a
	  &man.pac.8; <option>-p</option> opciójával
	  felül tudjuk bírálni.  Arra azonban
	  vigyázzunk, hogy a <option>-p</option> után
	  dollárban kell megadnunk az árat.  Emiatt
	  tehát a</para>

	<screen>&prompt.root; <userinput>pac -p1.50</userinput></screen>

	<para>parancs szerint minden egyes oldal másfél
	  dollárba fog kerülni.  Ezzel az opcióval
	  aztán alaposan megdönthetjük az
	  árakat.</para>

	<para>Végezetül megemlítjük, hogy a
	  <command>pac -s</command> parancs az
	  általa létrehozott elszámolást egy
	  külön állományba menti, amelynek a
	  neve nagyjából megegyezik a
	  nyilvántartást végzõével, de
	  <literal>_sum</literal>-ra (mint <quote>summary</quote>, azaz
	  elszámolás) végzõdik.  Ezután
	  nullázza a nyilvántartást.  Amikor a
	  &man.pac.8; programot újra lefuttatjuk,
	  újból beolvassa a korábban elmentett
	  elszámolásokat, majd hozzászámolja
	  a többit a hagyományos
	  nyilvántartási adatokból.</para>

      </sect3>

      <sect3>
	<title>Hogyan tudjuk számolni a kinyomtatott
	  lapokat?</title>

	<para>A nyilvántartás pontos
	  vezetéséhez még távolról is
	  valamilyen módon meg kell tudnunk mondani, hogy mennyi
	  lapot használt egy nyomtatási feladat
	  végrehajtása.  Ez a nyomtatás
	  nyilvántartásának egyik alapvetõ
	  problémája.</para>

	<para>A nyers szövegek esetében ez nem is annyira
	  bonyolult: egyszerûen számoljuk össze, hogy a
	  nyomtatási feladatban mennyi sor
	  kinyomtatására lesz szükség
	  és vessük össze ezt a nyomtató
	  által lapoként kinyomtatott sorok
	  számálva.  Ne felejtsük el
	  számításba venni a szövegben
	  felbukkanó törlések hatását,
	  vagy az olyan hosszú sorokat, amelyek a
	  valóságban több sorban fognak
	  megjelenni.</para>

	<para>Viszont (<link linkend="printing-advanced-lpf">Az lpf
	    szövegszûrõ</link> címû
	  szakaszban bemutatott) <command>lpf</command> program ezeket
	  mind lekezeli a nyilvántartások
	  készítése során.  Ezért ha
	  szintén egy nyilvántartást vezetni
	  képes szövegszûrõt akarunk írni,
	  akkor mindenképpen érdemes
	  megnéznünk az <command>lpf</command>
	  forráskódját.</para>

	<para>De hogyan bánjunk el a többi
	  formátummal?</para>

	<para>Nos, a DVI-Laserjet és DVI-&postscript; közti
	  átalakítások esetén a kinyomtatott
	  lapok számának
	  megállapításához meg kell
	  tanítanunk a szûrõnket értelmezni a
	  <command>dvilj</command> vagy <command>dvips</command>
	  parancsok kimenetét.  Ugyanezt meg tudjuk tenni
	  más formátumok és más
	  konverziós programok használata során
	  is.</para>

	<para>Azonban ezek a módszerek nem veszik
	  számításba, hogy a nyomtató
	  egyáltalán kinyomtatta-e az összes
	  elküldött oldalt.  Sok minden történhet
	  még addig, például beragadhat a
	  papír, kifogyhat a tinta vagy akár felrobbanhat
	  a nyomtató &mdash; a felhasználónak
	  ettõl függetlenül még fizetnie
	  kell.</para>

	<para>Mit lehet ilyenkor tenni?</para>

	<para>A <emphasis>precíz</emphasis>
	  nyilvántartásnak csak egyetlen
	  <emphasis>biztos</emphasis> módja létezik.
	  Olyan nyomtatót szerezzünk be, amely képes
	  megmondani, mennyi lapot használt el a nyomtatás
	  során, majd egy ilyet csatlakoztassunk soros porton
	  vagy hálózaton keresztül.  Szinte majdnem
	  az összes &postscript; nyomtató támogatja
	  ezt a lehetõséget, ahogy sok más
	  gyártmány és típus is
	  (például a hálózati Imagen
	  lézernyomtatók).  A nyomtatóhoz
	  tartozó szûrõt ehhez úgy kell
	  módosítani, hogy lekérdezzük a
	  kinyomtatott lapok számát a nyomtatás
	  után és
	  <emphasis>kizárólag</emphasis> erre az
	  értékre alapozva készítünk
	  nyilvántartást.  Itt nincs szükség
	  sem a sorok számolására, sem pedig az
	  állományok (könnyen
	  elhibázható)
	  átvizsgálására.</para>

	<para>Természetesen lehetünk nagylelkûek
	  és ne számítsunk fel semmit a
	  nyomtatásért.</para>

      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="printing-using">
    <title>A nyomtatók használata</title>

    <indexterm>
      <primary>nyomtató</primary>
      <secondary>használat</secondary>
    </indexterm>

    <para>Ebbõl a szakaszból megtudhatjuk, hogyan
      használjuk a &os;-n beállított
      nyomtatónkat.  Röviden most itt foglaljuk össze
      az ide tartozó felhasználói
      parancsokat:</para>

    <variablelist>
      <varlistentry>
	<term>&man.lpr.1;</term>
	<listitem>
	  <para>Nyomtatási feladatokat hajt végre.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>&man.lpq.1;</term>
	<listitem>
	  <para>Ellenõrzi a nyomtatási sorokat.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>&man.lprm.1;</term>
	<listitem>
	  <para>Feladatokat vesz ki a nyomtatási
	    sorokból.</para>
	</listitem>
      </varlistentry>
    </variablelist>

    <para>Ezek mellett létezik még a nyomtatók
      és a hozzájuk tartozó sorok
      irányítására alkalmas parancs is, az
      &man.lpc.8;, amelyre a <link linkend="printing-lpc">A
	nyomtatók vezérlése</link> címû
      szakaszban fogunk részleteiben kitérni.</para>

    <para>A nyomtatók/sorok <filename>/etc/printcap</filename>
      állományban szereplõ nevük szerinti
      megadásához az &man.lpr.1;, &man.lprm.1; és
      &man.lpq.1; parancsok közül mindegyik elfogadja a
      <option>-P
      <replaceable>nyomtatónév</replaceable></option>
      paramétert.  Ennek köszönhetõen
      képesek vagyunk nyomtatási feladatokat küldeni,
      eltávolítani vagy felügyelni az egyes
      nyomtatók soraiban.  Ha nem használjuk a
      <option>-P</option> kapcsolót, akkor az érintett
      nyomtató a <envar>PRINTER</envar> környezeti
      változó által meghatározott lesz.
      Végül, ha a <envar>PRINTER</envar> nevû
      környezeti változót sem
      állítottuk be, akkor a parancsok
      alapértelmezett módon az <command>lp</command>
      nevû nyomtatót fogják használni.</para>

    <para>A továbbiakban az <emphasis>alapértelmezett
      nyomtató</emphasis> kifejezés a
      <envar>PRINTER</envar> környezeti változó
      által megnevezett nyomtatóra fog utalni, illetve ha
      ezt nem definiáltuk, akkor az <literal>lp</literal>
      nevû nyomtatóra.</para>

    <sect2 xml:id="printing-lpr">
      <title>Nyomtatási feladatok
	végrehajtása</title>

      <para>Az állományok kinyomtatásához
	írjuk be:</para>

      <screen>&prompt.user; <userinput>lpr állománynév ...</userinput></screen>

      <indexterm><primary>nyomtatás</primary></indexterm>

      <para>Ezzel kinyomtatjuk az összes felsorolt
	állományt az alapértelmezett
	nyomtatón.  Ha nem adunk meg állományokat,
	akkor az &man.lpr.1; parancs a szabványos bemenetrõl
	várja a nyomtatandó adatokat.
	Például ezzel a paranccsal néhány
	igen fontos rendszerállományt tudunk
	kinyomtatni:</para>

      <screen>&prompt.user; <userinput>lpr /etc/host.conf /etc/hosts.equiv</userinput></screen>

      <para>A nyomtató megválasztásához
	így adjuk ki a parancsot:</para>

      <screen>&prompt.user; <userinput>lpr -P nyomtatónév állománynév ...</userinput></screen>

      <para>Ez a példa kinyomtatja az aktuális
	könyvtár részletes listáját a
	<literal>rattan</literal> nevû nyomtatón:</para>

      <screen>&prompt.user; <userinput>ls -l | lpr -P rattan</userinput></screen>

      <para>Mivel egyetlen állományt sem adtunk meg az
	&man.lpr.1; programnak, az <command>lpr</command> parancs a
	nyomtatandó adatokat a szabványos bemenetrõl
	várja, ami jelen esetünkben a
	<command>ls -l</command> parancs
	kimenete.</para>

      <para>Az &man.lpr.1; ezeken felül még képes
	értelmezni rengeteg formázásra,
	konverzióra, másolatok
	készítésére stb.
	utasító kapcsolót is.  Errõl
	bõvebben a <link linkend="printing-lpr-options">Nyomtatási
	  beállítások</link> címû
	szakaszban lesz szó.</para>

    </sect2>

    <sect2 xml:id="printing-lpq">
      <title>Nyomtatási feladatok felügyelete</title>

      <indexterm><primary>nyomtatási
	feladatok</primary></indexterm>

      <para>Amikor az &man.lpr.1; programmal nyomtatunk, az összes
	nyomtatandónk egy <quote>nyomtatási
	feladatnak</quote> nevezett csomagba kerül, ami pedig az
	<application>LPD</application> nyomtatási
	rendszerébe.  Minden nyomtatóhoz tartozik egy
	nyomtatási sor, ahol részünkrõl
	és mások által eddig kiadott
	nyomtatási feladatokat találhatjuk.  A
	nyomtató ezután ezeket érkezési
	sorrend szerint dolgozza fel.</para>

      <para>Az alapértelmezett nyomtatóhoz tartozó
	sor állapotát az &man.lpq.1; programmal tudjuk
	megnézni.  Ha egy adott nyomtatóra vagyunk
	kíváncsiak, akkor használjuk a
	<option>-P</option> kapcsolót.  Például a</para>

      <screen>&prompt.user; <userinput>lpq -P bamboo</userinput></screen>

      <para>parancs a <literal>bamboo</literal> nevû
	nyomtató sorát fogja megmutatni.
	Példaképpen lássuk is ilyen esetben az
	<command>lpq</command> parancs eredményét:</para>

      <screen>bamboo is ready and printing
Rank   Owner    Job  Files                              Total Size
active kelly    9    /etc/host.conf, /etc/hosts.equiv   88 bytes
2nd    kelly    10   (standard input)                   1635 bytes
3rd    mary     11   ...                                78519 bytes</screen>

      <para>Itt három nyomtatási feladatot
	láthatunk a <literal>bamboo</literal> nyomtatási
	sorában.  Az elsõ nyomtatási feladat, amit a
	<systemitem class="username">kelly</systemitem> nevû felhasználó
	küldött, a 9-es <quote>feladatszámot</quote>
	kapta.  A nyomtatóhoz tartozó összes feladat
	kap egy ilyen egyedi számot.  Többnyire nyugodtan
	figyelmen kívül hagyhatjuk, azonban
	szükségünk lehet rá, ha éppen
	törölni kívánjuk a
	hozzá tartozó nyomtatási feladatot.  Ezzel
	majd a <link linkend="printing-lprm">Nyomtatási feladatok
	  eltávolítása</link> címû
	szakaszban foglalkozunk.</para>

      <para>A kilences számú nyomtatási feladat
	két állományt tartalmaz: ha a parancssorban
	több állományt adunk meg az &man.lpr.1;
	programnak, akkor az egy nyomtatási feladatnak
	számít.  Ez egyben a pillanatnyilag aktív
	nyomtatási feladat (ezt a <quote>Rank</quote> oszlopban
	szereplõ <literal>active</literal> érték
	jelzi), tehát a nyomtató éppen ezzel
	foglalatoskodik.  A második nyomtatási feladat
	közvetlenül az &man.lpr.1; szabványos
	bemenetére érkezett.  A harmadik a
	<systemitem class="username">mary</systemitem> nevû
	felhasználótól jött, és ez egy
	nagyobb méretû nyomtatási feladat.  A
	nyomtatandó állomány elérési
	útvonala túlságosan hosszú ahhoz,
	hogy ki lehessen írni, ezért az &man.lpr.1; csak
	három pontot jelez ki helyette.</para>

      <para>Az &man.lpq.1; kimenetének elsõ sorai is nagyon
	hasznos információt tartalmaz: megtudhatjuk, mit
	csinál éppen (legalább is az
	<application>LPD</application> szerint) a
	nyomtató.</para>

      <para>A <option>-l</option> kapcsolóval az &man.lpq.1;
	parancstól kérhetünk sokkal
	részletesebb listázást is.
	Például így nézhet ki a
	<command>lpq -l</command>
	parancs eredménye:</para>

      <screen>waiting for bamboo to become ready (offline ?)
kelly: 1st				 [job 009rose]
       /etc/host.conf                    73 bytes
       /etc/hosts.equiv                  15 bytes

kelly: 2nd				 [job 010rose]
       (standard input)                  1635 bytes

mary: 3rd                                [job 011rose]
      /home/orchid/mary/research/venus/alpha-regio/mapping 78519 bytes</screen>

    </sect2>

    <sect2 xml:id="printing-lprm">
      <title>Nyomtatási feladatok
	eltávolítása</title>

      <para>Ha meggondoltuk volna magunkat egy nyomtatási
	feladattal kapcsolatban, az &man.lprm.1; paranccsal még
	törölni tudjuk a sorból.  Az &man.lprm.1;
	gyakran még a folyamatban levõ nyomtatási
	feladatot is képes eltávolítani, azonban
	elõfordulhat, hogy a nyomtatási feladat egy
	része már elvégzésre
	került.</para>

      <para>Az alapértelmezett nyomtató
	sorából csak úgy tudunk nyomtatási
	feladatokat törölni, ha elõször az
	&man.lpq.1; segítségével megkeressük a
	számukat.  Ha ez megvan, írjuk be:</para>

      <screen>&prompt.user; <userinput>lprm feladatám</userinput></screen>

      <para>Adott nyomtatóról a <option>-P</option>
	kapcsoló segítségével tudunk
	nyomtatási feladatot törölni.  A most
	következõ parancs a <literal>bamboo</literal>
	nevû nyomtatóról törli a 10-es
	számú nyomtatási feladatot:</para>

      <screen>&prompt.user; <userinput>lprm -P bamboo 10</userinput></screen>

      <para>Az &man.lprm.1; parancs esetén még
	használhatóak az alábbi
	rövidítések is:</para>

      <variablelist>
	<varlistentry>
	  <term>lprm -</term>
	  <listitem>
	    <para>Eltávolítja a hozzánk
	      tartozó az összes nyomtatási feladatot
	      (az alapértelmezett nyomtatón).</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>lprm <replaceable>felhasználó</replaceable></term>
	  <listitem>
	    <para>Eltávolítja az adott
	      <replaceable>felhasználó</replaceable>hoz
	      tartozó összes nyomtatási feladatot (az
	      alapértelmezett nyomtatón).
	      Kizárólag a rendszergazdák
	      képesek erre, a rendes felhasználók
	      csak a saját nyomtatási feladataikat
	      törölhetik.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>lprm</term>
	  <listitem>
	    <para>A nyomtatási feladat száma, a
	      felhasználói név vagy a
	      <option>-</option>megadása nélkül az
	      &man.lprm.1; törli az alapértelmezett
	      nyomtatón éppen aktív
	      nyomtatási feladatot, amennyiben az a miénk.
	      Csak a rendszergazdák képesek
	      bármilyen aktív nyomtatási feladatot
	      törölni.</para>
	  </listitem>
	</varlistentry>
      </variablelist>

      <para>Ha kiegészítjük az imént
	említett rövidítéséket a
	<option>-P</option> paraméter megadásával,
	akkor az alapértelmezett nyomtató helyett
	bármelyik másikat is használhatjuk.
	Például ez a parancs eltávolítja az
	aktuális felhasználó összes
	nyomtatási feladatot a <literal>rattan</literal>
	nevû nyomtatón:</para>

      <screen>&prompt.user; <userinput>lprm -P rattan -</userinput></screen>

      <note>
	<para>Hálózati környezetben az &man.lprm.1;
	  csak arról a géprõl engedi
	  törölni a nyomtatási feladatokat,
	  amelyrõl küldték ezeket, még abban az
	  esetben is, amikor ugyanaz a nyomtató más
	  számítógépekrõl is
	  elérhetõ.  A következõ parancssorozat
	  ezt igyekszik szemléltetni:</para>

	<screen>&prompt.user; <userinput>lpr -P rattan myfile</userinput>
&prompt.user; <userinput>rlogin orchid</userinput>
&prompt.user; <userinput>lpq -P rattan</userinput>
Rank   Owner	  Job  Files                          Total Size
active seeyan	  12	...                           49123 bytes
2nd    kelly      13   myfile                         12 bytes
&prompt.user; <userinput>lprm -P rattan 13</userinput>
rose: Permission denied
&prompt.user; <userinput>logout</userinput>
&prompt.user; <userinput>lprm -P rattan 13</userinput>
dfA013rose dequeued
cfA013rose dequeued
	</screen>
      </note>

    </sect2>

    <sect2 xml:id="printing-lpr-options">
      <title>Túl a nyers szövegen: nyomtatási
	beállítások</title>

      <para>Az &man.lpr.1; parancs számos olyan
	beállítást enged, amelyekkel a
	szövegek formázását, grafikák
	átalakítását illetve más
	állományformátumok
	használatát, másolatok
	készítését, nyomtatási
	feladatok irányítását és
	még sok minden mást el tudunk végezni.
	Ebben a szakaszban pontosan ezekrõl a
	kapcsolókról lesz szó.</para>

      <sect3 xml:id="printing-lpr-options-format">
	<title>Formázási és konverziós
	  beállítások</title>

	<para>Az &man.lpr.1; most következõ opciói a
	  nyomtatási feladatokban található
	  állományok formázását
	  vezérlik.  Akkor használjuk ezeket a
	  beállításokat, ha a nyomtatási
	  feladat nem tartalmaz nyers szöveget, vagy ha nyers
	  szöveget akarunk formázni a &man.pr.1;
	  segédprogrammal.</para>

	<indexterm><primary>&tex;</primary></indexterm>

	<para>Például az alábbi parancs kinyomtat
	  egy
	  <filename>halászati-jelentés.dvi</filename>
	  nevû (a &tex; betûszedû rendszerbõl
	  már jól ismert) DVI állományt a
	  <literal>bamboo</literal> nevû nyomtatón:</para>

	<screen>&prompt.user; <userinput>lpr -P bamboo -d halászati-jelentés.dvi</userinput></screen>

	<para>Ezek a beállítások a
	  nyomtatási feladatban szereplõ minden egyes
	  állományra vonatkoznak, ezért nem
	  keverhetjük (például) a DVI és
	  ditroff formátumú állományokat egy
	  nyomtatási feladaton belül.  Ehelyett
	  külön nyomtatási feladatokban kell
	  elküldenünk az eltérõ
	  formátumú állományokat, és
	  mindegyik nyomtatási feladathoz külön
	  konverziós beállításokat kell
	  megadnunk.</para>

	<note>
	  <para>A <option>-p</option> és <option>-T</option>
	    kapcsolók kivételével az itt felsorolt
	    összes beállításnak a
	    kiválasztott nyomtatóhoz szüksége
	    van a megfelelõ konverziós szûrõre.
	    Például a <option>-d</option> opció
	    használatához kell egy konverziós
	    szûrõ a DVI formátumhoz.  A <link linkend="printing-advanced-convfilters">Konverziós
	      szûrõk</link> címû szakasz
	    errõl ad bõvebb
	    tájékoztatást.</para>
	</note>

	<variablelist>
	  <varlistentry>
	    <term><option>-c</option></term>
	    <listitem>
	      <para>Cifplot állományok
		nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-d</option></term>
	    <listitem>
	      <para>DVI állományok
		nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-f</option></term>
	    <listitem>
	      <para>FORTRAN forrás nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-g</option></term>
	    <listitem>
	      <para>Plot formátumú adatok
		nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-i <replaceable>szám</replaceable></option></term>
	    <listitem>
	      <para>A kinyomtatott szöveg
		behúzásának növelése a
		<replaceable>szám</replaceable>
		értékével.  Ha nem adjuk meg a
		<replaceable>számot</replaceable>, akkor ennek
		értéke 8 lesz.  Ez a
		beállítás csak bizonyos
		konverziós szûrõkkel
		mûködik.</para>

	      <note>
		<para>Ne hagyjunk helyet az <option>-i</option>
		  és a szám között.</para>
	      </note>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-l</option></term>
	    <listitem>
	      <para>A szöveg formázás
		nélküli nyomtatása,
		vezérlõkarakterekkel együtt.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-n</option></term>
	    <listitem>
	      <para>Ditroff (eszközfüggetlen troff) adat
		nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-p</term>
	    <listitem>
	      <para>Nyomtatás elõtt a szöveg
		formázása a &man.pr.1; programmal.
		Lásd &man.pr.1;.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-T
	      <replaceable>cím</replaceable></option></term>
	    <listitem>
	      <para>Az állomány neve helyett a
		fejlécben a <replaceable>címet</replaceable>
		jeleníti meg a &man.pr.1;.  Ennek a
		beállításnak csak a
		<option>-p</option> opcióval együtt van
		hatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-t</option></term>
	    <listitem>
	      <para>Troff adat nyomtatása.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term><option>-v</option></term>
	    <listitem>
	      <para>Raszteres adatok nyomtatása.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>

	<para>Vegyünk az iméntiekre egy
	  példát.  A következõ parancs az
	  &man.ls.1; szépen megformázott man
	  oldalát nyomtatja ki az alapértelmezett
	  nyomtatón:</para>

	<screen>&prompt.user; <userinput>zcat /usr/share/man/man1/ls.1.gz | troff -t -man | lpr -t</userinput></screen>

	<para>A &man.zcat.1; kitömöríti az &man.ls.1;
	  man oldalának forrását és
	  átadja a &man.troff.1; parancsnak, ami ebbõl
	  létrehoz a GNU troff formátumának
	  megfelelõ kimenetet és továbbadja az
	  &man.lpr.1; parancsnak, ami végül elküldi a
	  nyomtatási feladatot az <application>LPD</application>
	  nyomtatási rendszernek.  Mivel az &man.lpr.1;
	  parancsnak megadtuk az <option>-t</option> kapcsolót, a
	  nyomtatási rendszer a GNU troff formátumban
	  érkezõ adatokat magától át
	  fogja alakítani olyan formátumra, amit a
	  nyomtató is képes lesz megérteni.</para>
      </sect3>

      <sect3 xml:id="printing-lpr-options-job-handling">
	<title>Nyomtatási feladatok kezelése</title>

	<para>Az &man.lpr.1; most felsorolandó
	  beállításaival az
	  <application>LPD</application> rendszert arra tudjuk
	  utasítani, hogy a nyomtatási feladatot
	  különleges módon kezelje:</para>

	<variablelist>
	  <varlistentry>
	    <term>-#
	      <replaceable>példányszám</replaceable></term>
	    <listitem>
	      <para>Egyetlen példány helyett hozzon
		létre
		<replaceable>példányszám</replaceable>
		számú példányt a
		nyomtatási feladatban található
		összes állományból.  A
		rendszergazda a nyomtató
		kímélése érdekében
		ezt a lehetõséget letilthatja, amivel
		inkább a fénymásoló
		használatára ösztönzi a
		felhasználókat.  Lásd <link linkend="printing-advanced-restricting-copies">A
		  másolatok számának
		  szabályozása</link> szakasz.</para>

	      <para>A beállítás
		illusztrálásaként most az
		alapértelmezett nyomtatón
		elõször nyomtassunk ki három
		példányt a
		<filename>parser.c</filename>,
		majd ezután a
		<filename>parser.h</filename>
		állományokból:</para>

	      <screen>&prompt.user; <userinput>lpr -#3 parser.c parser.h</userinput></screen>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-m</term>
	    <listitem>
	      <para>A rendszer küldjön levelet a
		nyomtatási feladat teljesítése
		után.  Ekkor az <application>LPD</application> a
		nyomtatási feladat elvégzése
		után levelet küld a helyi
		postafiókunkba.  A levélben kifejti, hogy
		sikeres volt-e a nyomtatás, vagy esetleg
		valamilyen hiba keletkezett, és ha hiba
		történt, akkor pontosan mi is volt
		az.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-s</term>
	    <listitem>
	      <para>Ne másolja közvetlenül az
		állományokat a nyomtatási
		könyvtárba, hanem készítsen
		hozzájuk szimbolikus linkeket.</para>

	      <para>Egy nagyobb nyomtatási feladat
		elvégzése esetén javasolt
		használni ezt a kapcsolót.  Ezzel a
		megoldással helyet tudunk spórolni a
		nyomtatási könyvtárban (amikor a
		nyomtatási feladatok könnyen
		megtelítheti a nyomtatási
		könyvtárat tároló
		állományrendszert).  Emellett idõt is
		takarítunk meg, mivel az
		<application>LPD</application>-nek nem kell a
		nyomtatási feladat minden egyes bitjét
		átmásolni a nyomtatási
		könyvtárba.</para>

	      <para>Van azonban egy hátránya: mivel az
		<application>LPD</application> ekkor
		közvetlenül az eredeti
		állományra fog hivatkozni, ezért a
		nyomtatás befejezéséig azt nem
		módosíthatjuk vagy
		törölhetjük.</para>

	      <note>
		<para>Ha egy távoli nyomtatónak
		  küldjük a nyomtatási feladatot, akkor
		  az <application>LPD</application> a helyi és a
		  távoli számítógép
		  között mégis kénytelen lesz
		  átmásolni a nyomtatási feladatot,
		  így a <option>-s</option> kapcsoló
		  egyedül csak a helyi nyomtatási
		  könyvtárban fog helyet spórolni.
		  Ettõl eltekintve még ilyenkor is
		  hasznunkra válhat.</para>
	      </note>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-r</term>
	    <listitem>
	      <para>Törölje a nyomtatási feladatban
		szereplõ állományokat, miután
		átmásolta ezeket a nyomtatási
		könyvtárba, vagy miután a
		<option>-s</option> kapcsoló
		használatával kinyomtatta ezeket.  Nagy
		körültekintéssel
		használjuk!</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </sect3>

      <sect3 xml:id="printing-lpr-options-misc">
	<title>A fejléclapok
	  beállításai</title>

	<para>Az &man.lpr.1; most következõ
	  beállításai a nyomtatási feladatok
	  fejlécében megjelenõ szövegekre vannak
	  hatással.  Így ha letiltottuk a
	  fejléclapok használatát, akkor ezek a
	  kapcsolók lényegében semmit sem
	  állítanak.  A <link linkend="printing-advanced-header-pages">Fejléclapok</link>
	  címû szakaszból tudhatunk meg többet
	  ezek beállításáról.</para>

	<variablelist>
	  <varlistentry>
	    <term>-C <replaceable>szöveg</replaceable></term>
	    <listitem>
	      <para>A fejléclapon megjelenõ
		hálózati név helyett a
		<replaceable>szöveg</replaceable> fog szerepelni.
		A hálózati név
		általában annak a gépnek a neve,
		ahonnan a nyomtatási feladatot
		küldték.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-J <replaceable>szöveg</replaceable></term>
	    <listitem>
	      <para>A fejléclapon megjelenõ
		nyomtatási feladat neve helyett a
		<replaceable>szöveg</replaceable> fog megjelenni.
		A nyomtatási feladat neve általában
		a benne szereplõ elsõ állomány
		nevével egyezik meg, ha a szabványos
		bemenetrõl nyomtatunk, akkor egyszerûen csak
		<filename>stdin</filename>.</para>
	    </listitem>
	  </varlistentry>

	  <varlistentry>
	    <term>-h</term>
	    <listitem>
	      <para>Ne nyomtasson fejléclapot.</para>

	      <note>
		<para>Bizonyos helyeken elõfordulhat, hogy ennek a
		  kapcsolónak nincs semmilyen hatása a
		  fejléclapok létrehozásának
		  módszerébõl fakadóan.  A
		  részleteket lásd a <link linkend="printing-advanced-header-pages">Fejléclapok</link>
		  szakaszban.</para>
	      </note>
	    </listitem>
	  </varlistentry>
	</variablelist>

      </sect3>
    </sect2>

    <sect2 xml:id="printing-lpc">
      <title>A nyomtatók vezérlése</title>

      <para>A nyomtatóink rendszergazdájaként
	nekünk kell telepítenük, üzembe
	helyeznünk és kipróbálnunk ezeket.  Az
	&man.lpc.8; parancs használatával még
	jobban képesek vagyunk kapcsolatba lépni
	velük.  Az &man.lpc.8; paranccsal:</para>

      <itemizedlist>
	<listitem>
	  <para>el tudjuk indítani és le tudjuk
	    állítani a nyomtatókat;</para>
	</listitem>

	<listitem>
	  <para>be- és ki tudjuk kapcsolni a nyomtatási
	    soraikat;</para>
	</listitem>

	<listitem>
	  <para>át tudjuk rendezni az egyes sorokban
	    található nyomtatási
	    feladatokat.</para>
	</listitem>
      </itemizedlist>

      <para>Elõször is essen pár szó a
	fogalmakról: ha a nyomtató
	<emphasis>leállt</emphasis>, akkor semmit sem fog
	kinyomtatni a sorából.  A
	felhasználók továbbra is képesek
	nyomtatási feladatokat küldeni, amik azonban
	egészen addig fognak várakozni, amíg a
	nyomtatót <emphasis>el nem indítjuk</emphasis>
	vagy a sorát ki nem ürítjük.</para>

      <para>Ha egy sort <emphasis>kikapcsolunk</emphasis>, akkor (a
	<systemitem class="username">root</systemitem> kivételével) egyetlen
	felhasználó sem képes nyomtatási
	feladatokat küldeni a nyomtatónak.  A
	<emphasis>bekapcsolt</emphasis> sorok képesek csak
	nyomtatási feladatot fogadni.  A nyomtató
	<emphasis>elindítható</emphasis> kikapcsolt sorral
	is, ilyenkor egészen addig folytatja a nyomtatási
	feladatok elvégzését, amíg a sor ki
	nem ürül.</para>

      <para>Általánosan elmondható, hogy az
	&man.lpc.8; parancs használatához a
	<systemitem class="username">root</systemitem> felhasználó
	jogosultságaira van szükségünk.  Az
	&man.lpc.8; parancsot minden más esetben csak a
	nyomtató állapotának
	ellenõrzésére vagy a megakadt nyomtató
	újraindítására
	használhatjuk.</para>

      <para>Foglaljuk röviden össze az &man.lpc.8; parancsait.
	A legtöbb parancs kiadásához még
	szükséges egy
	<replaceable>nyomtatónév</replaceable>
	paraméter megadása is, amivel megnevezzük az
	utasítani kívánt nyomtatót.
	Helyette használható az <literal>all</literal>
	szó is, amivel az <filename>/etc/printcap</filename>
	állományban szereplõ összes
	nyomtatót egyszerre utasíthatjuk.</para>

      <variablelist>
	<varlistentry>
	  <term><command>abort
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Az aktuális nyomtatási feladat
	      megszakítása és a nyomtató
	      leállítása.  Ha a nyomtatási
	      sort még nem kapcsoltuk ki, a
	      felhasználók küldhetnek további
	      nyomtatási feladatokat.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>clean
	    nyomtatónév</command></term>
	  <listitem>
	    <para>A nyomtató
	      könyvtárából
	      töröljük a régi
	      állományokat.  Esetenként
	      adódhat, hogy bizonyos nyomtatási feladatok
	      állományait nem takarította el az
	      <application>LPD</application>, különösen
	      abban az esetben, amikor a nyomtatás vagy az
	      adminisztrálás során keletkezett
	      valamilyen hiba.  Ez a parancs segít
	      megtalálni a nyomtatási
	      könyvtárból már kikopott
	      állományokat és törli
	      ezeket.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>disable
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Az újonnan érkezõ nyomtatási
	      feladatok besorolásának kikapcsolása.
	      Ha a nyomtató még mûködik, akkor
	      folytatni fogja a sorban még bennmaradt
	      nyomtatási feladatok
	      elvégzését.  A rendszergazda (a
	      <systemitem class="username">root</systemitem>) még a kikapcsolt sorok
	      esetén is küldhet nyomtatási
	      feladatokat.</para>

	    <para>Ez a parancs valójában akkor hasznos, ha
	      egy új nyomtató vagy egy új
	      szûrõ mûködését
	      próbálgatjuk: ilyenkor érdemes
	      kikapcsolni a nyomtatási sort és
	      <systemitem class="username">root</systemitem>
	      felhasználóként nyomtatási
	      feladatokat küldeni.  A többi
	      felhasználó a tesztelés
	      befejezéséig nem tud majd nyomtatási
	      feladatokat küldeni, vagyis egészen addig,
	      amíg a nyomtatási sort vissza nem kapcsoljuk
	      az <command>enable</command> paranccsal.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>down
	    nyomtatónév
	    üzenet</command></term>
	  <listitem>
	    <para>A nyomtató üzemen kívül
	      helyezése.  Lényegében megegyezik egy
	      <command>disable</command> és utána egy
	      <command>stop</command> parancs kiadásával.
	      Az <replaceable>üzenet</replaceable> akkor jelenik
	      meg, amikor a valaki megpróbálja
	      lekérdezni a nyomtató
	      állapotát az <command>lpc status</command>
	      paranccsal, vagy amikor megnézi a nyomtatási
	      sorát az &man.lpq.1; paranccsal.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>enable
	    nyomtatónév</command></term>
	  <listitem>
	    <para>A nyomtatóhoz tartozó nyomtatási
	      sor bekapcsolása.  A felhasználók
	      ezután már képesek lesznek a
	      nyomtatónak feladatokat küldeni, azonban
	      egészen addig nem nyomtatódik ki semmi,
	      amíg a nyomtatót el nem
	      indítjuk.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>help
	    parancsnév</command></term>
	  <listitem>
	    <para>Megmutatja a
	      <replaceable>parancsnév</replaceable> parancshoz
	      tartozó súgót.  A
	      <replaceable>parancsnév</replaceable>
	      megadása nélkül a rendelkezésre
	      álló parancsok listáját kapjuk
	      meg.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>restart
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Elindítja a nyomtatót.  A
	      felhasználók ezt a parancsot tudják
	      használni abban az esetben, amikor valamilyen
	      megmagyarázhatatlan okból az
	      <application>LPD</application> mûködése
	      megáll, viszont ezzel nem tudják
	      elindítani a <command>stop</command> vagy
	      <command>down</command> parancsokkal
	      leállított nyomtatót.  A
	      <command>restart</command> parancs megegyezik az
	      <command>abort</command> és a
	      <command>start</command> egymás utáni
	      kiadásával.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>start
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Elindítja a nyomtatót, és a
	      nyomtató nekilát kinyomtatni a
	      sorában levõ nyomtatási
	      feladatokat.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>stop
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Leállítja a nyomtatót, és
	      a nyomtató az aktuális nyomtatási
	      feladat befejezése után már nem kezd
	      neki újabbnak.  Ettõl függetlenül a
	      felhasználók még továbbra is
	      képesek feladatokat küldeni a
	      nyomtatási sorába.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>topq
	    nyomtatónév
	    feladat-vagy-felhasználónév</command></term>
	  <listitem>
	    <para>Átrendezi a
	      <replaceable>nyomtatónév</replaceable>
	      nevû nyomtató sorát úgy, hogy a
	      megadott azonosítójú
	      <replaceable>feladatot</replaceable> vagy a megadott
	      <replaceable>felhasználónévhez</replaceable>
	      tartozó nyomtatási feladatokat a sor
	      elejére teszi.  Ennél a parancsnál
	      <replaceable>nyomtatónévnek</replaceable>
	      nem adhatjuk meg az <literal>all</literal>
	      értéket.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><command>up
	    nyomtatónév</command></term>
	  <listitem>
	    <para>Üzembe helyezi a nyomtatót,
	      tulajdonképpen a <command>down</command> parancs
	      ellentéte.  Megegyezik egy egymás
	      után kiadott <command>start</command> és
	      <command>enable</command> paranccsal.</para>
	  </listitem>
	</varlistentry>
      </variablelist>

      <para>Az &man.lpc.8; a fenti parancsokat a parancssorból
	fogadja el.  Ha itt nem adunk meg neki semmilyen parancsot,
	akkor az &man.lpc.8; interaktív módba vált,
	ahol ugyanezeket a parancsokat adhatjuk ki, egészen az
	<command>exit</command>, <command>quit</command> parancsok vagy
	az állományvége jelzés
	begépeléséig.</para>

    </sect2>
  </sect1>

  <sect1 xml:id="printing-lpd-alternatives">
    <title>Más nyomtatási rendszerek</title>

    <para>Ha derekasan végigolvastuk eddig ezt a fejezetet, akkor
      mostanra már valószínûleg mindent tudunk
      a &os;-ben található <application>LPD</application>
      nyomtatási rendszerrõl.  Ezzel együtt
      tisztában vagyunk a hiányosságaival is,
      aminek kapcsán természetes módon
      felmerülhet bennünk a kérdés:
      <quote>Milyen más (&os;-vel is mûködni
      képes) nyomtatási rendszerek léteznek
      még?</quote></para>

    <variablelist>
      <varlistentry>
	<term>LPRng</term>
	<listitem>
	  <indexterm><primary>LPRng</primary></indexterm>

	  <para>Az <application>LPRng</application>, aminek
	    jelentése <quote>LPR Next Generation</quote> (Az LPR
	    következõ generációja), a PLP
	    teljesen újraírt változata.  Patrick
	    Powell és Justin Mason (a PLP eredeti
	    karbantartója) együttes munkájának
	    gyümölcse az <application>LPRng</application>.  Az
	    <application>LPRng</application> honlapja: <uri xlink:href="http://www.lprng.org/">http://www.lprng.org/</uri>.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>CUPS</term>
	<listitem>
	  <indexterm><primary>CUPS</primary></indexterm>

	  <para>A <application>CUPS</application>, vagy más
	    néven a <quote>Common UNIX Printing System</quote>
	    (Közös &unix;-os nyomtatási rendszer), egy
	    hordozható nyomtatási réteget
	    nyújt a &unix;-alapú operációs
	    rendszerek számára.  Az Easy Software Products
	    fejlesztése és szinte az összes &unix;
	    gyártó és felhasználó
	    szemében elfogadott szabványos
	    nyomtatási rendszer.</para>

	  <para>A <application>CUPS</application> a nyomtatási
	    feladatok és sorok kezelését az
	    internetes nyomtatási protokollon (Internet Printing
	    Protocol, <acronym>IPP</acronym>)
	    használatával oldja meg.  Csökkentett
	    képességekkel ugyan, de a sornyomtató
	    démon (Line Printer Daemon, <acronym>LPD</acronym>),
	    szerverüzenet-blokk (Server Message Block,
	    <acronym>SMB</acronym>), és AppSocket (más
	    néven JetDirect) protokollokat is ismeri.  A CUPS a
	    komolyabb &unix;-os nyomtatási feladatokhoz ezeken
	    felül még a hálózati
	    nyomtatók közti választást
	    és PostScript nyomtatók
	    leírásán (PostScript Printer
	    Description, <acronym>PPD</acronym>) alapuló
	    nyomtatási beállításokat is
	    támogatja.</para>

	  <para>A <application>CUPS</application> honlapja: <uri xlink:href="http://www.cups.org/">http://www.cups.org/</uri>.</para>

	</listitem>
      </varlistentry>

      <varlistentry>
	<term>HPLIP</term>

	<listitem>
	  <indexterm><primary>HPLIP</primary></indexterm>

	  <para>A <application>HPLIP</application>,
	    másnéven HP &linux; Imaging and Printing, egy HP
	    által kidolgozott programcsalád, amely
	    támogatja a HP eszközök nyomtatási,
	    lapolvasási és faxolási
	    lehetõségeit.  A benne található
	    programok bizonyos nyomtatási feladatokhoz
	    backendként a <application>CUPS</application>
	    nyomtatási rendszert használják.</para>

	  <para>A <application>HPLIP</application> honlapja a <uri xlink:href="http://hplipopensource.com/hplip-web/index.html">http://hplipopensource.com/hplip-web/index.html</uri>
	    címen érhetõ el.</para>
	</listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="printing-troubleshooting">
    <title>Hibakeresés</title>

    <para>Miután az &man.lptest.1; programmal
      elvégeztünk néhány egyszerû
      próbát, a várt helyett a következõk
      egyikét kaphatjuk eredményül:</para>

    <variablelist>
      <varlistentry>
	<term>Egy kis idõ után minden remekül
	  mûködött, vagy nem dobta ki az egész
	  lapot.</term>
	<listitem>
	  <para>A nyomtató nyomtatott egy keveset, aztán
	    egy ideig csendben maradt és nem csinált
	    semmit.  Ilyenkor a nyomtatnivalók
	    megjelenéséhez minden bizonnyal meg kell
	    nyomnunk a nyomtatón levõ <quote>PRINT
	    REMAINING</quote> vagy <quote>FORM FEED</quote>
	    feliratú gombokat.</para>

	  <para>Ebben az esetben a nyomtató
	    valószínûleg még arra várt,
	    hogy még a nyomtatás megkezdése
	    elõtt érkezik valamilyen további adat.
	    Ettõl a gondtól úgy szabadulhatunk meg,
	    ha beállítunk egy szövegszûrõt,
	    amely minden (szükséges) esetben küld egy
	    <quote>FORM FEED</quote> (lapdobás) jelzést is
	    a nyomtatónak.  Ez kell általában
	    ahhoz, hogy a szövegnek a nyomtató belsõ
	    pufferében megmaradt része azonnal
	    kinyomtatódjon.  Akkor is a javunkra válhat
	    ez, ha minden egyes nyomtatási feladatot
	    külön lapon akarunk kezdeni, mivel így a
	    következõ nyomtatási feladat sosem
	    közvetlenül ott kezdõdik, ahol az
	    elõzõ feladat befejezte a
	    nyomtatást.</para>

	  <para>A <filename>/usr/local/libexec/if-simple</filename>
	    szûrõ helyett a következõ szkript
	    használhatával tudunk minden nyomtatási
	    feladat elvégzése után elküldeni
	    egy lapdobást:</para>

	  <programlisting>#!/bin/sh
#
# if-simple - Egyszerû lpd szövegszûrõ
# Helye: /usr/local/libexec/if-simple
#
# Egyszerûen átmásolja a szabvány bemenetet a szabvány kimenetre, és
# figyelmen kívül hagyja az összes többi paramétert.  Minden nyomtatási
# nyomtatási feladat elvégzése után küld egy lapdobást (\f).

/bin/cat &amp;&amp; printf "\f" &amp;&amp; exit 0
exit 2</programlisting>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><quote>Lépcsõsen</quote> jelentek meg a
	  sorok.</term>
	<listitem>
	  <para>Ekkor a következõt látjuk a
	    lapon:</para>

	  <screen>!"#$%&amp;'()*+,-./01234
                "#$%&amp;'()*+,-./012345
                                 #$%&amp;'()*+,-./0123456</screen>

	  <indexterm><primary>MS-DOS</primary></indexterm>
	  <indexterm><primary>OS/2</primary></indexterm>
	  <indexterm><primary>ASCII</primary></indexterm>

	  <para>Az ún.
	    <emphasis>lépcsõhatás</emphasis>
	    áldozatává váltunk, amelyet a
	    sortörést jelzõ karakter eltérõ
	    értelmezései okoznak.  A &unix;
	    stílusú operációs rendszerek
	    erre mindössze egyetlen karaktert használnak: ez
	    a 10-es kódú ASCII karakter (sordobás,
	    Line Feed, LF).  Az &ms-dos;, &os2; és mások
	    pedig két karakterrel oldják meg ezt a
	    feladatot: a 10-es <emphasis>és</emphasis> 13-as
	    kódú (kocsivissza, Carriage Return, CR) ASCII
	    karakterekkel.  A sortöréseknél sok
	    nyomtató az &ms-dos; szokásait
	    követi.</para>

	  <para>Amikor a &os;-vel nyomtatunk, akkor csak egyetlen
	    karaktert használunk sortörésre.  Ennek
	    láttán a nyomtató lépteti a
	    sort, azonban a fej vízszintes
	    pozícióját nem változtatja meg a
	    következõ sor nyomtatásának
	    megkezdésekor.  Erre lenne a kocsivissza karakter,
	    vagyis ennek hatására fogja a nyomtató
	    a papír bal oldalára
	    visszaállítani a következõ
	    nyomtatandó karakter
	    pozícióját.</para>

	  <para>A &os; így szeretné utasítani a
	    nyomtatót:</para>

	  <informaltable frame="none" pgwide="1">
	    <tgroup cols="2">
	      <tbody>
		<row>
		  <entry>A nyomtató kocsivisszát
		    kap</entry>
		  <entry>A nyomtató visszalépteti a
		    pozíciót</entry>
		</row>

		<row>
		  <entry>A nyomtató sordobást kap</entry>
		  <entry>A nyomtató új sort kezd</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </informaltable>

	  <para>Néhány módszer ennek
	    kiváltására:</para>

	  <itemizedlist>
	    <listitem>
	      <para>A nyomtatón található
		kapcsolók vagy vezérlõpanel
		segítségével
		próbáljuk meg
		átállítani a
		vezérlõkarakterek nyomtató szerinti
		értelmezését.  Keressük meg a
		nyomtató kézikönyvében, hogyan
		tudjuk ezt megcsinálni.</para>

	      <note>
		<para>Ha a &os; mellett más
		  operációs rendszerekkel is
		  használni akarjuk a nyomtatót, akkor
		  azok indítása elõtt mindig
		  <emphasis>át kell
		  állítani</emphasis> a nyomtatót a
		  megfelelõ értelmezés
		  alkalmazására.  Ilyenkor
		  valószínûleg a lentebb
		  szereplõ megoldásokat
		  részesítjük majd inkább
		  elõnyben.</para>
	      </note>
	    </listitem>

	    <listitem>
	      <para>Állítsuk be úgy a &os; soros
		vonali meghajtóját, hogy
		magától alakítsa át az LF
		karaktereket CR+LF párokká.
		Természetesen ez a megoldás
		<emphasis>csak</emphasis> a soros portra
		csatlakozó nyomtatók esetében
		mûködhet.  Ehhez az
		<filename>/etc/printcap</filename>
		állományban a nyomtató
		leírásánál az
		<literal>ms#</literal> tulajdonságnál
		adjuk meg az <literal>onlcr</literal>
		módot.</para>
	    </listitem>

	    <listitem>
	      <para>Küldjünk olyan
		<emphasis>kódot</emphasis> a nyomtatónak,
		amelynek hatására ideiglenesen
		máshogy fogja kezelni az LF karaktereket.
		Nézzük meg a nyomtatóhoz
		mellékelt útmutatóban, hogy milyen
		kódokat tudunk ilyen célra
		használni.  Ha találtunk ilyen
		kódot, akkor írjuk át úgy a
		hozzá tartozó szövegszûrõt,
		hogy a nyomtatási feladatok elõtt mindig
		elküldjük azt.</para>

	      <indexterm><primary>PCL</primary></indexterm>

	      <para>Most bemutatjuk egy olyan szövegszûrõ
		kódját, amely a Hewlett-Packard PCL
		kódjait ismerõ nyomtatókhoz
		készült.  Ebben a szûrõben
		elõször kiadjuk, hogy az LF karaktereket LF
		és CR karakterek
		kombinációjának tekintse a
		nyomtató, majd elküldjük magát a
		nyomtatási feladatot, és a
		nyomtatási feladat eredményének
		utolsó lapja után elküldünk egy
		lapdobást.  Szinte az összes Hewlett Packard
		nyomtatóval mûködnie kell.</para>

	      <programlisting>#!/bin/sh
#
# hpif - Egyszerû lpd bemeneti szûrõ a HP-PCL alapú nyomtatókhoz
# Helye: /usr/local/libexec/hpif
#
# Egyszerûen átmásolja a szabvány kimenetet a szabvány bemenetre, és
# figyelmen kívül hagyja a paramétereket. Elküldi a nyomtatónak, hogy
# az LF karaktereket CR+LF-ként kezelje, majd a feladat befejeztével
# lapot dobat.

printf "\033&amp;k2G" &amp;&amp; cat &amp;&amp; printf "\033&amp;l0H" &amp;&amp; exit 0
exit 2</programlisting>

	      <para>Példaként megadjuk még az
		<systemitem>orchid</systemitem> nevû
		számítógép
		<filename>/etc/printcap</filename>
		állományát is.  Ebben egyetlen
		nyomtató csatlakozik a párhuzamos portra,
		amelynek a típusa LaserJet 3Si és a neve
		<literal>teak</literal>.  Az elõbb bemutatott
		szövegszûrõt használja:</para>

	      <programlisting>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=<filename>/dev/lpt0</filename>:sh:sd=<filename>/var/spool/lpd/teak</filename>:mx#0:\
        :if=<filename>/usr/local/libexec/hpif</filename>:</programlisting>
	    </listitem>
	  </itemizedlist>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Egymásra írja a sorokat.</term>
	<listitem>
	  <para>A nyomtató nem lépteti a sorokat,
	    ezért az összes sor egymáson jelenik
	    meg.</para>

	  <para>Ez pontosan a ritka <quote>ellentéte</quote> a
	    fentebb leírt lépcsõhatásnak.  A
	    &os; által sortörésre használt LF
	    karakterek valamiért CR karakterekként
	    viselkednek, ezért a nyomtató nem sort
	    vált, hanem a lap bal szélére
	    állítja a fejet.</para>

	  <para>A nyomtatón található
	    kapcsolókkal vagy vezérlõpanellel
	    így állítsuk be a sordobás
	    és kocsivissza karakterek
	    értelmezését:</para>

	  <informaltable frame="none" pgwide="1">
	    <tgroup cols="2">
	      <thead>
		<row>
		  <entry>Amit a nyomtató kap</entry>
		  <entry>Arra a nyomtató nyomtat</entry>
		</row>
	      </thead>

	      <tbody>
		<row>
		  <entry>CR</entry>
		  <entry>CR</entry>
		</row>

		<row>
		  <entry>LF</entry>
		  <entry>CR + LF</entry>
		</row>
	      </tbody>
	    </tgroup>
	  </informaltable>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>A nyomtató elhagy karaktereket.</term>
	<listitem>
	  <para>Miközben nyomtatunk, a nyomtató bizonyos
	    karaktereket nem hajlandó megjeleníteni.  A
	    probléma ennél nagyobb, ha a nyomtató
	    mûködése közben egyre több
	    és több karaktert hagy ki.</para>

	  <para>Itt az a gond, hogy a nyomtató nem képes
	    tartani az iramot a számítógép
	    által a soros vonalon átküldött
	    adatok sebességével (ez a probléma nem
	    jelentkezhet a párhuzamos nyomtatók
	    esetén).  Két módon kerekedhetünk
	    felül ezen:</para>

	  <itemizedlist>
	    <listitem>
	      <para>Ha a nyomtató ismeri a XON/XOFF
		típusú
		forgalomirányítást, akkor az
		<literal>ms#</literal> tulajdonságnál
		adjuk meg a &os; számára az
		<literal>ixon</literal>
		beállítást.</para>
	    </listitem>

	    <listitem>
	      <para>Ha a nyomtató ismeri a <quote>Request to Send
		/ Clear to Send</quote> alapú hardveres
		kézfogást (más néven
		<literal>RTS/CTS</literal>
		forgalomirányítást), akkor az
		<literal>ms#</literal> tulajdonságnál a
		<literal>crtscts</literal>
		beállítást adjuk meg.
		Gondoskodjunk róla, hogy a
		számítógépet és a
		nyomtatót összekötõ kábel
		meg tudjon majd birkózni ezzel a
		típusú
		forgalomirányítással.</para>
	    </listitem>
	  </itemizedlist>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Mindenféle szemetet nyomtat.</term>
	<listitem>
	  <para>A nyomtató nem a nyomtatni kívánt
	    szöveget hozza létre, hanem összevissza
	    nyomtat.</para>

	  <para>Ez a soros nyomtatók helytelen
	    kommunikációs
	    beállításának egy másik
	    jellemzõ tünete.  Ellenõrizzük a
	    <literal>br</literal> tulajdonságnál megadott
	    adatátviteli sebességet és az
	    <literal>ms#</literal> tulajdonságnál megadott
	    paritási beállításokat.
	    Egyeztessük a nyomtató saját és az
	    <filename>/etc/printcap</filename> állományban
	    tárolt beállításait.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Semmi sem történik.</term>

	<listitem>
	  <para>Ha semmi sem történt, akkor a gond
	    magával a &os;-vel lehet, nem pedig a hardverrel.  Az
	    <filename>/etc/printcap</filename> állományba
	    a vizsgálni kívánt nyomtató
	    leírásához (az <literal>lf</literal>
	    tulajdonsággal) illesszünk be
	    naplózást.  Például így
	    fog kinézni a <literal>rattan</literal> nevû
	    nyomtató bejegyzése az <literal>lf</literal>
	    tulajdonság megadásával
	    kibõvítve:</para>

	  <programlisting>rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=<filename>/var/spool/lpd/rattan</filename>:\
        :lp=<filename>/dev/lpt0</filename>:\
        :if=<filename>/usr/local/libexec/if-simple</filename>:\
        :lf=<filename>/var/log/rattan.log</filename></programlisting>

	  <para>Miután ezt megcsináltuk,
	    próbálkozzunk újra.  Nézzük
	    meg a naplóállományban (ami a
	    példánkban a
	    <filename>/var/log/rattan.log</filename> nevén
	    érhetõ el), hogy látunk-e valamilyen
	    hibaüzenetet.  Az itt tapasztalt hibaüzenetek
	    nyomán elindulva igyekezzünk megszüntetni a
	    probléma forrását.</para>

	  <para>Ha nem adjuk meg az <literal>lf</literal>
	    tulajdonságot, akkor az
	    <application>LPD</application> erre a célra
	    alapértelmezés szerint a <filename>/dev/console</filename>
	    állományt használja.</para>
	</listitem>
      </varlistentry>
    </variablelist>

  </sect1>
</chapter>
