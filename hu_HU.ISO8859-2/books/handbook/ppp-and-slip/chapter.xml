<?xml version="1.0" encoding="iso-8859-2"?>
<!--
     The FreeBSD Documentation Project

     $FreeBSD$
-->
<!-- The FreeBSD Hungarian Documentation Project
     Translated by: PALI, Gabor <pgj@FreeBSD.org>
     %SOURCE%	en_US.ISO8859-1/books/handbook/ppp-and-slip/chapter.xml
     %SRCID%	1.194
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="ppp-and-slip">
  <info><title>A PPP és a SLIP</title>
    <authorgroup>
      <author><personname><firstname>Jim</firstname><surname>Mock</surname></personname><contrib>Átdolgozta, átrendezte és
	  aktualizálta: </contrib></author>
    </authorgroup>
  </info>

  

  <sect1 xml:id="ppp-and-slip-synopsis">
    <title>Áttekintés</title>

    <indexterm xml:id="ppp-ppp"><primary>PPP</primary></indexterm>
    <indexterm xml:id="ppp-slip"><primary>SLIP</primary></indexterm>

    <para>A &os; számos módon képes
      összekötni két
      számítógépet.  Ha
      betárcsázós modemmel akarunk
      hálózati vagy internetes kapcsolatot
      felépíteni, esetleg azt szeretnénk, hogy
      mások képesek legyenek minket ilyen módon
      elérni, akkor ahhoz PPP-t, illetve SLIP-et kell
      használnunk.  Ebben a fejezetben a modemes
      kommunikáció beállításait
      mutatjuk be részletesebben.</para>

    <para>A fejezet elolvasása során
      megismerjük:</para>

    <itemizedlist>
      <listitem>
	<para>hogyan állítsunk be
	  felhasználói PPP-t;</para>
      </listitem>
      <listitem>
	<para>hogyan állítsunk be rendszerszintû
	  PPP-t (csak &os;&nbsp;7.<replaceable>X</replaceable>);</para>
      </listitem>
      <listitem>
	<para>hogyan állítsunk be egy
	  <acronym>PPPoE</acronym> (PPP over Ethernet, vagyis <quote>PPP
	  Ethernet felett</quote>) kapcsolatot;</para>
      </listitem>
      <listitem>
	<para>hogyan állítsunk be egy
	  <acronym>PPPoA</acronym> (PPP over ATM, vagyis <quote>PPP ATM
	  felett</quote>) kapcsolatot;</para>
      </listitem>
      <listitem>
	<para>hogyan állítsunk be SLIP klienst és
	  szervert (csak &os;&nbsp;7.<replaceable>X</replaceable>).</para>
      </listitem>
    </itemizedlist>

    <indexterm xml:id="ppp-ppp-user">
      <primary>PPP</primary>
      <secondary>felhasználói PPP</secondary>
    </indexterm>
    <indexterm xml:id="ppp-ppp-kernel">
      <primary>PPP</primary>
      <secondary>rendszer PPP</secondary>
    </indexterm>
    <indexterm xml:id="ppp-ppp-ethernet">
      <primary>PPP</primary>
      <secondary>Ethernet felett</secondary>
    </indexterm>

    <para>A fejezet elolvasásához ajánlott:</para>

    <itemizedlist>
      <listitem>
	<para>az alapvetõ hálózati
	  technológiák ismerete;</para>
      </listitem>
      <listitem>
	<para>a betárcsázós kapcsolatok, a PPP
	  és/vagy SLIP alapjainak és céljainak
	  megértése.</para>
      </listitem>
    </itemizedlist>

    <para>Talán érdekli a kedves olvasót, hogy mi
      az alapvetõ különbség a
      felhasználói és a rendszerszintû PPP
      között.  A válasz egyszerû: a
      felhasználói PPP a beérkezõ és
      kimenõ adatokat nem a rendszermagban, hanem a
      felhasználói szinten dolgozza fel.  Ez
      költséges abból a szempontból, hogy
      emiatt adatokat kell másolgatni a rendszer és a
      felhasználói szint között, azonban egy
      sokkal többet tudó PPP implementációnak
      ad ezzel utat.  A felhasználói PPP a
      <filename>tun</filename> eszközön keresztül
      kommunikál a külvilággal, miközben a
      rendszermagban található PPP mindezt a
      <filename>ppp</filename> eszközzel
      valósítja meg.</para>

    <note>
      <para>A fejezetben a felhasználói PPP-t
	egyszerûen csak <application>ppp</application> néven
	fogjuk hivatkozni, hacsak nem lesz szükséges
	különbséget tennünk közte és
	más PPP szoftverek, mint például a
	<application>pppd</application> között.  Ha
	mást nem mondunk, akkor a fejezetben ismertetett
	összes parancsot <systemitem class="username">root</systemitem>
	felhasználóként kell kiadni.</para>
    </note>

  </sect1>

  <sect1 xml:id="userppp">
    <info><title>A felhasználói PPP alkalmazása</title>
      <authorgroup>
	<author><personname><firstname>Tom</firstname><surname>Rhodes</surname></personname><contrib>Frissítette és javította:
	    </contrib></author>
      </authorgroup>
      <authorgroup>
	<author><personname><firstname>Brian</firstname><surname>Somers</surname></personname><contrib>Eredetileg készítette: </contrib></author>
      </authorgroup>
      <authorgroup>
	<author><personname><firstname>Nik</firstname><surname>Clayton</surname></personname><contrib>Segített még: </contrib></author>
	<author><personname><firstname>Dirk</firstname><surname>Frömberg</surname></personname></author>
	<author><personname><firstname>Peter</firstname><surname>Childs</surname></personname></author>
      </authorgroup>
    </info>

    

    <warning>
      <para>A &os; 8.0 változatától
	kezdõdõen a soros portokhoz tartozó
	eszközök nevei
	<filename>/dev/cuadN</filename>
	helyett
	<filename>/dev/cuauN</filename>,
	illetve
	<filename>/dev/ttydN</filename>
	helyett
	<filename>/dev/ttyuN</filename>
	lettek.  A &os;&nbsp;7.<replaceable>X</replaceable>
	felhasználóknak ezeknek a
	változásoknak megfelelõen kell olvasniuk az
	itt szereplõ dokumentációt.
	</para>
    </warning>

    <sect2>
      <title>A felhasználói PPP</title>

      <sect3>
	<title>Elõfeltételek</title>

	<para>A leírás feltételezi, hogy
	  rendelkezünk a következõkkel:</para>

	<itemizedlist>
	  <listitem>
	    <para>Olyan internet-elõfizetés, ahol PPP-n<indexterm xml:id="ppp-ppp2"><primary>PPP kapcsolat</primary></indexterm>
	      keresztül csatlakozunk</para>
	  </listitem>

	  <listitem>
	    <para>Egy modem vagy más olyan
	      rendszerünkhöz csatlakozó eszköz,
	      amelyen keresztül el tudjuk érni az
	      internet-szolgáltatónkat<indexterm xml:id="ppp-isp"><primary>internet-szolgáltató</primary></indexterm></para>
	  </listitem>

	  <listitem>
	    <para>Az internet-elõfizetés
	      betárcsázásához
	      szükséges telefonszámok</para>
	  </listitem>

	  <listitem>
	    <para>A bejelentkezési nevünk<indexterm xml:id="ppp-login"><primary>bejelentkezési név</primary></indexterm> és
	      jelszavunk<indexterm xml:id="ppp-password"><primary>jelszó</primary></indexterm>.  (Vagy a megszokott &unix;-os<indexterm xml:id="ppp-unix"><primary>UNIX</primary></indexterm>
	      felhasználói név és
	      jelszó páros, vagy egy PAP<indexterm xml:id="ppp-pap"><primary>PAP</primary></indexterm> esetleg CHAP<indexterm xml:id="ppp-chap"><primary>CHAP</primary></indexterm>
	      bejelentkezési név és
	      jelszó.)</para>
	  </listitem>

	  <listitem>
	    <para>Egy vagy több névszerver<indexterm xml:id="ppp-nameserver"><primary>névszerver</primary></indexterm> IP-címe.
	      Ehhez az internet-szolgáltatók
	      általában két IP-címet adnak
	      meg.  Ha egyet sem kaptunk, akkor a
	      <filename>ppp.conf</filename> állományban
	      erre a célra használhatjuk az
	      <command>enable dns</command> parancsot, és ekkor a
	      <application>ppp</application> majd automatikusan be fogja
	      állítani nekünk a
	      névszervereket.  Ezt a lehetõséget az
	      befolyásolja, hogy az
	      internet-szolgáltató oldalán
	      mûködõ PPP implementáció
	      támogatja-e a névfeloldás
	      egyeztetését (DNS negotiation).</para>
	  </listitem>
	</itemizedlist>

	<para>A következõ információkat is
	  megkaphatjuk az
	  internet-elõfizetésünkhöz, de nem
	  feltétlenül szükségesek:</para>

	<itemizedlist>
	  <listitem>
	    <para>Az internet-szolgáltató
	      átjárójának IP-címe.
	      Az átjáró az a gép, amelyen
	      keresztül a gépünk csatlakozik és
	      számára ez lesz az
	      <emphasis>alapértelmezett
	      átjáró</emphasis>.  Ha nem
	      rendelkezünk ezzel az információval,
	      akkor csak állítsunk be valamit, és
	      majd a csatlakozáskor a szolgáltató
	      PPP szervere felülírja a megfelelõ
	      beállításokkal.</para>

	    <para>Erre a címre a <application>ppp</application>
	      <literal>HISADDR</literal> néven hivatkozik.</para>
	  </listitem>

	  <listitem>
	    <para>A használandó hálózati
	      maszk.  Amennyiben a szolgáltató ezt nem
	      adta meg, nyugodtan használjuk erre a <systemitem class="netmask">255.255.255.255</systemitem>
	      értéket.</para>
	  </listitem>

	  <listitem>
	    <para>Ha a szolgáltatónk statikus
	      IP-címet<indexterm xml:id="ppp-static-ip"><primary>statikus IP-cím</primary></indexterm> és rögzített
	      hálózati nevet is biztosít
	      nekünk, ezt is megadhatjuk.  Minden más
	      esetben egyszerûen csak hagyjuk, hogy a rendszer
	      automatikusan válasszon nekünk egyet.</para>
	  </listitem>
	</itemizedlist>

	<para>Ha a szükséges információknak
	  nem vagyunk birtokában, akkor vegyük fel a
	  kapcsolatot az internet-szolgáltatókkal.</para>

	<note>
	  <para>Ebben a szakaszban a példákban
	    szereplõ konfigurációs
	    állományok sorait számozva
	    láthatjuk.  Ezek a sorszámok a
	    bemutatás és a tárgyalás
	    megkönnyítése érdekében
	    szerepelnek, és nem az eredeti
	    állományok részei.  Mindezek mellett a
	    tabulátorok és szóközök
	    megfelelõ használata is fontos.</para>
	</note>

      </sect3>

      <sect3>
	<title>A <application>PPP</application> automatikus
	  beállítása</title>

	<indexterm>
	  <primary>PPP</primary>
	  <secondary>beállítása</secondary>
	</indexterm>

	<para>A <command>ppp</command> és a
	  <command>pppd</command> (a PPP rendszerszintû
	  megvalósítása) egyaránt az
	  <filename>/etc/ppp</filename>
	  könyvtárban található
	  konfigurációs állományokat
	  használja.  A felhasználói PPP-hez
	  ezenkívül még a
	  <filename>/usr/share/examples/ppp/</filename>
	  könyvtárban vannak példák.</para>

	<para>A <command>ppp</command> parancs
	  beállítása az igényeinktõl
	  függõen számos állomány
	  módosítását igényelheti.  A
	  tartalmukat nagyban befolyásolja, hogy a
	  szolgáltatónk részérõl a
	  címeket kiosztása statikus (vagyis egy adott
	  címet kapunk és folyamatosan azt
	  használjuk) esetleg dinamikus (vagyis az
	  IP-címünk minden egyes
	  kapcsolódáskor más és
	  más).</para>

	<sect4 xml:id="userppp-staticIP">
	  <title>PPP statikus IP-címmel</title>

	  <indexterm>
	    <primary>PPP</primary>
	    <secondary>statikus IP-címmel</secondary>
	  </indexterm>

	  <para>Ebben az esetben az
	    <filename>/etc/ppp/ppp.conf</filename>
	    konfigurációs állományt kell
	    átszerkesztenünk.  Tartalma az alábbi
	    példához hasonlítható.</para>

	  <note>
	    <para>A <literal>:</literal> karakterrel
	      végzõdõ sorok mindig az elsõ
	      oszlopban kezdõdnek (tehát a sor
	      elején), míg az összes többi sort
	      tabulátorok vagy szóközök
	      használatával bentebb kell raknunk.</para>
	  </note>

	  <programlisting>1     default:
2       set log Phase Chat LCP IPCP CCP tun command
3       ident user-ppp VERSION (built COMPILATIONDATE)
4       set device /dev/cuau0
5       set speed 115200
6       set dial "ABORT BUSY ABORT NO\\sCARRIER TIMEOUT 5 \
7                 \"\" AT OK-AT-OK ATE1Q0 OK \\dATDT\\T TIMEOUT 40 CONNECT"
8       set timeout 180
9       enable dns
10
11    szolgaltato:
12      set phone "(123) 456 7890"
13      set authname ize
14      set authkey mize
15      set login "TIMEOUT 10 \"\" \"\" gin:--gin: \\U word: \\P col: ppp"
16      set timeout 300
17      set ifaddr <replaceable>x.x.x.x</replaceable> <replaceable>y.y.y.y</replaceable> 255.255.255.255 0.0.0.0
18      add default HISADDR</programlisting>

	  <variablelist>
	    <varlistentry>
	      <term>1. sor:</term>

	      <listitem>
		<para>Ez azonosítja be az alapértelmezett
		  bejegyzést.  Az itt szereplõ parancsok a
		  <command>ppp</command> minden egyes futásakor
		  magukból végrehajtódnak.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>2. sor:</term>

	      <listitem>
		<para>Beállítja a naplózás
		  paramétereit.  Amikor a
		  beállításaink már
		  kifogástalanul mûködnek, akkor ezt a
		  sort érdemes átírni a
		  következõre:</para>

		<programlisting>set log phase tun</programlisting>

		<para>Ezzel jelentõs mértékben vissza
		  tudjuk fogni a naplózás
		  mértékét.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>3. sor:</term>

	      <listitem>
		<para>Ezzel mondjuk meg a PPP-nek, hogy a többiek
		  felé miként azonosítsa
		  magát.  A PPP akkor azonosítja
		  magát a társak felé, ha
		  valamilyen gondja akad az egyeztetésekkel
		  és a kapcsolat
		  beállításával.  Az
		  így továbbított
		  információk a másik oldal
		  rendszergazdái számára
		  nyújthatnak segítséget az ilyen
		  jellegû problémák
		  felderítésében.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>4. sor:</term>

	      <listitem>
		<para>Itt adjuk meg az eszközt, amelyre a modem
		  csatlakozik.  A <filename>COM1</filename> neve
		  <filename>/dev/cuau0</filename>, a
		  <filename>COM2</filename> neve pedig <filename>/dev/cuau1</filename>.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>5. sor:</term>

	      <listitem>
		<para>A csatlakozás sebességét
		  adjuk meg.  Ha a 115&nbsp;200-as érték
		  itt nem mûködne (ez egyébként
		  minden újabb gyártmányú
		  modem esetében elfogadható), akkor
		  helyette használjuk a 38400-as
		  beállítást.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>6. és 7. sorok:</term>

	      <listitem>
		<para>A híváshoz használt
		  karakterlánc.  A felhasználói PPP<indexterm><primary>PPP</primary><secondary>felhasználói PPP</secondary></indexterm>
		  a &man.chat.8; programhoz hasonló
		  <quote>küldök-várok</quote>
		  típusú szerkesztést alkalmaz.  A
		  kihasználható
		  lehetõségekrõl a man oldalán
		  olvashatunk részletesebben.</para>

		<para>Az olvashatóság
		  kedvéért a parancs a következõ
		  sorban folytatódik.  A
		  <filename>ppp.conf</filename>
		  állományban bármelyik parancs,
		  ahol a <literal>\</literal> karakterrel zárjuk
		  a sort, az ugyanígy folytatható a
		  következõben.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>8. sor:</term>

	      <listitem>
		<para>A kapcsolathoz tartozó
		  üresjárati idõt állítja
		  be.  Ennek értéke alapból
		  180&nbsp;másodperc, így ez a sor
		  pusztán csak az érthetõséget
		  szolgálja.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>9. sor:</term>

	      <listitem>
		<para>Arra utasítja a PPP-t, hogy a
		  többiektõl kérdezze le a helyi
		  névfeloldó
		  beállításait.  Ha saját
		  névszervert futtatunk, akkor ezt a sort
		  tegyük inkább megjegyzésbe vagy
		  töröljük ki.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>10. sor:</term>

	      <listitem>
		<para>Ez az üres sor az
		  átláthatóság
		  kedvéért került bele.  A PPP az
		  összes üres sort figyelmen kívül
		  hagyja.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>11. sor:</term>

	      <listitem>
		<para>Itt kezdõdik a <quote>szolgaltato</quote>
		  nevû szolgáltatóhoz tartozó
		  bejegyzés.  Ezt késõbb akár
		  ki is cserélhetjük az
		  internet-szolgáltatónk nevére,
		  így a <option>load
		  <replaceable>szolgáltató</replaceable></option>
		  beállítással tudjuk majd
		  beindítani a kapcsolatot.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>12. sor:</term>

	      <listitem>
		<para>Beállítjuk a
		  szolgáltatóhoz tartozó
		  telefonszámot.  A kettõspont
		  (<literal>:</literal>) vagy a csõvezeték
		  (<literal>|</literal>) karakterekkel
		  elválasztva több telefonszámot is
		  meg tudunk adni.  A &man.ppp.8; oldalon olvashatunk a
		  két elválasztó közti
		  különbségekrõl.  Röviden
		  ezeket úgy foglalhatnánk össze,
		  hogy ha váltogatni akarunk a számok
		  között, akkor használjuk a
		  kettõspontot.  Ha mindig az elsõként
		  megadott számot akarjuk hívni és
		  a többit csak akkor, ha ez nem mûködik,
		  akkor a csõvezeték karakterre lesz
		  szükségünk.  Ahogy a példa is
		  mutatja, az összes telefonszámot
		  tegyük mindig idézõjelek
		  közé.</para>

		<para>Ha a telefonszámban egyébként
		  is szerepelnek szóközök, akkor is
		  idézõjelek (<literal>"</literal>)
		  közé kell tennünk.  Ennek
		  elhagyásával egy egyszerû,
		  ámde kényes hibát
		  ejtünk.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>13. és 14. sor:</term>

	      <listitem>
		<para>A felhasználói nevet és
		  jelszót tartalmazza.  Amikor egy &unix;
		  fajtájú bejelentkezést kapunk,
		  akkor ezekre az értékekre a <command>set
		  login</command> parancsban \U és \P
		  változókkal tudunk hivatkozni.  Ha PAP
		  vagy CHAP használatával
		  jelentkezünk be, akkor ezek az
		  értékek a hitelesítéskor
		  kerülnek felhasználásra.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>15. sor:</term>

	      <listitem>
		<para>Ha a PAP<indexterm><primary>PAP</primary></indexterm> vagy CHAP<indexterm><primary>CHAP</primary></indexterm> protokollok valamelyikét
		  használjuk, akkor nem lesz
		  szükségünk a login
		  változóra, ezért ezt
		  megjegyzésbe is tehetjük, vagy akár
		  ki is törölhetjük.  A <link linkend="userppp-PAPnCHAP">PAP és CHAP
		  hitelesítésrõl</link>
		  szóló részben olvashatjuk ennek
		  további részleteit.</para>

		<para>A bejelentkezéshez használt
		  karakterlánc hasonlít a
		  behíváshoz használt,
		  chat-szerû felépítéssel
		  rendelkezõ karakterlánchoz.  A
		  példában látható
		  karakterlánc egy olyan
		  szolgáltatáshoz illeszkedik, ahol a
		  bejelentkezés valahogy így néz
		  ki:</para>

		<screen>A Világ Legjobb Szolgáltatója
login: <replaceable>izé</replaceable>
password: <replaceable>mizé</replaceable>
protocol: ppp</screen>

		<para>Ezt a szkriptet alakítsuk a saját
		  igényeinkhez.  Ha elõször
		  próbálkozunk ilyen szkript
		  írásával, akkor lehetõleg
		  kapcsoljuk be a rendszerek között
		  lezajló
		  <quote>beszélgetés</quote>
		  naplózását, hogy ellenõrizni
		  tudjuk minden a megfelelõen módon
		  történik-e.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>16. sor:</term>

	      <listitem>
		<para>Beállítjuk a kapcsolathoz
		  tartozó alapértelmezett
		  idõkorlátot<indexterm><primary>idõkorlát</primary></indexterm> (másodpercben).  Itt a
		  kapcsolat automatikusan lezárul
		  300&nbsp;másodperc tétlenséget
		  követõen.  Ha nem akarunk ilyen
		  korlátot szabni, akkor ezt az
		  értéket állítsuk
		  nullára vagy használjuk a
		  <option>-ddial</option> paranccsori
		  kapcsolót.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>17. sor:</term>

	      <listitem>
		<para>A felülethez tartozó címeket
		  állítja be.  A
		  <replaceable>x.x.x.x</replaceable> helyére a
		  szolgáltató<indexterm><primary>internet-szolgáltató</primary></indexterm> által kiosztott
		  IP-címet kell beírnunk.  A
		  <replaceable>y.y.y.y</replaceable> helyett pedig a
		  szolgáltató
		  átjárója kerül be
		  (lényegében az a gép, amelyhez
		  csatlakozunk).  Amennyiben az
		  internet-szolgáltatónk nem adott meg
		  semmilyen átjárót, erre a
		  célra a <systemitem class="netmask">10.0.0.2/0</systemitem> címet is
		  használhatjuk.  Amikor <quote>nekünk kell
		  kitalálnunk</quote> ezeket a címeket,
		  akkor ne felejtsünk el létrehozni
		  hozzájuk egy bejegyzést az
		  <filename>/etc/ppp/ppp.linkup</filename>
		  állományban a <link linkend="userppp-dynamicIP">PPP dinamikus
		  IP-címmel </link> szakaszban szereplõek
		  szerint.  Ha nem adjuk meg ezt a sort, akkor a
		  <command>ppp</command> parancs nem képes
		  <option>-auto</option> módban
		  mûködni.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>18. sor:</term>

	      <listitem>
		<para>A szolgáltató
		  átjárójához felvesz egy
		  alapértelmezett útvonalat.  A
		  <literal>HISADDR</literal> kulcsszót a 17.
		  sorban megadott átjáró
		  címével helyettesítjük.
		  Ezért fontos, hogy ez a 17.  sor után
		  szerepeljen, különben a
		  <literal>HISADDR</literal> nem lesz képes
		  inicializálódni.</para>

		<para>Ha a <command>ppp</command> parancsot nem akarjuk
		  <option>-auto</option> módban futtatni, akkor ezt
		  a sort a <filename>ppp.linkup</filename>
		  állományba is átrakhatjuk.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Ha statikus IP-címmel rendelkezünk és
	    a <command>ppp</command> <option>-auto</option>
	    módban fut, akkor a <filename>ppp.linkup</filename>
	    állományba egészen addig nem kell
	    semmit sem írnunk, amíg a csatlakozás
	    elõtt az útválasztási
	    táblázatokban a megfelelõ adatok
	    találhatóak.  Olyankor is jól
	    jöhet, amikor a csatlakozást követõen
	    meg akarunk hívni bizonyos programokat.  Ezt majd a
	    <application>sendmail</application>es példában
	    fogjuk bõvebben kifejteni.</para>

	  <para>Erre példákat a
	    <filename>/usr/share/examples/ppp/</filename>
	    könyvtárban találhatunk.</para>

	</sect4>

	<sect4 xml:id="userppp-dynamicIP">
	  <title>PPP dinamikus IP-címmel</title>

	  <indexterm>
	    <primary>PPP</primary>
	    <secondary>dinamikus IP-címmel</secondary>
	  </indexterm>

	  <indexterm><primary>IPCP</primary></indexterm>

	  <para>Ha az internet-szolgáltatónktól nem
	    kaptunk statikus IP-címet, akkor a
	    <command>ppp</command> paranccsal is be tudjuk
	    állítani a helyi és távoli
	    címeket.  Ez az IP-címek
	    <quote>kitalálásával</quote>
	    történik, valamint úgy, hogy a
	    <command>ppp</command> számára a
	    csatlakozás után lehetõvé
	    tesszük az IP konfigurációs protocol (IP
	    Configuration Protocol, IPCP) használatát.  A
	    <filename>ppp.conf</filename> tartalma szinte teljesen
	    megegyezik a <link linkend="userppp-staticIP">PPP statikus
	    IP-címmel</link> részben szereplõvel,
	    egyetlen apró különbséggel:</para>

	  <programlisting>17      set ifaddr 10.0.0.1/0 10.0.0.2/0 255.255.255.255</programlisting>

	  <para>Ismét szeretnénk elmondani, hogy a
	    sorszámot ne írjuk bele, hiszen az csak
	    hivatkozási céllal szerepel.  Legalább
	    egy szóközzel kezdjünk bentebb.</para>

	  <variablelist>
	    <varlistentry>
	      <term>17. sor:</term>

	      <listitem>
		<para>A <literal>/</literal> után megjelenõ
		  szám azoknak a biteknek a számát
		  adja meg, amire a ppp támaszkodik.  A
		  környezetünknek jobban megfelelõ
		  IP-címeket is megadhatunk, de a fenti
		  példa minden esetben mûködni
		  fog.</para>

		<para>Az utolsó paraméterrel
		  (<literal>0.0.0.0</literal>) azt mondjuk a PPP-nek,
		  hogy az egyeztetést ne a <systemitem class="ipaddress">10.0.0.1</systemitem>, hanem a <systemitem class="ipaddress">0.0.0.0</systemitem> címmel kezdje
		  meg, amire egyes szolgáltatók
		  esetén szükségünk is lesz.  A
		  <command>set ifaddr</command> elsõ
		  paramétereként azonban soha ne adjuk meg
		  a <literal>0.0.0.0</literal> címet, mivel ezzel
		  a PPP <option>-auto</option> módban nem tudja
		  beállítani a kezdeti
		  útvonalat.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Ha nem <option>-auto</option> módban
	    indítjuk, akkor az
	    <filename>/etc/ppp/ppp.linkup</filename>
	    állományban meg kell adnunk még egy
	    bejegyzést is.  A <filename>ppp.linkup</filename>
	    állományt a kapcsolat létrejötte
	    után dolgozzuk fel.  Itt már a
	    <command>ppp</command> megkapta a felülethez
	    tartozó címeket, így az
	    útválasztási táblázatba
	    fel tudjuk venni hozzájuk a megfelelõ
	    bejegyzéseket:</para>

	  <programlisting>1     szolgaltato:
2      add default HISADDR</programlisting>

	  <variablelist>
	    <varlistentry>
	      <term>1. sor:</term>

	      <listitem>
		<para>A kapcsolat felépítése
		  során a <command>ppp</command> a
		  <filename>ppp.linkup</filename>
		  állományban a következõ
		  szabályok szerint fogja keresni a
		  bejegyzéseket: elõször a
		  <filename>ppp.conf</filename>
		  állományban megadott
		  címkét próbálja
		  megtalálni.  Ha ez nem sikerül, akkor az
		  átjárónknak megfelelõ
		  bejegyzést kezdi el keresni.  Ez egy
		  négy byte-ból álló,
		  felírásában az IP-címekhez
		  hasonlító címke.  Ha még
		  ez a címke sem található, akkor a
		  <literal>MYADDR</literal> bejegyzést
		  keresi.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>2. sor:</term>

	      <listitem>
		<para>Ez a sor mondja meg a <command>ppp</command>
		  programnak, hogy vegyen fel egy
		  <literal>HISADDR</literal> címre
		  vonatkozó alapértelmezett
		  útvonalat.  A <literal>HISADDR</literal>
		  címet az IPCP által egyeztetett
		  átjáró IP-címére
		  cseréljük ki.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>

	  <para>Ha erre a részletesebb példát
	    akarunk látni, akkor a
	    <filename>/usr/share/examples/ppp/ppp.conf.sample</filename>
	    és
	    <filename>/usr/share/examples/ppp/ppp.linkup.sample</filename>
	    állományokban a <literal>pmdemand</literal>
	    bejegyzést nézzük meg.</para>

	</sect4>

	<sect4>
	  <title>A bejövõ hívások
	    fogadása</title>

	  <indexterm>
	    <primary>PPP</primary>
	    <secondary>bejövõ hívások
	      fogadása</secondary>
	  </indexterm>

	  <para>Amikor egy helyi hálózathoz
	    csatlakozó gépen akarjuk a
	    <application>ppp</application> programot
	    beállítani a bejövõ
	    hívások fogadására, akkor azt is
	    el kell döntenünk, hogy
	    engedélyezzük-e a csomagok
	    továbbküldését a belsõ
	    hálózat felé.  Amennyiben igen, akkor a
	    becsatlakozó gépenek a belsõ
	    hálózatunkon ki kell osztani egy
	    külön címet és az
	    <filename>/etc/ppp/ppp.conf</filename>
	    állományban, és meg kell adnunk az
	    <command>enable proxy</command> parancsot.  Emellett
	    még az <filename>/etc/rc.conf</filename>
	    állományban se feleljtsük el megadni a
	    következõ sort:</para>

	  <programlisting>gateway_enable="YES"</programlisting>

	</sect4>

	<sect4>
	  <title>Melyik getty?</title>

	  <para><link linkend="dialup">A &os;
	    beállítása
	    betárcsázós kapcsolatokhoz</link>
	    nagyon jól bemutatja a
	    betárcsázós
	    szolgáltatások
	    beállítását a &man.getty.8;
	    segítségével.</para>

	  <para>A <command>getty</command> helyett
	    egyébként az <link xlink:href="http://mgetty.greenie.net/">mgetty</link>, a <command>getty</command> egy ügyesebb
	    változata is használható (a <package>comms/mgetty+sendfax</package>
	    portból), amely kifejezetten a
	    betárcsázós vonalakhoz
	    készült.</para>

	  <para>A <command>mgetty</command> használatának
	    többek közt az egyik elõnye, hogy
	    <emphasis>aktívan tartja a kapcsolatot</emphasis> a
	    modemekkel, tehát hogy ha az
	    <filename>/etc/ttys</filename> állományban
	    letiltjuk a modemet, akkor nem is fog válaszolni a
	    hívásokra.</para>

	  <para>Emellett az <command>mgetty</command>
	    késõbbi változatai (a 0.99 beta
	    változatától kezdve) még a PPP
	    folyamok automatikus észlelését is
	    támogatják, ezáltal a kliensek
	    szkriptek nélkül is képesek elérni
	    a szerverünket.</para>

	  <para>Ha errõl többet akarunk megtudni, akkor az
	    <command>mgetty</command> paranccsal kapcsolatban olvassuk
	    el <link linkend="userppp-mgetty">Az mgetty és az
	    AutoPPP</link> címû szakaszt.</para>

	</sect4>

	<sect4>
	  <title>A <application>PPP</application>
	    engedélyei</title>

	  <para>A <command>ppp</command> parancsot
	    általában <systemitem class="username">root</systemitem>
	    felhasználóként kell futtatni.  Ha
	    viszont a <command>ppp</command> parancsot tetszõleges
	    felhasználóval akarjuk szerver módban
	    futtatni az iméntiek szerint, akkor ahhoz fel kell
	    vennünk az <filename>/etc/group</filename>
	    állományban szereplõ
	    <systemitem class="groupname">network</systemitem> csoportba.</para>

	  <para>Ezeken kívül még az
	    <command>allow</command> paranccsal is
	    engedélyeznünk kell konfigurációs
	    állomány egy vagy több
	    részének elérését
	    is:</para>

	  <programlisting>allow users fred mary</programlisting>

	  <para>Ha ezt a parancsot a <literal>default</literal>
	    bejegyzésnél adjuk meg, akkor az így
	    megadott felhasználók mindenhez hozzá
	    tudnak férni.</para>

	</sect4>

	<sect4>
	  <title>PPP shellek a dinamikus IP-címek
	    használóinak</title>

	  <indexterm><primary>PPP shellek</primary></indexterm>

	  <para>Hozzunk létre egy
	    <filename>/etc/ppp/ppp-shell</filename> nevû
	    állományt, amelyben a következõk
	    szerepelnek:</para>

	  <programlisting>#!/bin/sh
IDENT=`echo $0 | sed -e 's/^.*-\(.*\)$/\1/'`
CALLEDAS="$IDENT"
TTY=`tty`

if [ x$IDENT = xdialup ]; then
        IDENT=`basename $TTY`
fi

echo "PPP for $CALLEDAS on $TTY"
echo "Starting PPP for $IDENT"

exec /usr/sbin/ppp -direct $IDENT</programlisting>

	  <para>Ez a szkript legyen végrehajtható.
	    Ezután az alábbi paranccsal
	    <filename>ppp-dialup</filename> néven
	    készítsünk egy szimbolikus linket erre a
	    szkriptre:</para>

	  <screen>&prompt.root; <userinput>ln -s ppp-shell /etc/ppp/ppp-dialup</userinput></screen>

	  <para>Ez a szkript lesz az összes
	    betárcsázó felhasználónk
	    <emphasis>shellje</emphasis>.  A most következõ
	    példa az <filename>/etc/passwd</filename>
	    állományban szereplõ,
	    <systemitem class="username">pchilds</systemitem> nevû PPP
	    felhasználó bejegyzését mutatja
	    be (ne felejtsük el, hogy soha ne közvetlenül
	    szerkesszük a jelszavakat tároló
	    állományt, hanem a &man.vipw.8;
	    segítségével).</para>

	  <programlisting>pchilds:*:1011:300:Peter Childs PPP:/home/ppp:/etc/ppp/ppp-dialup</programlisting>

	  <para>Hozzunk létre egy <filename>/home/ppp</filename> nevû
	    könyvtárat a következõ bárki
	    által olvasható 0 byte-os
	    állományokkal:</para>

	  <screen>-r--r--r--   1 root     wheel           0 May 27 02:23 .hushlogin
-r--r--r--   1 root     wheel           0 May 27 02:22 .rhosts</screen>

	  <para>Ezek hatására az
	    <filename>/etc/motd</filename> állomány
	    tartalma nem jelenik meg.</para>

	</sect4>

	<sect4>
	  <title>PPP shellek a statikus IP-címek
	    használóinak</title>

	  <indexterm><primary>PPP shellek</primary></indexterm>

	  <para>Az iméntiekhez hasonló módon
	    készítsük el a
	    <filename>ppp-shell</filename> állományt,
	    és mindegyik statikus IP-vel rendelkezõ
	    hozzáféréshez csináljunk egy
	    szimbolikus linket a <filename>ppp-shell</filename>
	    szkriptre.</para>

	  <para>Például, ha három
	    betárcsázós ügyfelünk van,
	    <systemitem class="username">fred</systemitem>, <systemitem class="username">sam</systemitem>
	    és <systemitem class="username">mary</systemitem>, feléjük
	    24&nbsp;bites CIDR hálózatokat
	    közvetítünk, akkor a következõket
	    kell begépelnünk:</para>

	  <screen>&prompt.root; <userinput>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-fred</userinput>
&prompt.root; <userinput>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-sam</userinput>
&prompt.root; <userinput>ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-mary</userinput></screen>

	  <para>A fentebb szereplõ betárcsázós
	    felhasználók eléréseihez
	    tartozó shelleket állítsuk be az itt
	    létrehozott szimbolikus linkekre (így
	    tehát <systemitem class="username">mary</systemitem> shellje az
	    <filename>/etc/ppp/ppp-mary</filename> lesz).</para>

	</sect4>

	<sect4>
	  <title>A <filename>ppp.conf</filename>
	    beállítása a dinamikus IP-címek
	    használóinak</title>

	  <para>Az <filename>/etc/ppp/ppp.conf</filename>
	    állományban a következõ sorok
	    valamelyikének kellene szerepelnie:</para>

	  <programlisting>default:
  set debug phase lcp chat
  set timeout 0

ttyu0:
  set ifaddr 203.14.100.1 203.14.100.20 255.255.255.255
  enable proxy

ttyu1:
  set ifaddr 203.14.100.1 203.14.100.21 255.255.255.255
  enable proxy</programlisting>

	  <note>
	    <para>A bentebb kezdett sorokat mi is kezdjünk
	      bentebb.</para>
	  </note>

	  <para>A <literal>default:</literal> szakasz minden kapcsolat
	    esetén betöltõdik.  Az
	    <filename>/etc/ttys</filename> állományban
	    engedélyezett mindegyik
	    betárcsázós vonal létrehoz a
	    fenti <literal>ttyu0:</literal> szakaszhoz hasonló
	    bejegyzést.  Minden vonal kap egy egyedi
	    IP-címet a dinamikus felhasználók
	    számára szánt
	    címtartományból.</para>
	</sect4>

	<sect4>
	  <title>A <filename>ppp.conf</filename>
	    beállítása a statikus IP-vel
	    rendelkezõk számára</title>

	  <para>A <filename>/usr/share/examples/ppp/ppp.conf</filename>
	    állományban szereplõ tartalom mellett az
	    összes statikus kiosztású
	    IP-címmel rendelkezõ
	    betárcsázó felhasználóhoz
	    még hozzá kell tennünk egy szakaszt.  A
	    példánkban ezek továbbra is
	    <systemitem class="username">fred</systemitem>, <systemitem class="username">sam</systemitem>
	    és <systemitem class="username">mary</systemitem>.</para>

	  <programlisting>fred:
  set ifaddr 203.14.100.1 203.14.101.1 255.255.255.255

sam:
  set ifaddr 203.14.100.1 203.14.102.1 255.255.255.255

mary:
  set ifaddr 203.14.100.1 203.14.103.1 255.255.255.255</programlisting>

	  <para>Amennyiben szükséges, az
	    <filename>/etc/ppp/ppp.linkup</filename> tartalmazhat
	    további útválasztási
	    információkat is az egyes statikus
	    IP-címmel rendelkezõ
	    felhasználókhoz.  A lentebb bemutatott sor a
	    kliens ppp összekötettésén
	    keresztül vesz fel egy útvonalat a <systemitem class="ipaddress">203.14.101.0/24</systemitem> hálózat
	    felé.</para>

	  <programlisting>fred:
  add 203.14.101.0 netmask 255.255.255.0 HISADDR

sam:
  add 203.14.102.0 netmask 255.255.255.0 HISADDR

mary:
  add 203.14.103.0 netmask 255.255.255.0 HISADDR</programlisting>

	</sect4>

	<sect4 xml:id="userppp-mgetty">
	  <title>Az <command>mgetty</command> és az
	    AutoPPP</title>

	  <indexterm><primary><command>mgetty</command></primary></indexterm>
	  <indexterm><primary>AutoPPP</primary></indexterm>
	  <indexterm><primary>LCP</primary></indexterm>

	  <para>Az <package>comms/mgetty+sendfax</package> port
	    alapértelmezés szerint az
	    <literal>AUTO_PPP</literal>
	    beállítással érkezik, amely
	    lehetõvé teszi, hogy az
	    <command>mgetty</command> képessé legyen a PPP
	    kapcsolatok LCP fázisát észlelni
	    és magától létrehozni
	    hozzá egy ppp shellt.  Mivel az
	    alapértelmezett név/jelszó páros
	    azonban ilyenkor nem jelenik meg, a
	    felhasználókat a PAP vagy a CHAP protokollon
	    keresztül lehet hitelesíteni.</para>

	  <para>Ez a szakasz most feltételezi, hogy a sikeresen
	    beállítottuk, lefordítottuk és
	    telepítettük az <package>comms/mgetty+sendfax</package>
	    portot.</para>

	  <para>Az
	    <filename>/usr/local/etc/mgetty+sendfax/login.config</filename>
	    állományban ne felejtsük
	    ellenõrizni, hogy szerepel a
	    következõ:</para>

	  <programlisting>/AutoPPP/ -     -		      /etc/ppp/ppp-pap-dialup</programlisting>

	  <para>Ezzel utasítjuk az <command>mgetty</command>
	    programot arra, hogy az észlelt PPP kapcsolatokhoz
	    futtassa le a <filename>ppp-pap-dialup</filename>
	    szkriptet.</para>

	  <para>Hozzunk létre az
	    <filename>/etc/ppp/ppp-pap-dialup</filename> nevû
	    állományt, amelyben majd a
	    következõk fognak szerepelni (az
	    állomány legyen
	    végrehajtható):</para>

	  <programlisting>#!/bin/sh
exec /usr/sbin/ppp -direct pap$IDENT</programlisting>

	  <para>Az <filename>/etc/ttys</filename>
	    állományban engedélyezett összes
	    betárcsázós vonalhoz
	    készítsük el a megfelelõ
	    bejegyzést az <filename>/etc/ppp/ppp.conf</filename>
	    állományban.  Ezek remekül meg fognak
	    férni az imént készített
	    definíciókkal.</para>

	  <programlisting>pap:
  enable pap
  set ifaddr 203.14.100.1 203.14.100.20-203.14.100.40
  enable proxy</programlisting>

	  <para>Minden olyan felhasználónak, aki ezzel a
	    módszerrel jelentkezik be, szüksége lesz
	    egy név/jelszó kombinációra az
	    <filename>/etc/ppp/ppp.secret</filename>
	    állományban, vagy az alábbi
	    beállítás megadásával
	    választhatjuk azt is, hogy a
	    felhasználókat az
	    <filename>/etc/passwd</filename> állományon
	    keresztül a PAP protokoll
	    segítségével azonosítjuk.</para>

	  <programlisting>enable passwdauth</programlisting>

	  <para>Ha statikus IP-címet akarunk kiosztani
	    némely felhasználóknak, akkor az
	    <filename>/etc/ppp/ppp.secret</filename>
	    állományban ezt megadhatjuk a harmadik
	    paraméternek.  Errõl bõvebben a
	    <filename>/usr/share/examples/ppp/ppp.secret.sample</filename>
	    állományban láthatunk
	    példát.</para>
	</sect4>

	<sect4>
	  <title>A Microsoft kiterjesztései</title>

	  <indexterm><primary>DNS</primary></indexterm>
	  <indexterm><primary>NetBIOS</primary></indexterm>
	  <indexterm>
	    <primary>PPP</primary>
	    <secondary>Microsoft kiterjesztések</secondary>
	  </indexterm>

	  <para>A PPP úgy is beállítható,
	    hogy kérésre DNS és NetBIOS
	    típusú névfeloldáshoz is
	    szolgáltasson információkat.</para>

	  <para>A PPP 1.x változatával úgy lehet
	    engedélyezni ezeket a kiterjesztéseket, ha az
	    <filename>/etc/ppp/ppp.conf</filename>
	    állomány megfelelõ részeibe
	    felvesszük a következõ sorokat:</para>

	  <programlisting>enable msext
set ns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</programlisting>

	  <para>A PPP második és késõbbi
	    változataiban pedig:</para>

	  <programlisting>accept dns
set dns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</programlisting>

	  <para>Ezzel a kliens megkapja az elsõdleges és
	    másodlagos névszerverek címeit,
	    valamint a NetBIOS névszervert.</para>

	  <para>Ha a második és az azt követõ
	    verziókban a <literal>set dns</literal> sort
	    elhagyjuk, akkor a PPP az
	    <filename>/etc/resolv.conf</filename>
	    állományban található
	    értékeket fogja használni.</para>
	</sect4>

	<sect4 xml:id="userppp-PAPnCHAP">
	  <title>A PAP és CHAP hitelesítés</title>

	  <indexterm><primary>PAP</primary></indexterm>
	  <indexterm><primary>CHAP</primary></indexterm>

	  <para>Egyes internet-szolgáltatók úgy
	    állítják be a rendszerüket, hogy a
	    kapcsolat felépítése során a
	    hitelesítés a PAP vagy CHAP mechanizmusok
	    valamelyikével történik.  Ilyenkor a
	    szolgáltató nem egy <prompt>login:</prompt>
	    sorral fogja bekérni a szükséges
	    adatokat, hanem közvetlenül a PPP kapcsolatot
	    kezdi el használni.</para>

	  <para>A PAP nem olyan biztonságos, mint a CHAP, de itt
	    a biztonság nem is annyira fontos, mivel a jelszavak,
	    amelyeket ugyan a PAP titkosítatlan formában
	    küld tovább, csak egy soros vonalon haladnak
	    át.  A rossz indulatú támadók
	    itt nem sok mindent tudnak
	    <quote>lehallgatni</quote>.</para>

	  <para>A <link linkend="userppp-staticIP">PPP statikus
	    IP-címmel</link> és a <link linkend="userppp-dynamicIP">PPP dinamikus IP
	    címmel</link> címû szakaszokhoz
	    képest a következõ
	    módosításokat kell
	    elvégeznünk:</para>

	  <programlisting>13      set authname <replaceable>AFelhasználóiNevem</replaceable>
14      set authkey <replaceable>AJelszavam</replaceable>
15      set login</programlisting>

	  <variablelist>
	    <varlistentry>
	      <term>13. sor:</term>

	      <listitem>
		<para>Ebben a sorban adjuk meg a PAP/CHAP
		  felhasználói nevünket, amelyet
		  <replaceable>AFelhasználóiNevem</replaceable>
		  helyett kell beírni.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>14. sor:</term>

	      <listitem>
		<para>Ebben a sorban adjuk meg a PAP/CHAP jelszavunkat<indexterm><primary>jelszó</primary></indexterm>,
		  <replaceable>AJelszavam</replaceable> helyett.
		  Szándénkunk
		  egyértelmûsítése
		  érdekében ezek mellett még egy
		  további sort is érdemes felvennünk,
		  tehát:</para>

		<programlisting>16      accept PAP</programlisting>

		<para>vagy</para>

		<programlisting>16      accept CHAP</programlisting>

		<para>Alapértelmezés szerint a PAP
		  és CHAP is egyaránt elfogadott.</para>
	      </listitem>
	    </varlistentry>

	    <varlistentry>
	      <term>15. sor:</term>

	      <listitem>
		<para>A PAP és CHAP alkalmazásakor
		  általában nem is kell
		  bejelentkeznünk a szolgáltató
		  szerverére.  Ezért a <quote>set
		  login</quote> parancsnál használt
		  karakterláncot le is kell tiltanunk.</para>
	      </listitem>
	    </varlistentry>
	  </variablelist>
	</sect4>

	<sect4>
	  <title>A <command>ppp</command>
	    beállításainak
	    megváltoztatása menet közben</title>

	  <para>A háttérben futó
	    <command>ppp</command> programhoz menet közben is
	    tudunk beszélni, de csak olyankor, amikor az ehhez
	    szükséges portot megadtuk.  Ezt úgy
	    tudjuk megtenni, ha beállítások
	    közé felvesszük az alábbit:</para>

	  <programlisting>set server /var/run/ppp-tun<replaceable>%d</replaceable> DiagnosticPassword 0177</programlisting>

	  <para>Így a PPP az elõre megadott &unix;
	    tartománybeli socketen keresztül fogja
	    várni a kapcsolódásunkat, és a
	    konkrét hozzáféréshez
	    jelszót kér.  A névben szereplõ
	    <literal>%d</literal> a használatban levõ
	    <filename>tun</filename> eszköz
	    sorszámát jelöli.</para>

	  <para>Miután a csatlakozás
	    beállítódott, a szkriptekben a
	    &man.pppctl.8; program használható a
	    futó program
	    vezérléséhez.</para>
	</sect4>
      </sect3>

      <sect3 xml:id="userppp-nat">
	<title>A PPP hálózati
	  címfordítási
	  képességének
	  kihasználása</title>

	<indexterm><primary>PPP</primary><secondary>NAT</secondary></indexterm>

	<para>A PPP képes a rendszermag
	  rásegítése nélkül
	  képes hálózati
	  címfordítást végezni.  Ezt a
	  lehetõséget a következõ sor
	  hozzáadásával tudjuk aktiválni az
	  <filename>/etc/ppp/ppp.conf</filename>
	  állományban:</para>

	<programlisting>nat enable yes</programlisting>

	<para>A PPP-be épített hálózati
	  címfordítás a <literal>-nat</literal>
	  parancssori paraméterrel is bekapcsolható.  Az
	  <filename>/etc/rc.conf</filename> állományban is
	  található hozzá egy
	  <literal>ppp_nat</literal> változó, amely
	  alapértelmezés szerint
	  engedélyezett.</para>

	<para>Amikor használjuk ezt a lehetõséget, az
	  <filename>/etc/ppp/ppp.conf</filename>
	  állományban a következõ
	  opciókkal engedélyezhetjük a
	  bejövõ kapcsolatok
	  továbbítását:</para>

	<programlisting>nat port tcp 10.0.0.2:ftp ftp
nat port tcp 10.0.0.2:http http</programlisting>

	<para>vagy egyáltalán ne bízzunk meg a
	  külvilágban:</para>

	<programlisting>nat deny_incoming yes</programlisting>
      </sect3>

      <sect3 xml:id="userppp-final">
	<title>A rendszer végsõ
	  beállítása</title>

	<indexterm>
	  <primary>PPP</primary>
	  <secondary>beállítása</secondary>
	</indexterm>

	<para>Mostanra ugyan már beállítottuk a
	  <command>ppp</command> programot, azonban még
	  néhány dolgot be kell állítanunk,
	  mielõtt ténylegesen nekilátnánk
	  használni.  Ezek mindegyike az
	  <filename>/etc/rc.conf</filename> állomány
	  módosítását igényli.</para>

	<para>Az állományt fentrõl lefelé
	  fogjuk feldolgozni, de elõtte ne felejtsünk el
	  értéket adni a <literal>hostname=</literal>
	  változónak, például:</para>

	<programlisting>hostname="ize.minta.com"</programlisting>

	<para>Amennyiben a szolgáltatónk statikus
	  IP-címet és nevet biztosít
	  számunkra, az lesz a legjobb, ha itt a tõle kapott
	  nevet adjuk meg.</para>

	<para>Keressük meg a <literal>network_interfaces</literal>
	  változót.  Ha a rendszerünkben
	  kérésre akarjuk tárcsázni a
	  szolgáltatónkat, akkor a
	  <filename>tun0</filename> eszközt mindenképpen
	  vegyük fel az értékébe, minden
	  más esetben pedig távolítsuk el.</para>

	<programlisting>network_interfaces="lo0 tun0"
ifconfig_tun0=</programlisting>

	<note>
	  <para>Az <literal>ifconfig_tun0</literal>
	    változónak üres értéket
	    kell megadnunk, és létre kell hoznunk egy
	    <filename>/etc/start_if.tun0</filename> nevû
	    állományt.  Ebben a következõ sornak
	    kell szerepelnie:</para>

	  <programlisting>ppp -auto <replaceable>arendszerem</replaceable></programlisting>

	  <para>Ez a szkript a hálózat
	    beállításakor fut le, és a ppp
	    démont automatikus módban indítja el.
	    Ha az adott gép egy helyi hálózat
	    átjárója is egyben, akkor az
	    <option>-alias</option> kapcsolót is érdemes
	    megadnunk mellette.  A pontosabb részletek
	    tekintetében olvassuk el a megfelelõ man
	    oldalt.</para>
	</note>

	<para>Az <filename>/etc/rc.conf</filename>
	  állományban a <literal>NO</literal>
	  érték megadásával tiltsuk le az
	  útválasztást végzõ program
	  használatát:</para>

	<programlisting>router_enable="NO"</programlisting>

	<indexterm><primary><application>routed</application></primary></indexterm>

	<para>Fontos, hogy a <command>routed</command> démon ne
	  induljon el, mivel <command>routed</command> hajlamos
	  törölni a <command>ppp</command> által
	  létrehozott alapértelmezett
	  útválasztási bejegyzéseket.</para>

	<para>Ezenkívül még a
	  <literal>sendmail_flags</literal>
	  változóról szóló
	  sorból is érdemes kivenni a <option>-q</option>
	  opciót, máskülönben a
	  <command>sendmail</command> minden mûvelet
	  megkezdése elõtt nekiáll felderíteni
	  a hálózatot, és ezzel megindítja a
	  tárcsázást.  Próbáljuk meg
	  így átírni az
	  értékét:</para>

	<programlisting>sendmail_flags="-bd"</programlisting>

	<indexterm><primary><application>sendmail</application></primary></indexterm>

	<para>Ezért cserébe viszont a
	  <command>sendmail</command> programot a ppp kapcsolat
	  létrejöttekor mindig utasítanunk kell, hogy
	  újból ellenõrizze a levelezési sort.
	  Ezt a következõk begépelésével
	  érhetjük el:</para>

	<screen>&prompt.root; <userinput>/usr/sbin/sendmail -q</userinput></screen>

	<para>Ugyanezt automatikusan is meg tudjuk tenni a
	  <command>!bg</command> paranccsal a
	  <filename>ppp.linkup</filename>
	  állományban:</para>

	<programlisting>1     szolgaltato:
2       delete ALL
3       add 0 0 HISADDR
4       !bg sendmail -bd -q30m</programlisting>

	<indexterm><primary>SMTP</primary></indexterm>

	<para>Ha nem felelne meg ez a megoldás, akkor egy
	  <quote>dfilter</quote> is beállítható az
	  SMTP forgalom szûrésére.  A
	  példák között megtaláljuk ennek
	  pontos minkéntjét.</para>

	<para>Ezután már csak a gépünk
	  újraindítása maradt hátra.  Az
	  újraindítás után már be is
	  gépelhetjük:</para>

	<screen>&prompt.root; <userinput>ppp</userinput></screen>

	<para>ahol a <command>dial szolgaltato</command> parancs
	  kiadásával meg tudjuk kezdeni a PPP kapcsolat
	  felépítését, vagy a
	  <command>ppp</command> programot megkérhetjük
	  arra, hogy automatikusan kezdje el, amint van kimenõ
	  forgalom (és nem készítettük el a
	  <filename>start_if.tun0</filename> szkriptet).  Ekkor
	  gépeljük be ezt:</para>

	<screen>&prompt.root; <userinput>ppp -auto szolgaltato</userinput></screen>
      </sect3>

      <sect3>
	<title>Összefoglalás</title>

	<para>Gyorsan foglaljuk össze, hogy az ppp
	  beállításához milyen
	  lépések megtétele szükséges
	  az elsõ alkalommal:</para>

	<para>A kliens oldalán:</para>

	<procedure>
	  <step>
	    <para>Gyõzõdjünk meg róla, hogy a
	      <filename>tun</filename> eszköz benne van a
	      rendszermagban.</para>
	  </step>

	  <step>
	    <para>Ellenõrizzük, hogy a
	      <filename>tunN</filename>
	      eszközhöz tartozó állomány
	      rendelkezésre áll a
	      <filename>/dev</filename>
	      könyvtárban.</para>
	  </step>

	  <step>
	    <para>Hozzunk létre egy bejegyzést az
	      <filename>/etc/ppp/ppp.conf</filename>
	      állományban.  A
	      <filename>pmdemand</filename>
	      példából a legtöbb
	      szolgáltató esetében ki tudunk
	      indulni.</para>
	  </step>

	  <step>
	    <para>Ha dinamikus IP-címet kapunk, akkor az
	      <filename>/etc/ppp/ppp.linkup</filename>
	      állományba is vegyünk fel egy
	      bejegyzést.</para>
	  </step>

	  <step>
	    <para>Frissítsük az
	      <filename>/etc/rc.conf</filename>
	      állományunkat.</para>
	  </step>

	  <step>
	    <para>Ha igény szerint akarunk
	      tárcsázni, akkor hozzunk létre
	      <filename>start_if.tun0</filename> néven egy
	      szkriptet.</para>
	  </step>
	</procedure>

	<para>A szerver oldalán:</para>

	<procedure>
	  <step>
	    <para>Gondoskodjunk róla, hogy a
	      <filename>tun</filename> eszköz
	      támogatása szerepel rendszermagban.</para>
	  </step>

	  <step>
	    <para>Gyõzõdjünk meg róla, hogy a
	      <filename>tunN</filename>
	      eszköz megtalálható a <filename>/dev</filename>
	      könyvtárban.</para>
	  </step>

	  <step>
	    <para>Az <filename>/etc/passwd</filename>
	      állományban (a &man.vipw.8; program
	      használatával) hozzunk létre
	      bejegyzéseket.</para>
	  </step>

	  <step>
	    <para>A felhasználók könyvtáraiban
	      hozzunk létre egy olyan profilt, amely <command>ppp
	      -direct direct-server</command> vagy egy ehhez
	      hasonló parancsot futtat le.</para>
	  </step>

	  <step>
	    <para>Az <filename>/etc/ppp/ppp.conf</filename>
	      állományban adjuk meg egy bejegyzést.
	      A <filename>direct-server</filename> példa ehhez
	      egy remek alapot biztosít.</para>
	  </step>

	  <step>
	    <para>Az <filename>/etc/ppp/ppp.linkup</filename>
	      állományban hozzunk létre egy
	      bejegyzést.</para>
	  </step>

	  <step>
	    <para>Frissítsük az
	      <filename>/etc/rc.conf</filename>
	      állományunkat.</para>
	  </step>
	</procedure>
      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="ppp">
    <info><title>A rendszerszintû PPP alkalmazása</title>
      <authorgroup>
	<author><personname><firstname>Gennady B.</firstname><surname>Sorokopud</surname></personname><contrib>Egyes részeit készítette:
	    </contrib></author>
	<author><personname><firstname>Robert</firstname><surname>Huff</surname></personname></author>
      </authorgroup>
    </info>

    

    <warning>
      <para>Ez a szakasz csak &os;&nbsp;7.<replaceable>X</replaceable>
	esetén érvényes.</para>
    </warning>

    <sect2>
      <title>A rendszerszintû PPP
	beállítása</title>

      <indexterm>
	<primary>PPP</primary>
	<secondary>rendszer PPP</secondary>
      </indexterm>

      <para>Mielõtt a gépünkön nekikezdünk a
	PPP beállításának,
	ellenõrizzük, hogy a <command>pppd</command>
	megtalálható a <filename>/usr/sbin</filename> könyvtárban
	és az <filename>/etc/ppp</filename>
	könyvtár létezik.</para>

      <para>A <command>pppd</command> két módban
	képes mûködni:</para>

      <orderedlist>
	<listitem>
	  <para><quote>kliensként</quote> &mdash; a
	    gépünket soros vonali vagy modemes PPP
	    kapcsolaton keresztül csatlakoztatjuk a
	    külvilághoz</para>
	</listitem>

	<listitem>
	  <para><quote>szerverként</quote> &mdash; a
	    számítógépünk egy
	    hálózat része, ahol a többieket a
	    PPP<indexterm><primary>PPP</primary><secondary>szerver</secondary></indexterm> használatával kapcsoljuk össze</para>
	</listitem>
      </orderedlist>

      <para>Mind a két esetben egy konfigurációs
	állomány tartalmát kell
	összeállítanunk (ez az
	<filename>/etc/ppp/options</filename> vagy a
	<filename>~/.ppprc</filename>, ha a gépünkön
	több felhasználó is PPP-t akar
	használni).</para>

      <para>Egy modemes vagy soros vonali szoftverre is
	szükségünk lesz (ez többnyire a <package>comms/kermit</package>), amellyel távoli
	gépeket tudunk felhívni és
	feléjük kapcsolatot felépíteni.</para>
    </sect2>

    <sect2>
      <info><title>A <command>pppd</command> mint kliens</title>
	<authorgroup>
	  <author><personname><firstname>Trev</firstname><surname>Roydhouse</surname></personname><contrib>Az alapjául szolgáló
	      információkat adta: </contrib></author>
	</authorgroup>
      </info>

      

      <indexterm>
	<primary>PPP</primary>
	<secondary>kliens</secondary>
      </indexterm>

      <indexterm><primary>Cisco</primary></indexterm>

      <para>A most következõ
	<filename>/etc/ppp/options</filename> állománnyal
	egy Cisco terminál szerverhez tudunk kapcsolódni
	egy PPP vonalon keresztül.</para>

      <programlisting>crtscts         # a hardveres forgalomirányítás engedélyezése
modem           # modem vezérlõvonal
noipdefault     # a távoli PPP szervernek kell IP-címet adnia
                # ha az IPCP alapú egyeztetés során a távoli gép nem küld
                # nekünk IP-címet, akkor vegyük ki ezt a beállítást
passive         # LCP csomagokat várunk
domain ppp.ize.com      # ide írjuk be a hálózati nevünket

:<replaceable>távoli_ip</replaceable>    # ide kell írni a távoli PPP szerver IP-címét
                # a PPP kapcsolaton keresztül erre fogjuk továbbküldeni a csomagokat
                # ha nem adtuk meg "noipdefault" beállítást, akkor ezt a sort
                # írjuk át <replaceable>helyi_ip</replaceable>:<replaceable>távoli_ip</replaceable> alakúra

defaultroute    # adjuk meg ezt a sort is, ha a PPP szerverünket egyben az
                # alapértelmezett átjárónak is be akarjuk állítani</programlisting>

      <para>Így kapcsolódunk:</para>

      <indexterm><primary>Kermit</primary></indexterm>
      <indexterm><primary>modem</primary></indexterm>

      <procedure>
	<step>
	  <para>Tárcsázzuk a távoli gépet a
	    <application>Kermit</application> (vagy bármilyen
	    más modemes program)
	    elindításával, majd adjuk meg a
	    felhasználói nevünket és
	    jelszavunkat (vagy bármi mást, amivel a
	    távoli gépen engedélyezni tudjuk a PPP
	    használatát).</para>
	</step>

	<step>
	  <para>Lépjünk ki a
	    <application>Kermit</application> programból
	    (anélkül, hogy bontanánk a
	    vonalat).</para>
	</step>

	<step>
	  <para>Írjuk be a következõket:</para>

	  <screen>&prompt.root; <userinput>/usr/sbin/pppd /dev/tty01 19200</userinput></screen>

	  <para>Ne felejtsük el megadni a megfelelõ
	    sebességet és eszközt.</para>
	</step>
      </procedure>

      <para>A számítógépünk most
	már PPP-n keresztül csatlakozik.  Ha valamilyen
	okból nem sikerülne felépíteni a
	kapcsolatot, akkor vegyük fel a <option>debug</option>
	beállítást is az
	<filename>/etc/ppp/options</filename> állományba,
	majd a konzolra érkezõ üzenetek
	segítségével próbáljuk meg
	felderíteni a probléma okát.</para>

      <para>Az alábbi <filename>/etc/ppp/pppup</filename> szkript
	mind a három fázist automatikussá
	teszi:</para>

      <programlisting>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.dial
pppd /dev/tty01 19200</programlisting>

      <indexterm><primary>Kermit</primary></indexterm>

      <para>Az <filename>/etc/ppp/kermit.dial</filename> egy olyan
	<application>Kermit</application> szkript, amivel
	tárcsázni tudunk és a távoli
	gépen elvégezni az összes
	szükséges hitelesítést (a
	leírás végén találhatunk is
	egy ilyen szkriptet példaként).</para>

      <para>Az alábbi <filename>/etc/ppp/pppdown</filename>
	szkripttel tudjuk bontani a PPP vonalat:</para>

      <programlisting>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill -TERM ${pid}
fi

pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

/sbin/ifconfig ppp0 down
/sbin/ifconfig ppp0 delete
kermit -y /etc/ppp/kermit.hup
/etc/ppp/ppptest</programlisting>

      <para>A <filename>/usr/etc/ppp/ppptest</filename>
	elindításával ellenõrizni tudjuk, hogy
	a <command>pppd</command> még mindig fut.  Ez valahogy
	így néz ki:</para>

      <programlisting>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != "X" ] ; then
        echo 'pppd running: PID=' ${pid-NONE}
else
        echo 'No pppd running.'
fi
set -x
netstat -n -I ppp0
ifconfig ppp0</programlisting>

      <para>A vonal bontásához az
	<filename>/etc/ppp/kermit.hup</filename> szkriptet kell
	elindítanunk, amiben a következõ
	szerepelnek:</para>

      <programlisting>set line /dev/tty01	; ide írjuk be a saját modemünket
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
echo \13
exit</programlisting>

      <para>A <command>kermit</command> helyett a
	<command>chat</command> programot is
	használhatjuk:</para>

      <para>A következõ két állomány
	már elég egy kapcsolat
	létrehozásához <command>pppd</command>
	használatával:</para>

      <para><filename>/etc/ppp/options</filename>:</para>

      <programlisting>/dev/cuad1 115200

crtscts		# a hardveres forgalomirányítás engedélyezése
modem		# modemes vezérlõvonal
connect "/usr/bin/chat -f /etc/ppp/login.chat.script"
noipdefault	# a távoli PPP kiszolgálónak adnia kell egy IP-címet
	        # ha a távoli gép nem küldi az IP-címünk az IPCP alapú egyeztetés során
                # akkor távolítsuk el ezt a beállítást
passive         # LCP csomagokat várunk
domain <replaceable>sajat.tartomany</replaceable>	# ide írjuk be a saját tartománynevünket

:		# a távoli PPP kiszolgáló IP-címét tegyük ide
	        # ezen keresztül fogjuk továbbküldeni a PPP kapcsolaton áthaladó csomagokat
                # nem adtuk meg a "noipdefault" beállítást, akkor ezt
                # sort írjuk át <replaceable>helyi_ip</replaceable>:<replaceable>távoli_ip</replaceable> alakúra

defaultroute	# ez a sor akkor kell, ha a PPP szerver lesz az
	        # alapértelmezett átjárónk is</programlisting>

      <para><filename>/etc/ppp/login.chat.script</filename>:</para>

      <note>
	<para>A most következõt egyetlen sorba kell
	  írnunk.</para>
      </note>

      <programlisting>ABORT BUSY ABORT 'NO CARRIER' "" AT OK ATDT<replaceable>telefon.szám</replaceable>
  CONNECT "" TIMEOUT 10 ogin:-\\r-ogin: <replaceable>bejelentkezési-azonosító</replaceable>
  TIMEOUT 5 sword: <replaceable>jelszó</replaceable></programlisting>

      <para>Miután ezeket telepítettük és a
	megfelelõképpen módosítottuk,
	már csak a <command>pppd</command> parancsot kell
	kiadnunk, valahogy így:</para>

      <screen>&prompt.root; <userinput>pppd</userinput></screen>
    </sect2>

    <sect2>
      <title>A <command>pppd</command> mint szerver</title>

      <para>Az <filename>/etc/ppp/options</filename>
	állományban nagyjából a
	következõknek kell szerepelnie:</para>

      <programlisting>crtscts                         # hardveres forgalomirányítás
netmask 255.255.255.0           # hálózati maszk (nem kötelezõ)
192.114.208.20:192.114.208.165  # a helyi és távoli gépek IP-címei
                                # a helyi IP-nek el kell térnie az Ethernet
                                # (vagy más egyéb) felülethez tartozó címtõl.
                                # a távoli IP a távoli géphez rendelt IP-cím
domain ppp.ize.com              # a saját tartományunk
passive                         # az LCP csomagok várása
modem                           # modemes vonal</programlisting>

      <para>Az alábbi <filename>/etc/ppp/pppserv</filename>
	szkript a <application>pppd</application> démont
	szervernek állítja be:</para>

      <programlisting>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi

# reset ppp interface
ifconfig ppp0 down
ifconfig ppp0 delete

# enable autoanswer mode
kermit -y /etc/ppp/kermit.ans

# run ppp
pppd /dev/tty01 19200</programlisting>

      <para>A szerver leállítására a
	következõ <filename>/etc/ppp/pppservdown</filename>
	szkriptet kell használnunk:</para>

      <programlisting>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ "X${pid}" != "X" ] ; then
        echo 'killing pppd, PID=' ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ "X${pid}" != "X" ] ; then
        echo 'killing kermit, PID=' ${pid}
        kill -9 ${pid}
fi
ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.noans</programlisting>

      <para>A következõ <application>Kermit</application>
	szkript (<filename>/etc/ppp/kermit.ans</filename>)
	engedélyezi vagy tiltja le a modem automatikus
	válaszadását.  Körülbelül
	így épül fel:</para>

      <programlisting>set line /dev/tty01
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
inp 5 OK
echo \13
out ATS0=1\13   ; "ATS0=0\13"-ra írjuk át, ha le akarjuk tiltani az
                ; automatikus válaszadást
inp 5 OK
echo \13
exit</programlisting>

      <para>Az <filename>/etc/ppp/kermit.dial</filename>
	elnevezésû szkriptet használhatjuk arra, hogy
	tárcsázzunk távoli gépeket és
	hitelesítsük magunkat rajtuk.  Írjuk
	át az igényeinknek megfelelõen, tegyük
	bele a bejelentkezéshez szükséges
	azonosítót és jelszót, illetve a
	modemünk és a távoli gép
	válaszai szerint módosítsuk az
	<literal>input</literal> utasításokat.</para>

      <programlisting>;
; írjuk ide azt a com vonalat, amire a modemünk csatlakozik:
;
set line /dev/tty01
;
; ide kerül a modem sebessége:
;
set speed 19200
set file type binary            ; teljes 8 bites állomány-átvitel
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none
set modem hayes
set dial hangup off
set carrier auto                ; adjuk meg a SET CARRIER utasítást is, ha kell
set dial display on             ; adjuk meg a SET DIAL utasítást is, ha kell
set input echo on
set input timeout proceed
set input case ignore
def \%x 0                       ; a bejelentkezés számlálója
goto slhup

:slcmd                          ; tegyük a modemet parancs módba
echo Tegyuk a modemet parancs modba.
clear                           ; töröljük a be nem olvasott karaktereket a bemeneti pufferbõl
pause 1
output +++                      ; a Hayes-féle helyettesítési szekvenciák használata
input 1 OK\13\10                ; várjuk meg az OK jelzést
if success goto slhup
output \13
pause 1
output at\13
input 1 OK\13\10
if fail goto slcmd              ; ha a modem nem válaszol OK-val, akkor próbálkozzunk újra

:slhup                          ; bontsuk a vonalat
clear                           ; töröljük ki a be nem olvasott karaktereket a bemeneti pufferbõl
pause 1
echo A vonal bontasa.
output ath0\13                  ; a kapcsolat létrejöttét jelzõ Hayes-parancs
input 2 OK\13\10
if fail goto slcmd              ; ha nincs OK válasz, akkor tegyük a modemet parancs módba

:sldial                         ; tárcsázzuk a számot
pause 1
echo Dialing.
output atdt9,550311\13\10       ; ide írjuk a telefonszámot
assign \%x 0                    ; nullázzuk le az idõzítõt

:look
clear                           ; töröljük az olvasatlan karaktereket a bemeneti pufferbõl
increment \%x                   ; számoljuk a másodperceket
input 1 {CONNECT }
if success goto sllogin
reinput 1 {NO CARRIER\13\10}
if success goto sldial
reinput 1 {NO DIALTONE\13\10}
if success goto slnodial
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 60 goto look
else goto slhup

:sllogin                        ; bejelentkezés
assign \%x 0                    ; nullázzuk le az idõzítõt
pause 1
echo A bejelentkezes keresese.

:slloop
increment \%x                   ; számoljuk a másodperceket
clear                           ; töröljük az olvasatlan karaktereket a bemeneti pufferbõl
output \13
;
; ide írjuk be a várható bejelentkezési sablont:
;
input 1 {Felhasznaloi nev: }
if success goto sluid
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 10 goto slloop      ; tízszer próbálkozzunk a bejelentkezéssel
else goto slhup                 ; 10 sikertelen próbálkozás után bontsuk a vonalat és kezdjük újra

:sluid
;
; ide írjuk be a felhasználói azonosítónkat:
;
output ppp-login\13
input 1 {Jelszo: }
;
; ide tegyük a hozzá tartozó jelszót:
;
output ppp-password\13
input 1 {Atvaltas SLIP modba.}
echo
quit

:slnodial
echo \7Nincs vonal.  Ellenorizzuk a telefonvonalat!\7
exit 1

; local variables:
; mode: csh
; comment-start: "; "
; comment-start-skip: "; "
; end:</programlisting>
    </sect2>
  </sect1>

  <sect1 xml:id="ppp-troubleshoot">
    <info><title><acronym>PPP</acronym> kapcsolatok
      hibaelhárítása</title>
      <authorgroup>
	<author><personname><firstname>Tom</firstname><surname>Rhodes</surname></personname><contrib>Készítette: </contrib></author>
      </authorgroup>
    </info>

    

    <indexterm>
      <primary>PPP</primary>
      <secondary>hibaelhárítás</secondary>
    </indexterm>

      <warning>
	<para>A &os; 8.0 kiadásától
	  kezdõdõen a &man.sio.4; meghajtó
	  szerepét a &man.uart.4; veszi át.  Emiatt a
	  soros vonali eszközöket <filename>/dev/cuadN</filename>
	  és <filename>/dev/cuauN</filename>
	  helyett <filename>/dev/ttydN</filename>
	  és <filename>/dev/ttyuN</filename>
	  néven lehet elérni.  A &os;
	  7.<replaceable>X</replaceable> változatok
	  felhasználóinak ennek megfelelõen kell
	  olvasniuk ezt a leírást.</para>
      </warning>

      <para>Ebben a szakaszban összefoglalunk néhány
	olyan problémát, ami a PPP modemen keresztüli
	használata során keletkezhet.
	Például pontosan tisztában kell
	lennünk azzal, hogy a tárcsázott rendszer
	milyen adatokat és hogyan fog tõlünk
	bekérni.  Egyes szolgáltatók egy
	<literal>ssword</literal> promptot, míg mások egy
	<literal>password</literal> promptot adnak.  Ha a
	<command>ppp</command> szkript nem illeszkedik ezekhez az
	elvárásokhoz, akkor nem tudunk bejelentkezni.  A
	<command>ppp</command> csatlakozások
	nyomonkövetésének egyik leggyakoribb
	módja a manuális kapcsolódás.  A
	következõkben ezért a manuális
	csatlakozásokra vonatkozó
	legszükségesebb ismereteket mutatjuk be
	lépésrõl lépésre.</para>

    <sect2>
      <title>Az eszközleírók
	ellenõrzése</title>

      <para>Ha saját rendszermagot használunk, ne
	felejtsük el felvenni a következõ sort a
	konfigurációs állományba:</para>

      <programlisting>device   uart</programlisting>

      <para>A <literal>GENERIC</literal> rendszermag az
	<filename>uart</filename> eszközt már
	alapértelmezés szerint tartalmazza, ezért
	ilyenkor már nincs több teendõnk.
	Egyszerûen csak a <command>dmesg</command> parancs
	kimenetében keressük meg a modemes
	eszközhöz tartozó adatokat:</para>

      <screen>&prompt.root; <userinput>dmesg | grep uart</userinput></screen>

      <para>Ennek eredményeképpen kapunk egy rövid
	összefoglalást a <filename>uart</filename>
	típusú eszközökrõl.  Ezek lesznek a
	számunkra fontos COM portok.  Amennyiben a modemünk
	egy szabványos soros portként mûködik,
	akkor a <filename>uart1</filename> vagy
	<filename>COM2</filename> néven kell keresnünk.
	Ha megtaláltuk, akkor nem kell új rendszermagot
	fordítanunk.  Amikor a soros vonali modemünk a
	<filename>uart1</filename> vagy
	<filename>COM2</filename> porton csatlakozik DOS-ban, akkor
	itt a neki megfelelõ eszköz a <filename>/dev/cuau1</filename> lesz.</para>
    </sect2>

    <sect2>
      <title>Kapcsolódás manuálisan</title>

      <para>A <command>ppp</command> kézi
	irányításával gyorsan,
	egyszerûen és minden fájdalomtól
	mentesen tudunk csatlakozni az internethez, de olyankor is
	hasznos, ha ki akarjuk deríteni, hogy az
	internet-szolgáltatónk milyen módon kezeli
	a kliensek <command>ppp</command> csatlakozásait.  Nos,
	akkor ehhez indítsuk is el a
	<application>PPP</application> alkalmazást a
	paranccsorból.  Az alábbi példákban
	rendre a <emphasis>pelda</emphasis> névvel hivatkozunk a
	<application>PPP</application>-t mûködtetõ
	gépre.  A <command>ppp</command> tehát a
	<command>ppp</command> parancs
	begépelésével
	indítható:</para>

      <screen>&prompt.root; <userinput>ppp</userinput></screen>

      <para>Ezzel elindítottuk a <command>ppp</command>
	programot.</para>

      <screen>ppp ON pelda&gt; <userinput>set device /dev/cuau1</userinput></screen>

      <para>Beállítjuk a modemünket, ami ebben az
	esetben a <filename>cuau1</filename>.</para>

      <screen>ppp ON pelda&gt; <userinput>set speed 115200</userinput></screen>

      <para>Beállítjuk a csatlakozás
	sebességét, ami ebben az esetben 115&nbsp;200
	kbit/mp.</para>

      <screen>ppp ON pelda&gt; <userinput>enable dns</userinput></screen>

      <para>Azt mondjuk a <command>ppp</command> programnak, hogy
	állítsa be a névfeloldót és
	az <filename>/etc/resolv.conf</filename> állományt
	egészítse ki a megfelelõ
	névszerverekkel.  Ha a <command>ppp</command> nem
	képes megállapítani a gépünk
	nevét, akkor késõbb ezt még
	kézzel is be tudjuk állítani.</para>

      <screen>ppp ON pelda&gt; <userinput>term</userinput></screen>

      <para>Váltsunk <quote>terminál</quote> módba,
	így mi irányítjuk a modemet.</para>

      <programlisting>deflink: Entering terminal mode on /dev/cuau1
type '~h' for help</programlisting>

      <screen><userinput>at</userinput>
OK
<userinput>atdt123456789</userinput></screen>

      <para>Az <command>at</command> paranccsal hozzuk alaphelyzetbe a
	modemet, majd a <command>atdt</command> paranccsal és egy
	telefonszám megadásával megkezdjük a
	szolgáltató
	tárcsázását.</para>

      <screen>CONNECT</screen>

      <para>Ezzel jelez vissza a kapcsolódás
	megkezdésérõl.  Ha itt bármilyen
	hardvertõl független csatlakozási
	probléma merülne fel, akkor ezen a ponton tudunk
	ellene tenni valamit.</para>

      <screen>ISP Login:<userinput>felhasznalonev</userinput></screen>

      <para>Itt kell megadnunk a felhasználói
	nevünket, ami megegyezik a szolgáltató
	által adott azonosítónkkal.</para>

      <screen>ISP Pass:<userinput>jelszo</userinput></screen>

      <para>Ezúttal a jelszavunkat kell megadni, amit
	szintén a szolgáltató bocsátott
	rendelkezésünkre az azonosító mellett.
	Akárcsak amikor bejelentkezünk a &os;-be, itt sem
	fog látszódni a jelszavunk.</para>

      <screen>Shell or PPP:<userinput>ppp</userinput></screen>

      <para>Szolgáltatótól függõen
	elõfordulhat, hogy ez a sor soha nem is jelenik meg.  Itt
	kérdezik meg, hogy a szolgáltatónál
	egy shellt akarunk használni, vagy csak elindítani
	egy <command>ppp</command> kapcsolatot.  Ebben a
	példában természetesen a
	<command>ppp</command> opciót választjuk, mivel
	egy internet-elõfizetés birtokosai vagyunk.</para>

      <screen>Ppp ON pelda&gt;</screen>

      <para>Figyeljük meg, hogy az elsõ <option>p</option>
	nagybetûssé vált.  Ezzel jelzi a program,
	hogy sikeresen csatlakoztunk a
	szolgáltatónkhoz.</para>

      <screen>PPp ON pelda&gt;</screen>

      <para>Sikeresen azonosítottuk magunkat a
	szolgáltató felé és várjuk az
	IP-címünket.</para>

      <screen>PPP ON pelda&gt;</screen>

      <para>Megkaptuk az IP-címünket és ezzel
	sikeresen felépült a kapcsolat.</para>

      <screen>PPP ON pelda&gt;<userinput>add default HISADDR</userinput></screen>

      <para>Itt adjuk hozzá az alapértelmezett
	útvonalat, amire mindenképpen
	szükségünk van ahhoz, hogy a
	külvilággal is kapcsolatban tudjunk lépni,
	mivel jelenleg csak a vonal másik végén
	lévõ gépet érjük el.  Ha ezt
	bizonyos, már meglevõ útvonalak miatt nem
	sikerül felvenni, akkor az <option>add</option> elé
	tegyünk egy <literal>!</literal> jelet.  Ezt viszont a
	kapcsolat felépítése elõtt is
	megtehetjük, így menet közben az új
	útvonalat felveszi a többi közé.</para>

      <para>Ha eddig minden remekül ment, akkor ezen ponton
	már egy élõ internet-kapcsolattal
	rendelkezünk, és a programot a <keycombo action="simul"><keycap>CTRL</keycap><keycap>z</keycap></keycombo>
	lenyomásával a háttérbe is
	tehetjük.  Ha a <command>PPP</command> felirat ismét
	a <command>ppp</command> feliratra váltana, akkor az arra
	utal, hogy elvesztettük a kapcsolatot.  Erre nem árt
	figyelni, mivel ezzel jelzi az aktuális kapcsolat
	állapotát.  A nagybetûs P-k jelölik,
	hogy az adott szinten megvan a kapcsolat a
	szolgáltató felé, a kisbetûs p-k pedig
	arra utalnak, hogy azon a szinten a kapcsolat valamiért
	megszûnt.  A <command>ppp</command> csak ezt a két
	állapotot ismeri.</para>

      <sect3>
	<title>Nyomkövetés</title>

	<para>Ha közvetlen vonalunk van és mégsem
	  sikerül kapcsolatot létesíteni, akkor
	  tiltsuk le a hardveres <acronym>CTS/RTS</acronym>
	  forgalomirányítást a <option>set ctsrts
	  off</option> paranccsal.  Ez leginkább akkor fordul
	  elõ, ha csatlakoztunk egy olyan
	  terminálszerverhez, amely valamennyire képes
	  kezelni a <application>PPP</application> kapcsolatokat, de a
	  <application>PPP</application> megáll, mikor adatot
	  próbál írni a kommunikációs
	  csatornára, mivel arra a <acronym>CTS</acronym> (Clear
	  To Send &mdash; <quote>lehet küldeni</quote>)
	  jelzésre vár, amely soha nem fog
	  megérkezni.  Ha mégis ezt a
	  beállítást akarjuk használni,
	  akkor a <option>set accmap</option>
	  beállításra is
	  szükségünk lesz, mivel ez kell bizonyos
	  karakterek hardverfüggõ
	  átküldésének
	  felülbírálásához,
	  legtöbb esetben a XON/XOFF miatt.  A &man.ppp.8; man
	  oldalon találhatunk errõl és ennek
	  használatáról részletesebb
	  leírást.</para>

	<para>Ha egy régebbi gyártmányú
	  modemünk van, akkor a <option>set parity even</option>
	  beállítás alkalmazása is javasolt.
	  Alapértelmezés szerint ugyanis nincs
	  paritás, de a régebbi modemek és (a
	  forgalom növekedésével) egyes
	  szolgáltatók még használják
	  hibaellenõrzésre.  Ha Compuserve
	  elõfizetésünk van, mindenképpen
	  kapcsoljuk be.</para>

	<para>Amikor a <application>PPP</application> nem tér
	  vissza parancs módba, akkor gyaníthatóan
	  az egyeztetésben lesz valahol probléma, mivel a
	  szolgáltató a kliensüktõl várja
	  a kezdeményezését.  Ezen a ponton a
	  <command>~p</command> paranccsal utasíthatjuk a ppp
	  programot a konfigurációs
	  információk
	  átküldésének
	  megkezdésére.</para>

	<para>Ha egyáltalán nem kapunk promptot a
	  bejelentkezéshez, akkor nagy a
	  alószínûsége, hogy az iménti
	  &unix; stílusú hitelesítés helyett
	  <acronym>PAP</acronym> vagy <acronym>CHAP</acronym> protokollt
	  kell használnunk.  A <acronym>PAP</acronym> vagy
	  <acronym>CHAP</acronym> használatához
	  mindössze a következõ
	  beállításokat kell megadnunk
	  <application>PPP</application> programnak a terminál
	  mód aktiválása elõtt:</para>

	<screen>ppp ON pelda&gt; <userinput>set authname felhasznalonev</userinput></screen>

	<para>ahol a <replaceable>felhasznalonev</replaceable> helyett a
	  szolgáltatótól kapott
	  azonosítót kell beírnunk.</para>

	<screen>ppp ON pelda&gt; <userinput>set authkey jelszo</userinput></screen>

	<para>ahol a <replaceable>jelszo</replaceable> helyett a
	  szolgáltatótól kapott jelszót kell
	  megadnunk.</para>

	<para>Ha sikeresen csatlakoztunk, de még nem
	  találunk semmilyen tartománynevet, akkor a
	  &man.ping.8; és IP-cím
	  segítségével tudjuk megvizsgálni,
	  hogy mûködõképes-e a kapcsolat.  Ha
	  100&nbsp;százalékos (100%) csomagvesztést
	  (packet loss) tapasztalunk, akkor szinte biztos, hogy nincs
	  meg az alapértelmezett útvonal.
	  Nézzük meg újra, hogy az <option>add
	  default HISADDR</option> beállítást
	  megadtuk-e a kapcsolat felépítésekor.  Ha
	  viszont már el tudunk érni egy távoli
	  IP-címet, akkor nagyon valószínû,
	  hogy az <filename>/etc/resolv.conf</filename>
	  állományba nem került bele a megfelelõ
	  névfeloldó címe.  Az említett
	  állománynak valahogy így kellene
	  kinéznie:</para>

	<programlisting>domain <replaceable>minta.com</replaceable>
nameserver <replaceable>x.x.x.x</replaceable>
nameserver <replaceable>y.y.y.y</replaceable></programlisting>

	<para>Ahol az <replaceable>x.x.x.x</replaceable> és
	  <replaceable>y.y.y.y</replaceable> címeket a
	  szolgáltatónk névszervereinek
	  címével kell behelyettesíteni.  Ez nem
	  minden esetben található meg az
	  elõfizetõi szerzõdésben, de ha
	  felhívjuk a szolgáltatónkat, akkor minden
	  bizonnyal elárulják ezeket a
	  címeket.</para>

	<para>A &man.syslog.3; is alkalmas a
	  <application>PPP</application> kapcsolatok
	  naplózására.  Ehhez csupán ennyit
	  kell megadnunk az <filename>/etc/syslog.conf</filename>
	  állományban:</para>

	<programlisting>!ppp
*.*     /var/log/ppp.log</programlisting>

	<para>A legtöbb esetben ez a lehetõség
	  már eleve adott.</para>

      </sect3>
    </sect2>
  </sect1>

  <sect1 xml:id="pppoe">
    <info><title>A PPP használata Ethernet felett (PPPoE)</title>
      <authorgroup>
	<author><personname><firstname>Jim</firstname><surname>Mock</surname></personname><contrib>Készítette (a
	    http://node.to/freebsd/how-tos/how-to-freebsd-pppoe.html
	    alapján): </contrib></author>
      </authorgroup>
    </info>

    

    <indexterm>
      <primary>PPP</primary>
      <secondary>over Ethernet</secondary>
    </indexterm>

    <indexterm>
      <primary>PPPoE</primary>
      <see>PPP, over Ethernet</see>
    </indexterm>

    <para>Ebben a szakaszban azt ismertetjük, hogyan
      állítsuk be a PPP-t Ethernet felett (PPP over
      Ethernet, <acronym>PPPoE</acronym>).</para>

    <sect2>
      <title>A rendszermag beállítása</title>

      <para>A PPPoE mûködéséhez most már
	semmilyen módosításra nincs
	szükség a rendszermag
	beállításaiban.  Amennyiben a hozzá
	szükséges Netgraph támogatás nem
	található a rendszermagban, akkor azt a
	<application>ppp</application> önmûködõen
	betölti.</para>

    </sect2>

    <sect2>
      <title>A <filename>ppp.conf</filename>
	beállítása</title>

      <para>Íme egy mûködõ
	<filename>ppp.conf</filename> állomány:</para>

      <programlisting>default:
  set log Phase tun command # itt akár egy részletesebb naplózást is be tudunk állítani
  set ifaddr 10.0.0.1/0 10.0.0.2/0

a_szolgaltato_neve:
  set device PPPoE:<replaceable>xl1</replaceable> # az xl1 helyére írjuk be a saját Ethernet eszközünket
  set authname FELHASZNALONEV
  set authkey JELSZO
  set dial
  set login
  add default HISADDR</programlisting>

    </sect2>

    <sect2>
      <title>A <application>ppp</application> futtatása</title>

      <para><systemitem class="username">root</systemitem>
	felhasználóként adjuk ki az alábbi
	parancsot:</para>

      <screen>&prompt.root; <userinput>ppp -ddial a_szolgaltato_neve</userinput></screen>

    </sect2>

    <sect2>
      <title>A <application>ppp</application> indítása a
	rendszerindítás során</title>

      <para>Az <filename>/etc/rc.conf</filename>
	állományba vegyük fel a
	következõket:</para>

      <programlisting>ppp_enable="YES"
ppp_mode="ddial"
ppp_nat="YES"	# csak akkor, ha címfordítás kell a helyi hálózaton, máskülönben "NO"
ppp_profile="a_szolgaltato_neve"</programlisting>

    </sect2>

    <sect2>
      <title>A szolgáltatási címkék
	használata</title>

      <para>Bizonyos esetekben szolgáltatási
	címkét (service tag) is használnunk kell a
	kapcsolat létrehozásához.  A
	szolgáltatási címkék
	segítségével tudjuk
	megkülönböztetni az adott hálózaton
	elérhetõ különbözõ PPPoE
	szervereket.</para>

      <para>A szolgáltatótól kapott
	dokumentációban szerepelnie kell minden ehhez
	kapcsolódó információnak.
	Amennyiben nem találjuk, érdeklõdjünk a
	szolgáltatónál.</para>

      <para>Utolsó reményként
	megpróbálhatjuk a <link linkend="ports">Portgyûjteményben</link>
	található <link xlink:href="http://www.roaringpenguin.com/pppoe/">Roaring Penguin
	PPPoE</link> nevû program által javasolt
	módszert.  Ennél vegyük azonban
	számításba, hogy félre tudja
	programozni a modemünket, amitõl akár
	használhatatlanná is válhat, ezért
	kétszer is gondoljuk meg, mielõtt használni
	kezdjük.  Egyszerûen csak tegyük fel a
	szolgáltatótól a modemünk mellé
	kapott szoftvert.  Ezután lépjünk be a
	program <guimenu>System</guimenu> menüjébe.  Itt
	kell lennie a megfelelõ profilnak, ami
	általában az <emphasis>ISP</emphasis>.</para>

      <para>A profil neve (a szolgáltatás
	címkéje) a <filename>ppp.conf</filename>
	állományban a PPPoE bejegyzés
	részeként jelenik meg a <command>set
	device</command> parancsban (ennek pontos részleteit
	lásd a &man.ppp.8; man oldalon).  Tehát
	nagyjából így néz ki:</para>

      <programlisting>set device PPPoE:<replaceable>xl1</replaceable>:<replaceable>ISP</replaceable></programlisting>

      <para>Az <replaceable>xl1</replaceable> eszköz nevét
	ne felejtsük el a megfelelõ Ethernet
	kártyához tartozó eszköz nevére
	kicserélni.</para>

      <para>Az <replaceable>ISP</replaceable> helyett pedig írjuk
	be az imént kiderített profil nevét.</para>

      <para>A témával kapcsolatban az alábbi
	helyeken találhatunk további
	információkat:</para>

      <itemizedlist>
	<listitem>
	  <para><link xlink:href="http://renaud.waldura.com/doc/freebsd/pppoe/">Cheaper
	    Broadband with FreeBSD on DSL</link>, írta: Renaud
	    Waldura (angolul).</para>
	</listitem>

	<listitem>
	  <para><link xlink:href="http://www.ruhr.de/home/nathan/FreeBSD/tdsl-freebsd.html">
	    Nutzung von T-DSL und T-Online mit FreeBSD</link>,
	    írta: Udo Erdelhoff (németül).</para>
	</listitem>
      </itemizedlist>

    </sect2>

    <sect2 xml:id="ppp-3com">
      <title>PPPoE és a &tm.3com; <trademark class="registered">HomeConnect</trademark> ADSL Modem Dual
	Link</title>

      <para>Ez a modem nem felel meg az <link xlink:href="http://www.faqs.org/rfcs/rfc2516.html">RFC&nbsp;2516</link>
	elõírásainak (<emphasis>A Method for
	transmitting PPP over Ethernet (PPPoE)</emphasis>, írta:
	L.  Mamakos, K.  Lidl, J.  Evarts, D.  Carrel, D.  Simone
	és R.  Wheeler).  Helyette az Ethernet keretekben
	eltérõ csomagtípus kódokat
	használ.  A <link xlink:href="http://www.3com.com/">3Com-nál</link>
	panaszkodjunk, ha szerintünk is be kellene tartaniuk a
	PPPoE specifikációját.</para>

      <para>A &os; is csak akkor lesz képes
	együttmûködni ezzel az eszközzel, ha
	beállítjuk a megfelelõ sysctl
	változót.  Ezt a rendszerindítás
	során automatikusan meg tudjuk tenni az
	<filename>/etc/sysctl.conf</filename>
	módosításával:</para>

      <programlisting>net.graph.nonstandard_pppoe=1</programlisting>

      <para>vagy közvetlenül az alábbi
	paranccsal:</para>

      <screen>&prompt.root; <userinput>sysctl net.graph.nonstandard_pppoe=1</userinput></screen>

      <para>Sajnos, mivel ez egy rendszerszintû
	beállítás, ezért a &tm.3com;
	<trademark class="registered">HomeConnect</trademark> ADSL Modem
	és más normális PPPoE kliens vagy szerver
	egyszerre nem használható.</para>

    </sect2>
  </sect1>

  <sect1 xml:id="pppoa">
    <title><application>PPP</application> ATM felett (PPPoA)</title>

    <indexterm>
      <primary>PPP</primary>
      <secondary>over ATM</secondary>
    </indexterm>

    <indexterm>
      <primary>PPPoA</primary>
      <see>PPP, over ATM</see>
    </indexterm>

    <para>Most a PPP ATM feletti (PPP over ATM, PPPoA)
      beállítását fogjuk bemutatni.  A PPPoA
      az európai DSL szolgáltatók
      körében igen nagy népszerûségnek
      örvend.</para>

    <sect2>
      <title>PPPoA használata az Alcatel &speedtouch;
	USB-vel</title>

      <para>Az ilyen eszközökhöz tartozó PPPoA
	támogatás a &os;-ben portként áll
	rendelkezésre, mivel az ehhez szükséges
	firmware csak az <link xlink:href="http://www.speedtouchdsl.com/disclaimer_lx.htm">Alcatel
	licencelési feltételei szerint</link>
	terjeszthetõ, ezért nem lehet része az alap
	&os; rendszernek.</para>

      <para>A szoftver telepítéséhez ezért a
	<link linkend="ports">Portgyûjteményt</link> kell
	használnunk.  Telepítsük a <package>net/pppoa</package> portot és
	kövessük a mellékelt
	utasításokat.</para>

      <para>Sok más USB-s eszközhöz hasonlóan az
	Alcatel &speedtouch; USB-nek a gépünkrõl kell
	letöltenie a mûködéséhez
	szükséges firmware-t.  Ez a folyamat &os; alatt
	automatizálható, tehát ez a
	másolás minden esetben megtörténik,
	amikor az eszközt az USB portra csatlakoztatjuk.  Ehhez az
	<filename>/etc/usbd.conf</filename> állományba a
	következõ adatokat kell beletennünk.  Az
	állományt <systemitem class="username">root</systemitem>
	felhasználóként tudjuk csak
	szerkeszteni.</para>

      <programlisting>device "Alcatel SpeedTouch USB"
    devname "ugen[0-9]+"
    vendor 0x06b9
    product 0x4061
    attach "/usr/local/sbin/modem_run -f /usr/local/libdata/mgmt.o"</programlisting>

      <para>Az <application>usbd</application>, vagyis az USB
	démon engedélyezéséhez az
	<filename>/etc/rc.conf</filename> állományba
	tegyük bele az alábbit:</para>

      <programlisting>usbd_enable="YES"</programlisting>

      <para>Emellett még a <application>ppp</application>
	kapcsolatot is be tudjuk állítani az
	indítás során.  Ehhez mindössze a
	következõ sort kell megadnunk az
	<filename>/etc/rc.conf</filename> állományban.
	Ismét megemlítjük, hogy ezt a mûveletet
	csak a <systemitem class="username">root</systemitem> felhasználóval
	tudjuk végrehajtani.</para>

      <programlisting>ppp_enable="YES"
ppp_mode="ddial"
ppp_profile="adsl"</programlisting>

      <para>Ezután úgy tudjuk szóra bírni a
	kapcsolatot, ha a <package>net/pppoa</package>
	porthoz mellékelt <filename>ppp.conf</filename>
	állományt használjuk fel
	kiindulásként.</para>

    </sect2>

    <sect2>
      <title>Az mpd használata</title>

      <para>Az <application>mpd</application>
	segítségével többféle
	szolgáltatáshoz, köztük a PPTP-hez
	hozzá tudunk férni.  Az
	<application>mpd</application> a Portgyûjteményben
	<package>net/mpd</package> néven
	található meg.  Sok ADSL modemnek
	szüksége van egy PPTP tunnelre közte és
	gép között.  Ilyen modem például
	az Alcatel &speedtouch; Home is.</para>

      <para>Elõször magát a portot kell
	telepítenünk, majd ezután már be
	tudjuk állítani az
	<application>mpd</application>-t a saját és a
	szolgáltatónk igényei szerint.  A port a
	rengeteg leírással megtûzdelt minta
	konfigurációs állományait a
	<filename>PREFIX/etc/mpd/</filename>
	könyvtárba teszi.  Itt a
	<replaceable>PREFIX</replaceable> azt a könyvtárat
	jelöli, ahova a portok kerülnek.  Ez alapból a
	<filename>/usr/local/</filename>.  Az
	<application>mpd</application>
	beállításáról
	szóló teljes dokumentáció a
	telepítés után elérhetõ HTML
	formátumban a
	<filename>PREFIX/share/doc/mpd/</filename>
	könyvtárban.  Íme egy példa az
	<application>mpd</application>
	beállítására ADSL kapcsolatok
	esetében.  Az ezzel kapcsolatos
	beállításaink két
	állományra bomlanak, melyek közül az
	elsõ az <filename>mpd.conf</filename>:</para>

      <programlisting>default:
    load adsl

adsl:
    new -i ng0 adsl adsl
    set bundle authname <replaceable>felhasználónév</replaceable> <co xml:id="co-mpd-ex-user"/>
    set bundle password <replaceable>jelszó</replaceable> <co xml:id="co-mpd-ex-pass"/>
    set bundle disable multilink

    set link no pap acfcomp protocomp
    set link disable chap
    set link accept chap
    set link keep-alive 30 10

    set ipcp no vjcomp
    set ipcp ranges 0.0.0.0/0 0.0.0.0/0

    set iface route default
    set iface disable on-demand
    set iface enable proxy-arp
    set iface idle 0

    open</programlisting>

    <calloutlist>
      <callout arearefs="co-mpd-ex-user">
	<para>A felhasználói azonosító,
	  amellyel a szolgáltató felé
	  hitelesítjük magunkat.</para>
      </callout>
      <callout arearefs="co-mpd-ex-pass">
	<para>Az azonosítóhoz tartozó
	  jelszó, amelyet szintén a
	  szolgáltatól kaptunk.</para>
      </callout>
    </calloutlist>

    <para>Az <filename>mpd.links</filename> állomány
      tartalmazza a felépítendõ kapcsolatra vagy
      kapcsolatokra vonatkozó információkat.
      Például az elõbbiekhez tartozó
      <filename>mpd.links</filename> tartalma ez:</para>

    <programlisting>adsl:
    set link type pptp
    set pptp mode active
    set pptp enable originate outcall
    set pptp self <replaceable>10.0.0.1</replaceable> <co xml:id="co-mpd-ex-self"/>
    set pptp peer <replaceable>10.0.0.138</replaceable> <co xml:id="co-mpd-ex-peer"/></programlisting>

    <calloutlist>
      <callout arearefs="co-mpd-ex-self">
	<para>A &os;-s számítógépünk
	  címe, ahonnan az <application>mpd</application>
	  indul.</para>
      </callout>
      <callout arearefs="co-mpd-ex-peer">
	<para>Az ADSL modemünk IP-címe.  Az Alcatel
	  &speedtouch; Home esetén ez a cím
	  alapértelmezés szerint a <systemitem class="ipaddress">10.0.0.138</systemitem>.</para>
      </callout>
    </calloutlist>

    <para>A kapcsolat ezek után pillanatok alatt
      felépíthetõ, ha a <systemitem class="username">root</systemitem>
      felhasználóval kiadjuk a következõ
      parancsot:</para>

    <screen>&prompt.root; <userinput>mpd -b adsl</userinput></screen>

    <para>A kapcsolat állapotát a következõ
      paranccsal tudjuk ezután ellenõrizni:</para>

    <screen>&prompt.user; <userinput>ifconfig ng0</userinput>
ng0: flags=88d1&lt;UP,POINTOPOINT,RUNNING,NOARP,SIMPLEX,MULTICAST&gt; mtu 1500
     inet 216.136.204.117 --&gt; 204.152.186.171 netmask 0xffffffff</screen>

    <para>&os; alatt az <application>mpd</application> használata
      ajánlott az ADSL szolgáltatások
      eléréséhez.</para>

    </sect2>

    <sect2>
      <title>A pptpclient használata</title>

      <para>&os; alatt a <package>net/pptpclient</package>
	segítségével is tudunk PPPoA
	típusú szolgáltatásokhoz
	kapcsolódni.</para>

      <para>A <package>net/pptpclient</package>
	felhasználásával úgy tudunk DSL
	szolgáltatásokat elérni, ha
	feltelepítjük a hozzá tartozó portot
	vagy csomagot, majd módosítjuk az
	<filename>/etc/ppp/ppp.conf</filename> állományt.
	Mind a két mûveletet csak <systemitem class="username">root</systemitem>
	felhasználóként tudjuk
	lebonyolítani.  Ehhez egy <filename>ppp.conf</filename>
	állományt lentebb adtunk meg.  A
	<filename>ppp.conf</filename> állományban
	található további
	beállítási lehetõségekrõl
	a &man.ppp.8; man oldalon olvashatunk.</para>

      <programlisting>adsl:
 set log phase chat lcp ipcp ccp tun command
 set timeout 0
 enable dns
 set authname <replaceable>felhasználónév</replaceable> <co xml:id="co-pptp-ex-user"/>
 set authkey <replaceable>jelszó</replaceable> <co xml:id="co-pptp-ex-pass"/>
 set ifaddr 0 0
 add default HISADDR</programlisting>

      <calloutlist>
	<callout arearefs="co-pptp-ex-user">
	  <para>A DSL szolgáltatónktól kapott
	    felhasználói név.</para>
	</callout>
	<callout arearefs="co-pptp-ex-pass">
	  <para>Az elõfizetéshez tartozó
	    jelszó.</para>
	</callout>
      </calloutlist>

      <warning>
	<para>Mivel az elõfizetéshez tartozó
	  jelszót a <filename>ppp.conf</filename>
	  állományba titkosítatlan formában
	  kell szerepeltetnünk, ezért gondoskodjunk
	  róla, hogy senki sem képes olvasni a
	  tartalmát.  A most következõ parancsokkal
	  beállítjuk, hogy ez az állomány
	  csak a <systemitem class="username">root</systemitem> felhasználó
	  számára legyen olvasható.  A
	  részletekért lásd a &man.chmod.1;
	  és &man.chown.8; man oldalakat.</para>

	<screen>&prompt.root; <userinput>chown root:wheel /etc/ppp/ppp.conf</userinput>
&prompt.root; <userinput>chmod 600 /etc/ppp/ppp.conf</userinput></screen>
      </warning>

      <para>Ezzel a paranccsal a DSL útválasztónk
	felé nyitunk egy tunnelt a PPP kapcsolathoz.  Az
	Ethernetes DSL modemek általában egy elõre
	beállított helyi hálózati
	IP-címmel rendelkeznek, amelyhez tudunk csatlakozni.  Az
	Alcatel &speedtouch; Home esetében ez a cím a
	<systemitem class="ipaddress">10.0.0.138</systemitem>.  Az
	útválasztóhoz adott
	dokumentációban keressük meg, hogy az
	eszközünkhöz konkrétan milyen cím
	tartozik.  A tunnel megnyitásához és a PPP
	kapcsolat megindításához a
	következõ parancsot kell kiadnunk:</para>

      <screen>&prompt.root; <userinput>pptp cím adsl</userinput></screen>

      <tip>
	<para>Az iménti parancs végére még
	  érdemes odatenni az <quote>et</quote> jelet
	  (<quote>&amp;</quote>) is, mivel így a
	  <application>pptp</application>
	  mûködését a háttérben
	  folytatja.</para>
      </tip>

      <para>A parancs hatására a virtuális tunnelt
	megtestesítõ <filename>tun</filename>
	eszköz jön létre a
	<application>pptp</application> és
	<application>ppp</application> programok között.
	Miután visszakaptuk a parancssort, vagy a
	<application>pptp</application> program
	megerõsítette a kapcsolódás
	sikerességét, a keletkezett járatot
	így tudjuk ellenõrizni:</para>

      <screen>&prompt.user; <userinput>ifconfig tun0</userinput>
tun0: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500
        inet 216.136.204.21 --&gt; 204.152.186.171 netmask 0xffffff00
        Opened by PID 918</screen>

      <para>Ha nem tudnánk valamiért csatlakozni, akkor
	elõször nézzük meg az
	útválasztónk
	beállításait, ami általában a
	<application>telnet</application> vagy egy
	böngészõ segítségével
	elérhetõ.  Ha még mindig nem vagyunk
	képesek csatlakozni, akkor a <command>pptp</command>
	parancs kimenetében és
	<application>ppp</application>
	<filename>/var/log/ppp.log</filename> néven
	elérhetõ naplójában kereshetünk
	árulkodó nyomokat.</para>

    </sect2>
  </sect1>

  <sect1 xml:id="slip">
    <info><title>A SLIP használata</title>
      <authorgroup>
	<author><personname><firstname>Satoshi</firstname><surname>Asami</surname></personname><contrib>Eredetileg készítette: </contrib></author>
      </authorgroup>
      <authorgroup>
	<author><personname><firstname>Guy</firstname><surname>Helmer</surname></personname><contrib>A hozzávalókat biztosította:
	    </contrib></author>
	<author><personname><firstname>Piero</firstname><surname>Serini</surname></personname></author>
      </authorgroup>
    </info>

    

    <indexterm><primary>SLIP</primary></indexterm>

    <warning>
      <para>Ez a szakasz csak &os;&nbsp;7.<replaceable>X</replaceable>
	rendszerekre érvényes.</para>
    </warning>

    <sect2 xml:id="slipc">
      <title>A SLIP kliensek beállítása</title>

      <indexterm>
	<primary>SLIP</primary>
	<secondary>kliens</secondary>
      </indexterm>

      <para>A következõkben azt mutatjuk be, hogy egy &os;-s
	gépet miként tudunk egy hálózaton
	statikus névvel beállítani a SLIP
	használatával.  A dinamikus hálózati
	nevek használatakor (vagyis amikor a címünk
	minden egyes tárcsázáskor
	megváltozhat) egy valamivel bonyolultabb
	beállításra van
	szükségünk.</para>

      <para>Elõször is állapítsuk meg, hogy a
	modemünk melyik soros portra csatlakozik.  Sokan
	<filename>/dev/modem</filename> néven
	egy szimbolikus linket hoznak létre a valódi
	eszközre, például a <filename>/dev/cuadN</filename>
	leíróra.  Ennek köszönhetõen az
	eszköz tényleges névetõl el tudunk
	vonatkoztatni és soha nem kell módosítanunk
	semmit, ha a modemet például egy másik
	portra kell átraknunk.  Ugyanis könnyedén
	kacifántossá tud válni a helyzet, amikor
	egyszerre kell megváltoztatnunk egy rakat dolgot az
	<filename>/etc</filename>
	könyvtárban és módosítanunk az
	összes <filename>.kermrc</filename>
	állományt!</para>

      <note>
	<para>A <filename>/dev/cuad0</filename> a
	  <filename>COM1</filename> port, a <filename>/dev/cuad1</filename> a
	  <filename>COM2</filename> és így
	  tovább.</para>
      </note>

      <para>A rendszermag beállításait
	tartalmazó állományban a
	következõnek mindenképpen szerepelnie
	kell:</para>

      <programlisting>device   sl</programlisting>

      <para>Mivel ez általában a
	<filename>GENERIC</filename> rendszermagban
	megtalálható, így ez nem okoz semmilyen
	gondot, kivéve, hogy ha korábban már
	kitöröltük.</para>

      <sect3>
	<title>Amit csak egyszer kell megtenni</title>

	<procedure>
	  <step>
	    <para>Vegyük fel az otthoni gépünket, az
	      átjárónkat és a
	      névszervereket az <filename>/etc/hosts</filename>
	      állományba.  Erre álljon itt egy
	      konkrét példa:</para>

	    <programlisting>127.0.0.1               localhost loghost
136.152.64.181          water.CS.Example.EDU water.CS water
136.152.64.1            inr-3.CS.Example.EDU inr-3 slip-gateway
128.32.136.9            ns1.Example.EDU ns1
128.32.136.12           ns2.Example.EDU ns2</programlisting>
	  </step>

	  <step>
	    <para>Figyeljünk oda, hogy az
	      <filename>/etc/nsswitch.conf</filename>
	      állományban szereplõ
	      <option>hosts</option> szakaszban a <literal>dns</literal>
	      szó elõtt a <literal>files</literal>
	      szónak kell megjelennie.  Ezek nélkül
	      mókás dolgok tudnak történni
	      rendszerünkben.</para>
	  </step>

	  <step>
	    <para>Szerkesszük át az
	      <filename>/etc/rc.conf</filename>
	      állományt.</para>

	    <orderedlist>
	      <listitem>
		<para>A hálózati nevünket a
		  következõ sorban tudjuk megadni:</para>

		<programlisting>hostname="az.en.nevem"</programlisting>

		<para>Ide a gépünk teljes internetes
		  hálózati nevét kell
		  beírnunk.</para>
	      </listitem>

	      <listitem>
		<para>Az alapértelmezett
		  átjárót<indexterm><primary>default route</primary></indexterm> az alábbi sor
		  módosításával tudjuk
		  beállítani úgy, hogy a</para>

		<programlisting>defaultrouter="NO"</programlisting>

		<para>változó értékét
		  átírjuk:</para>

		<programlisting>defaultrouter="slip-gateway"</programlisting>
	      </listitem>
	    </orderedlist>
	  </step>

	  <step>
	    <para>Készítsük el az
	      <filename>/etc/resolv.conf</filename>
	      állományt, amelyben majd a
	      következõk legyenek:</para>

	    <programlisting>domain CS.Example.EDU
nameserver 128.32.136.9
nameserver 128.32.136.12</programlisting>

	    <indexterm><primary>névszerver</primary></indexterm>
	    <indexterm><primary>tartománynév</primary></indexterm>

	    <para>Látható, hogy ezek a
	      névfeloldásért felelõs szerverek
	      címei.  Természetesen a ténylegesen
	      beírandó tartomány (domain) neve
	      és a névszerverek címei mindig az
	      adott környezetünktõl függenek.</para>
	  </step>

	  <step>
	    <para>Állítsuk be egy jelszót a
	      <systemitem class="username">root</systemitem> és
	      <systemitem class="username">toor</systemitem> felhasználóknak
	      (és mindenki másnak, akinek még nem
	      lenne).</para>
	  </step>

	  <step>
	    <para>Indítsuk újra a
	      számítógépünket és
	      utána gyõzõdjünk meg róla,
	      hogy a megfelelõ hálózati névvel
	      rendelkezik.</para>
	  </step>
	</procedure>
      </sect3>

      <sect3>
	<title>A SLIP kapcsolatok
	  felépítése</title>

	<indexterm>
	  <primary>SLIP</primary>
	  <secondary>kapcsolódás</secondary>
	</indexterm>

	<procedure>
	  <step>
	    <para>Tárcsázzunk és
	      gépeljük be a <command>slip</command>
	      parancsot, majd ezt követõen a
	      gépünk nevét és a
	      jelszót.  Ez leginkább a konkrét
	      környezettõl függ.  Ha a
	      <application>Kermit</application> nevû programot
	      használjuk, akkor egy ilyen szkripttel is
	      próbálkozhatunk:</para>

	    <programlisting># a kermit beállítása
set modem hayes
set line /dev/modem
set speed 115200
set parity none
set flow rts/cts
set terminal bytesize 8
set file type binary
# a következõ makró felelõs a tárcsázásért és a bejelentkezésért
define slip dial 643-9600, input 10 =&gt;, if failure stop, -
output slip\x0d, input 10 Azonosito:, if failure stop, -
output silvia\x0d, input 10 Jelszo:, if failure stop, -
output ***\x0d, echo \x0aCONNECTED\x0a</programlisting>

	    <para>Természetesen a felhasználói
	      nevet és a jelszót a sajátunkra kell
	      benne kicserélnünk.  Miután ezzel is
	      megvagyunk, a <application>Kermit</application>
	      paranccsorában a csatlakozáshoz
	      egyszerûen csak írjuk be, hogy
	      <command>slip</command>.</para>

	    <note>
	<para><emphasis>Nem</emphasis> javasoljuk, hogy az
	  állományrendszeren a jelszavakat
	  titkosítatlan formában tároljuk.  Mindeki
	  csak a saját felelõsségére tegyen
	  ilyet.</para>
	    </note>
	  </step>

	  <step>
	    <para>Hagyjuk el a <application>Kermit</application>
	      programot (a <keycombo> <keycap>Ctrl</keycap>
	      <keycap>z</keycap> </keycombo>
	      billentyûkombinációval bármikor
	      fel tudjuk függeszteni a futását)
	      és <systemitem class="username">root</systemitem>
	      felhasználóként írjuk be a
	      következõt:</para>

	    <screen>&prompt.root; <userinput>slattach -h -c -s 115200 /dev/modem</userinput></screen>

	    <para>Ha ezután már képesek vagyunk a
	      <command>ping</command> paranccsal elérni az
	      útválasztó másik
	      oldalán található gépet, akkor
	      az azt jelenti, hogy sikerült csatlakoznunk!  Ha
	      viszont itt még nem járnánk sikerrel,
	      akkor az <command>slattach</command> parancsnak ne a
	      <option>-c</option> paramétert adjuk meg, hanem a
	      <option>-a</option> paramétert.</para>
	  </step>
	</procedure>

      </sect3>

      <sect3>
	<title>Hogyan bontsunk egy kapcsolatot</title>

	<para>Tegyük a következõket:</para>

	<screen>&prompt.root; <userinput>kill -INT `cat /var/run/slattach.modem.pid`</userinput></screen>

	<para>Ez leállítja az <command>slattach</command>
	  programot.  Ne felejtsük el azonban, hogy ezt csak a
	  <systemitem class="username">root</systemitem> felhasználóval tudjuk
	  végrehajtani.  Ezután térjünk vissza
	  a <command>kermit</command> programhoz (ha
	  felfüggesztettük volna, akkor ehhez a
	  <command>fg</command> parancsra lesz
	  szükségünk), és lépjünk ki
	  belõle (<keycap>q</keycap>).</para>

	<para>Az &man.slattach.8; man oldala ehhez a <command>ifconfig
	  sl0 down</command> parancsot javasolja, amellyel
	  lényegében leállítjuk a
	  hozzá tartozó felületet.
	  Igazából a kettõ között nincs
	  semmilyen komolyabb eltérés (mivel az
	  (<command>ifconfig sl0</command> is ugyanezt
	  eredményezi.)</para>

	<para>Néha elõfordulhat, hogy a modem
	  egyszerûen nem hajlandó eldobni a vonalat.  Ilyen
	  esetekben indítsuk el a <command>kermit</command>
	  programot és lépjünk ki megint.
	  Másodjára általában már
	  sikerül.</para>

      </sect3>

      <sect3>
	<title>Hibaelhárítás</title>

	<para>Ha valamiért ez mégsem válna be,
	  akkor csak nyugodtan kérdezõsködjünk a
	  &a.net.name; levelezési listán.  A tapasztalatok
	  szerint az embereknek eddig a következõkkel voltak
	  problémáik:</para>

	<itemizedlist>
	  <listitem>
	    <para>Az <command>slattach</command>
	      meghívásakor sem a <option>-c</option>, sem
	      pedig a <option>-a</option> paramétert nem
	      adták meg.  (Ez ugyan nem végzetes hiba, de
	      egyes felhasználók szerint ez
	      segített megoldani a gondokat.)</para>
	  </listitem>

	  <listitem>
	    <para>Az <option>sl0</option> helyett
	      <option>s10</option>-et írtak be (egyes
	      betûtípusoknál könnyen össze
	      lehet téveszteni ezeket).</para>
	  </listitem>

	  <listitem>
	    <para>Az <command>ifconfig sl0</command>
	      segítségével ellenõrizhetõ
	      a felület állapota.  Például
	      ilyet láthatunk:</para>

	    <screen>&prompt.root; <userinput>ifconfig sl0</userinput>
sl0: flags=10&lt;POINTOPOINT&gt;
        inet 136.152.64.181 --&gt; 136.152.64.1 netmask ffffff00</screen>
	  </listitem>

	  <listitem>
	    <para>Ha a &man.ping.8; <errorname>no route to
	      host</errorname> hibaüzenetet ad, akkor az
	      útválasztási
	      táblázattal van a gond.  A <command>netstat
	      -r</command> paranccsal gyorsan ki tudjuk listázni
	      a rendszerünkben jelenleg nyilvántartott
	      utakat:</para>

	    <screen>&prompt.root; <userinput>netstat -r</userinput>
Routing tables
Destination      Gateway            Flags     Refs     Use  IfaceMTU    Rtt    Netmasks:

(root node)
(root node)

Route Tree for Protocol Family inet:
(root node) =&gt;
default          inr-3.Example.EDU  UG          8   224515  sl0 -      -
localhost.Exampl localhost.Example. UH          5    42127  lo0 -       0.438
inr-3.Example.ED water.CS.Example.E UH          1        0  sl0 -      -
water.CS.Example localhost.Example. UGH        34 47641234  lo0 -       0.438
(root node)</screen>

	    <para>Az elõzõ példákat egy
	      viszonylag forgalmas rendszerbõl ragadtuk ki.  A
	      rendszerünkön megjelenõ számok a
	      hálózati aktivitás
	      mértékének
	      függvényei.</para>
	  </listitem>
	</itemizedlist>

      </sect3>
    </sect2>

    <sect2 xml:id="slips">
      <title>A SLIP szerverek beállítása</title>

      <indexterm>
	<primary>SLIP</primary>
	<secondary>szerver</secondary>
      </indexterm>

      <para>Ebben a leírásban igyekszünk bemutatni
	hogyan kell egy &os; típusú rendszer alatt SLIP
	szervert beállítani, ami általában
	annyit jelent, hogy a rendszerünben a távoli SLIP
	kliensek csatlakozásakor automatikusan elindítjuk
	a kapcsolatokat.</para>

      <sect3 xml:id="slips-prereqs">
	<title>Elõfeltételek</title>

	<indexterm><primary>TCP/IP hálózatok</primary></indexterm>

	<para>Ez a szakasz igen szakmai jellegû, ezért az
	  olvasó részérõl
	  feltételezünk a témában némi
	  alapismeretet.  Ez alatt alapvetõen a TPC/IP
	  hálózati protokollt értjük,
	  különös hangsúllyal a
	  hálózatok és hálózati
	  csomópontok címzéséen, a
	  hálózati maszkokon, alhálózatokon,
	  útválasztáson, az olyan
	  útválasztási protokollokon, mint
	  például a RIP.  A SLIP
	  beállítása egy
	  betárcsázós szerveren mindezen fogalmak
	  ismeretét igényli, és ha ezekkel
	  még nem lennénk tisztában, akkor olvassuk
	  el például Craig Hunt <emphasis>TCP/IP Network
	  Administration</emphasis> címû könyvét
	  (O'Reilly &amp; Associates, Inc.; ISBN: 0-937175-82-X) vagy
	  Douglas Comer TCP/IP protokollról szóló
	  könyveit.</para>

	<indexterm><primary>modem</primary></indexterm>

	<para>Mindezek mellett még feltételezzük,
	  hogy már beállítottuk a modem(ek)et
	  és a rajtuk keresztüli bejelentkezéshez
	  szükséges állományokat.  Ha
	  még nem készítettük volna fel erre a
	  rendszerünket, akkor a <xref linkend="dialup"/> ad
	  részletes tájékoztatást a
	  betárcsázós szolgáltatások
	  beállításáról.  A soros
	  vonali eszközmeghajtóval kapcsolatban
	  továbbá érdemes átolvasni a
	  &man.sio.4; oldalt, valamint a &man.ttys.5;, &man.gettytab.5;,
	  &man.getty.8; és &man.init.8; oldalakat a
	  bejelentkezések modemen keresztüli
	  fogadásáról, illetve talán az
	  &man.stty.1; oldalt a soros port paramétereinek
	  megfelelõ
	  beállításáról (mint
	  például a <literal>clocal</literal> a
	  közvetlenül csatlakozó soros felületek
	  esetében).</para>

      </sect3>

      <sect3>
	<title>Gyors áttekintés</title>

	<para>A &os; SLIP szerverként általában a
	  következõ módon üzemel: a SLIP
	  felhasználó tárcsázza a &os;-s
	  SLIP szerverünket, majd bejelentkezik egy specális
	  SLIP bejelentkezési azonosító
	  használatával, amely a
	  <filename>/usr/sbin/sliplogin</filename> shellt
	  használja.  A <command>sliplogin</command> program az
	  <filename>/etc/sliphome/slip.hosts</filename>
	  állományban megkeresi a speciális
	  felhasználóhoz tartozó sort, és ha
	  talál egy ilyet, akkor csatlakoztatja a soros vonalat
	  egy rendelkezésre álló SLIP
	  felületre, amelyen aztán a SLIP felültet
	  beállításához lefuttatja az
	  <filename>/etc/sliphome/slip.login</filename> shell
	  szkriptet.</para>

	<sect4>
	  <title>Példa SLIP szerveren keresztüli
	    bejelentkezésre</title>

	  <para>Például, ha a SLIP
	    felhasználó azonosítója
	    <systemitem class="username">Shelmerg</systemitem>, akkor az
	    <filename>/etc/master.passwd</filename>
	    állományban a hozzá tartozó
	    bejegyzést nagyjából ilyen:</para>

	  <programlisting>Shelmerg:password:1964:89::0:0:Guy Helmer - SLIP:/usr/users/Shelmerg:/usr/sbin/sliplogin</programlisting>

	  <para>Amikor <systemitem class="username">Shelmerg</systemitem> bejelentkezik, a
	    <command>sliplogin</command> az
	    <filename>/etc/sliphome/slip.hosts</filename>
	    állományban keresni fog egy
	    felhasználó
	    azonosítójához illeszkedõ sort.
	    Például tegyük fel, hogy az
	    <filename>/etc/sliphome/slip.hosts</filename>
	    állományban szerepel egy ilyen sor:</para>

	  <programlisting>Shelmerg        dc-slip sl-helmer       0xfffffc00		  autocomp</programlisting>

	  <para>A <command>sliplogin</command> ezt a sor fogja
	    megtalálni, majd a soros vonalat a
	    következõ elérhetõ SLIP
	    felülethez kapcsolja, amelyen ezután
	    végrehajtja az
	    <filename>/etc/sliphome/slip.login</filename> szkriptet a
	    következõ módon:</para>

	  <programlisting>/etc/sliphome/slip.login 0 19200 Shelmerg dc-slip sl-helmer 0xfffffc00 autocomp</programlisting>

	  <para>Ha minden jól megy, akkor az
	    <filename>/etc/sliphome/slip.login</filename> kiad egy
	    <command>ifconfig</command> parancsot azon a SLIP
	    felületen, amelyre a <command>sliplogin</command>
	    magát csatlakoztatta (amely a fenti
	    példában a 0.  SLIP felület volt,
	    és amelyet meg is adtunk
	    <filename>slip.login</filename> elsõ
	    paramétereként), és így
	    beállítja a helyi IP-címet
	    (<systemitem>dc-slip</systemitem>), a távoli IP-címet
	    (<systemitem>sl-helmer</systemitem>), a SLIP felülethez
	    tartozó hálózati maszkot (<systemitem class="netmask">0xfffffc00</systemitem>) valamint a
	    további opciókat
	    (<literal>autocomp</literal>).  Ha valami rosszul sülne
	    el, akkor a <command>sliplogin</command> ezekrõl
	    általában nagyon jó
	    minõségû,
	    információdús üzeneteket
	    készít, amelyeket a
	    <application>syslogd</application> démon pedig a
	    <filename>/var/log/messages</filename>
	    állományba rögzít.  (A
	    &man.syslogd.8; és &man.syslog.conf.5; man oldalak
	    és talán maga az
	    <filename>/etc/syslog.conf</filename> segíthet
	    kideríteni, hogy a <application>syslogd</application>
	    jelenleg naplóz-e, és ha igen, akkor
	    hova.)</para>

	</sect4>
      </sect3>

      <sect3>
	<title>A rendszermag beállítása</title>

	<indexterm>
	  <primary>rendszermag</primary>
	  <secondary>beállítása</secondary>
	</indexterm>

	<indexterm><primary>SLIP</primary></indexterm>

	<para>A &os; alap (vagyis a <filename>GENERIC</filename>)
	  rendszermagja támogatja a SLIP (&man.sl.4;)
	  használatát.  Ha viszont saját
	  rendszermagunk van, akkor elõfordulhat, hogy
	  beállítások közé fel kell
	  vennünk a következõ sort is:</para>

	<programlisting>device   sl</programlisting>

	<para>Alapértelmezés szerint a &os; nem
	  továbbít semmilyen csomagot.  Amennyiben a &os;
	  SLIP szerverünket
	  útválasztóként is
	  mûködtetni akarjuk, úgy az
	  <filename>/etc/rc.conf</filename> állományban a
	  <literal>gateway_enable</literal> változót
	  át kell állítanunk a <option>YES</option>
	  értékre.  Ennek hatására az
	  újraindítás után is megmarad a
	  csomagok továbbítása.</para>

	<para>A változtatások azonnali
	  életbeléptetéséhez adjuk ki
	  <systemitem class="username">root</systemitem> felhasználóként
	  a következõ parancsot:</para>

	<screen>&prompt.root; /etc/rc.d/routing start</screen>

	<para>Ha a &os; rendszermag beállítása
	  során segítségre szorulnánk, akkor
	  olvassuk el <xref linkend="kernelconfig"/>et.</para>
      </sect3>

      <sect3>
	<title>A sliplogin beállítása</title>

	<para>Ahogy arra már korábban is utaltunk, az
	  <filename>/etc/sliphome</filename>
	  könyvtárban három állomány
	  felelõs a <filename>/usr/sbin/sliplogin</filename>
	  beállításáért (lásd
	  &man.sliplogin.8;): a <filename>slip.hosts</filename>,
	  amelyekben a SLIP felhasználókat és a
	  hozzájuk tartozó IP-címeket adjuk meg; a
	  <filename>slip.login</filename>, amely általában
	  csak a SLIP felületet állítja be; (az
	  elhagyható) <filename>slip.logout</filename>, amely a
	  soros vonal bontásakor a
	  <filename>slip.login</filename> hatását
	  igyekszik visszafordítani.</para>

	<sect4>
	  <title>A <filename>slip.hosts</filename>
	    beállítása</title>

	  <para>Az <filename>/etc/sliphome/slip.hosts</filename>
	    soraiban whitespace karakterekkel tagoltan legalább
	    négy elem szerepel:</para>

	  <itemizedlist>
	    <listitem>
	      <para>a SLIP felhasználó
		bejelentkezési azonosítója</para>
	    </listitem>

	    <listitem>
	      <para>a SLIP kapcsolat helyi címe (a SLIP
		szerveréhez képest)</para>
	    </listitem>

	    <listitem>
	      <para>a SLIP kapcsolat távoli címe</para>
	    </listitem>

	    <listitem>
	      <para>hálózati maszk</para>
	    </listitem>
	  </itemizedlist>

	  <para>A helyi és távoli címek lehetnek
	    hálózati nevek is (amelyeket vagy az
	    <filename>/etc/hosts</filename>, vagy pedig az
	    <filename>/etc/nsswitch.conf</filename>
	    állományban szereplõ
	    beállítások alapján tudunk
	    feloldani IP-címre), illetve a hálózati
	    maszk is lehet egy olyan név, amelyet az
	    <filename>/etc/networks</filename> fel tud oldani.  A
	    példaként bemutatott rendszerünkben az
	    <filename>/etc/sliphome/slip.hosts</filename>
	    állomány nagyjából így
	    épül fel:</para>

	  <programlisting>#
# login helyi-cím       távoli-cím      maszk            opc1    opc2
#                                               (normal,compress,noicmp)
#
Shelmerg  dc-slip       sl-helmerg      0xfffffc00      autocomp</programlisting>

	  <para>A sorok végén az alábbi
	    opciók közül egy vagy több
	    szerepelhet:</para>

	  <itemizedlist>
	    <listitem>
	      <para><option>normal</option> &mdash; a fejléceket
		nem tömörítjük</para>
	    </listitem>

	    <listitem>
	      <para><option>compress</option> &mdash; a fejlécek
		tömörítése</para>
	    </listitem>

	    <listitem>
	      <para><option>autocomp</option> &mdash; ha a távoli
		végpont engedi, akkor
		tömörítsük a
		fejléceket</para>
	    </listitem>

	    <listitem>
	      <para><option>noicmp</option> &mdash; az ICMP csomagok
		tiltása (így például a
		<quote>ping</quote> által generált
		csomagok is eldobódnak a
		sávszélesség felemésztese
		helyett)</para>
	    </listitem>
	  </itemizedlist>

	  <indexterm><primary>SLIP</primary></indexterm>
	  <indexterm><primary>TCP/IP hálózatok</primary></indexterm>

	  <para>A SLIP kapcsolathoz tartozó helyi és
	    távoli címek megválasztása
	    függ attól, hogy egy külön TCP/IP
	    alhálózatot szentelünk-e neki, vagy a
	    SLIP szerverünkön egy <quote>ARP proxy</quote>-t
	    használunk (amely tulajdonképpen nem egy
	    <quote>valódi</quote> ARP proxy, de ebben a
	    szakaszban így fogunk rá hivatkozni).  Ha nem
	    vagyunk biztosak benne, hogy melyik módszert
	    válasszuk vagy hogy miként osszuk ki az
	    IP-címeket, akkor nézzünk utána
	    ezekenek a SLIP használatával kapcsolatos
	    elõfeltételek között
	    megemlített könyvekben (<xref linkend="slips-prereqs"/>) és/vagy
	    konzultáljunk a hálózatunk
	    karbantartójával.</para>

	  <para>Ha a SLIP klienseknek külön
	    alhálózatokat osztunk ki, akkor a saját
	    IP-címünkbõl kell létrehoznunk
	    és kiadnunk ezeket.  Ezután
	    valószínûleg a SLIP
	    szerverünkön keresztül még meg kell
	    adnunk egy statikus útvonalat legközelebbi IP
	    útválasztó felé.</para>

	  <indexterm><primary>Ethernet</primary></indexterm>

	  <para>Minden más esetben az <quote>ARP proxy</quote>
	    módszert kell alkalmaznunk, ahol a SLIP kliensek
	    IP-címeit a SLIP szerver Ethernet
	    alhálózatából osztjuk ki,
	    és ennek megfelelõen az
	    <filename>/etc/sliphome/slip.login</filename> és
	    <filename>/etc/sliphome/slip.logout</filename> szkripteket
	    módosítanunk kell úgy, hogy az
	    &man.arp.8; segítségével képesek
	    legyenek a SLIP szerver ARP
	    táblázatában kezelni a <quote>proxy
	    ARP</quote> bejegyzéseket.</para>
	</sect4>

	<sect4>
	  <title>A <filename>slip.login</filename>
	    beállítása</title>

	  <para>Egy átlagos
	    <filename>/etc/sliphome/slip.login</filename>
	    állomány körülbelül
	    ilyen:</para>

	  <programlisting>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# Egy általános slip vonali bejelentkezési állomány. A sliplogin ezt az alábbi
# paraméterekkel hívja meg:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.  azonosító helyi-cím távoli-cím maszk egyéb-pmek.
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6</programlisting>

	  <para>Ez a <filename>slip.login</filename>
	    állomány az <command>ifconfig</command>
	    segítségével pusztán
	    beállítja a megfelelõ SLIP
	    felülethez tartozó helyi, valamint távoli
	    címet és a hálózati
	    maszkot.</para>

	  <para>Ha ehelyett azonban az <quote>ARP proxy</quote>
	    módszerét választottuk volna
	    (tehát a SLIP kliensekenek nem akarunk egész
	    alhálózatokat kiutalni), akkor az
	    <filename>/etc/sliphome/slip.login</filename>
	    állomány eképpen alakul:</para>

	  <programlisting>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# Egy általános slip vonali bejelentkezési állomány. A sliplogin ezt az alábbi
# paraméterekkel hívja meg:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.  azonosító helyi-cím távoli-cím maszk egyéb-pmek.
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6
# A SLIP kliensre vonatkozó ARP kéréseket a mi Ethernet címünkkel
# válaszoljuk meg:
/usr/sbin/arp -s $5 00:11:22:33:44:55 pub</programlisting>

	  <para>Láthatjuk, hogy az elõbbi
	    <filename>slip.login</filename> állomány egy
	    <command>arp -s &#36;5 00:11:22:33:44:55 pub</command>
	    paranccsal egészült ki, ami a SLIP szerver ARP
	    táblázatában hoz létre egy ARP
	    bejegyzést.  Ez az ARP bejegyzés gondoskodik
	    róla, hogy a SLIP szerver válaszoljon a
	    saját Ethernetes MAC-címével, amikor
	    egy másik IP csomópont a SLIP kliens
	    IP-címe felõl érdeklõdik.</para>

	  <indexterm>
	    <primary>Ethernet</primary>
	    <secondary>MAC-cím</secondary>
	  </indexterm>

	  <para>Amikor a fenti példából indulunk
	    ki, a benne megadott MAC-címet (<systemitem class="etheraddress">00:11:22:33:44:55</systemitem>)
	    feltétlenül cseréljük a
	    rendszerünk Ethernet kártyájának
	    MAC-címével, mert különben az
	    <quote>ARP proxy</quote> egyáltalán nem fog
	    mûködni!  A SLIP szerverünk
	    MAC-címét a <command>netstat -i</command>
	    paranccsal deríthetjük ki, amelynek a
	    kimenetében a második sor valahogy így
	    néz ki:</para>

	  <screen>ed0   1500  &lt;Link&gt;0.2.c1.28.5f.4a         191923	0   129457     0   116</screen>

	  <para>Ebbõl derül ki, hogy az adott rendszer
	    valódi MAC-címe a <systemitem class="etheraddress">00:02:c1:28:5f:4a</systemitem> &mdash; az &man.arp.8;
	    számára azonban a <command>netstat
	    -i</command> kimenetében szereplõ pontokat
	    kettõspontokra kell cserélni, és a
	    tagokat ki kell egészíteni
	    kétkarakteres hexadecimális
	    számokká.  Az &man.arp.8; man oldalán
	    tudhatunk meg ennek részleteirõl
	    többet.</para>

	  <note>
	    <para>Amikor létrehozzuk az
	      <filename>/etc/sliphome/slip.login</filename> és
	      <filename>/etc/sliphome/slip.logout</filename>
	      állományokat, akkor ne felejtsük el
	      hozzájuk beállítani a
	      <quote>végrehajtást</quote>
	      engedélyezõ bitet sem (tehát ilyenkor
	      mindig adjuk ki a <command>chmod 755
	      /etc/sliphome/slip.login
	      /etc/sliphome/slip.logout</command> parancsokat is),
	      különben a <command>sliplogin</command> ezeket
	      nem tudja majd elindítani.</para>
	  </note>

	</sect4>

	<sect4>
	  <title>A <filename>slip.logout</filename>
	    beállítása</title>

	  <para>Az <filename>/etc/sliphome/slip.logout</filename>
	    állományra nincs feltétlenül
	    szükségünk (hacsak nem egy <quote>ARP
	    proxy</quote>-t akarunk csinálni), de ha
	    valamiért mégis el akarjuk
	    készíteni, akkor ehhez a következõ
	    alapvetõ <filename>slip.logout</filename> szkript
	    használható:</para>

	  <programlisting>#!/bin/sh -
#
#       slip.logout

#
# Egy logout állomány a slip vonalhoz. A sliplogin ezt a szkriptet a
# következõ paraméterekkel hívja:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.   login helyi-cím  távoli-cím   maszk opc-pmek.
#
/sbin/ifconfig sl$1 down</programlisting>

	  <para>Ha az <quote>ARP proxy</quote> módszert
	    használjuk, és az
	    <filename>/etc/sliphome/slip.logout</filename>
	    felhasználásával akarjuk a SLIP
	    klienshez tartozó ARP bejegyzést
	    törölni, akkor ebbõl induljunk ki:</para>

	  <programlisting>#!/bin/sh -
#
#       @(#)slip.logout

#
# Egy logout állomány a slip vonalhoz. A sliplogin ezt a szkriptet a
# következõ paraméterekkel hívja:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.   login helyi-cím  távoli-cím   maszk opc-pmek.
#
sbin/ifconfig sl$1 down
# Ne válaszoljunk többet a SLIP kliensre vonatkozó ARP kérésekre
/usr/sbin/arp -d $5</programlisting>

	  <para>Az <command>arp -d &#36;5</command> parancs
	    eltávolítja az <quote>ARP proxy</quote>
	    mûködéséhez bejegyzést,
	    amelyet még a <filename>slip.login</filename>
	    szkripttel vettünk fel a SLIP kliens
	    bejelentkezésekor.</para>

	  <para>Talán felesleges ismételgetésnek
	    tûnhet: az
	    <filename>/etc/sliphome/slip.logout</filename>
	    állománynak létrehozása
	    után állítsuk be a
	    végrehajtásra szóló bitet
	    (vagyis adjuk ki a <command>chmod 755
	    /etc/sliphome/slip.logout</command> parancsot).</para>

	</sect4>
      </sect3>

      <sect3>
	<title>Az útválasztással kapcsolatos
	  megfontolások</title>

	<indexterm>
	  <primary>SLIP</primary>
	  <secondary>útválasztás</secondary>
	</indexterm>

	<para>Ha a hálózatunk többi része
	  (lényegében az internet) és a SLIP
	  klienseink között nem az <quote>ARP proxy</quote>
	  módszerrel közvetítjük a csomagokat,
	  akkor a legközelebbi alapértelmezett
	  átjárókhoz minden bizonnyal fel kell
	  vennünk statikus útvonalakat, így a SLIP
	  kliensek alhálózatai a SLIP
	  szerverünkön keresztül ki tudnak jutni.</para>

	<sect4>
	  <title>Statikus útvonalak</title>

	  <indexterm><primary>statikus útvonalak</primary></indexterm>

	  <para>A legközelebbi alapértelmezett
	    átjárók felé nem minden esetben
	    könnyû felvenni statikus útvonalakat (vagy
	    egyes esetekben pedig egyenesen lehetetlen, mivel nincsenek
	    meg hozzá a jogaink).  Ha az
	    intézményünkön belül több
	    átjáró is megtalálható,
	    akkor bizonyos útválasztók,
	    például a Cisco és Proteon
	    gyártmányúak esetében nem csak a
	    SLIP alhálózatok felé kell
	    beállítanunk statikus útvonalakat,
	    hanem azt is meg kell mondanunk, hogy ezekrõl milyen
	    más útválasztók is tudjanak.
	    Pontosan emiatt a statikus útválasztás
	    beüzemeléséhez
	    szükségünk lesz egy kis
	    utánajárásra és
	    próbálgatásra.</para>
	</sect4>
      </sect3>
    </sect2>
  </sect1>
</chapter>
